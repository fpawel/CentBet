(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;$.Define($$,{CentBet:{Client:{Admin:{Level:$.Class({},{get_color:function(){return function(T){return T.$==1?["lightgrey","red"]:T.$==2?["lightgrey","green"]:["white","navy"];};}}),LocalStorage:$.Class({Get:function(U){var V,W,X,Y,Z;try{W=this.strg.getItem(U);X=a.parse(W);V={$:0,$0:X};}catch(Y){Z=this.strg;V={$:1,$0:"local storage get item "+b.prettyPrint(U)+" error : "+b.prettyPrint(Y)+", storage "+b.prettyPrint(Z)};}return V;},Set:function(_0,_1){var _2,_3,_4,_5;try{_3=a.stringify(_1);_2={$:0,$0:this.strg.setItem(_0,_3)};}catch(_4){_5=this.strg;_2={$:1,$0:"local storage set item "+b.prettyPrint(_0)+" error : "+b.prettyPrint(_4)+", value "+b.prettyPrint(_1)+", storage "+b.prettyPrint(_5)};}return _2;}},{New:function(){var _7;_7=$.New(this,{});_7.strg=c.localStorage;return _7;}}),Render:function(){var _8;_8=$.New(k,{$:0});return f.Concat(g.ofArray([j.RenderCommandPrompt(),(j.op_SpliceUntyped())(f.Element("br",[],_8)),j.RenderRecords()]));},RenderCommandPrompt:function(){var _9;_9=g.ofArray([(j.op_SpliceUntyped())(f.Element("span",g.ofArray([l.Style("margin-left","10px")]),$.New(k,{$:0}))),(j.op_SpliceUntyped())(f.Element("label",g.ofArray([m.Create("for",j["cmd-input"]())]),g.ofArray([f.TextNode("Input here:")]))),j.renderInput()]);return f.Concat(_9);},RenderMenu:function(){var _,bb,bj;_=function(ba){return ba;};bb=g.ofArray([f.Element("a",n.toList(n.delay(function(){return n.append([m.Create("href","#")],n.delay(function(){return[l.Handler("click",function(){return function(){return j.varConsole().Clear();};})];}));})),g.ofArray([f.TextNode("Clear console")])),f.Element("a",n.toList(n.delay(function(){return n.append([m.Create("href","#")],n.delay(function(){return[l.Handler("click",function(){return function(){return j.varCommandsHistory().Clear();};})];}));})),g.ofArray([f.TextNode("Clear history")]))]);bj=g.map(_,bb);return f.Concat(bj);},RenderRecords:function(){var bk,bo;bk=function(bl){var bm,bn;bn=$.New(k,{$:0});bm=g.ofArray([(j.renderRecord())(bl),(j.op_SpliceUntyped())(f.Element("br",[],bn))]);return f.Concat(bm);};bo=j.varConsole().get_View();return f.ConvertSeq(bk,bo);},addRecord:function(bp,bq){return j.varConsole().Add({Id:o.Fresh(),Text:bq,Level:bp});},"cmd-input":$.Field(function(){return"cmd-input";}),cmdKey:function(br){return br.Id;},doc:function(bs){return bs;},op_SpliceUntyped:$.Field(function(){return function(bt){return j.doc(bt);};}),recordKey:function(bu){return bu.Id;},renderInput:function(){var bv,bw,bx,by,bB,bE,bI,bJ,bX;bv=p.Create("");bw=p.Create(null);bx=p.Create(false);by=q.Delay(function(){r.Set(bx,true);return q.Bind(j.send(r.Get(bv)),function(){r.Set(bx,false);r.Set(bv,"");return q.Return(null);});});bB=function(bC){var bD;bD={$:1,$0:bC};j.varCmd=function(){return bD;};return r.Set(bv,bC.Text);};bE=function(bF){var bG,bH;bG=j.tryGetCommandFromHistory(bF);bH=s.map(bB,bG);return;};bI=bx.get_View();bJ=function(bK){var bL;bL=g.ofArray([f.Input(n.toList(n.delay(function(){return n.append([m.Create("id",j["cmd-input"]())],n.delay(function(){return n.append(bK?[m.Create("disabled","disabled")]:n.empty(),n.delay(function(){return n.append([l.Style("width","80%")],n.delay(function(){return n.append([l.CustomVar(bw,function(bQ){return function(){return bQ.focus();};},function(){return{$:0};})],n.delay(function(){return[l.Handler("keydown",function(){return function(bV){var bW;bW=bV.keyCode;return bW===13?q.Start(by,{$:0}):bW===38?bE(true):bW===40?bE(false):null;};})];}));}));}));}));})),bv)]);return f.Concat(bL);};bX=t.Map(bJ,bI);return f.EmbedView(bX);},renderRecord:$.Field(function(){var bY;bY=function(bZ){var b0,b1,b2;b0=(u.get_color())(bZ.Level);b1=b0[1];b2=b0[0];return(j.op_SpliceUntyped())(f.Element("span",g.ofArray([l.Style("color",b1),l.Style("background",b2)]),g.ofArray([f.TextNode(bZ.Text)])));};return function(b3){var b4;b4=t.Map(bY,b3);return f.EmbedView(b4);};}),send:function(b5){return q.Delay(function(){var b7,b8,b9,b_,b$,ca;b7=v.Trim(b5);j.addRecord($.New(u,{$:2}),b7);b9=r.Get(j.varCommandsHistory().Var);if(n.isEmpty(b9)){b_=true;}else{b$=w.last(b9);b_=b$.Text!==b7;}if(b_){j.varCommandsHistory().Add({Id:o.Fresh(),Text:b7});ca=q.Return(null);}else{ca=q.Return(null);}b8=ca;return q.Combine(b8,q.Delay(function(){return q.TryWith(q.Delay(function(){return q.Bind(y.Async("WebFace:1",[b7]),function(cd){var ce;cd[0];ce=cd[1];j.addRecord($.New(u,{$:0}),ce);return q.Return(null);});}),function(cf){j.addRecord($.New(u,{$:1}),cf.message);return q.Return(null);});}));});},tryGetCommandFromHistory:function(cg){var ch,ci,cj,ck,cl,cm,cn,cq,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS;ch=r.Get(j.varCommandsHistory().Var);ci=n.length(ch);if(ci===0){cj={$:0};}else{if(j.varCmd().$==1){cm=j.varCmd().$0.Id;cn=function(co){return function(cp){return[cp,co];};};cq=function(cr){var cs,ct;cs=cr[0];cr[1];ct=cs.Id;return z.Equals(ct,cm);};cu=r.Get(j.varCommandsHistory().Var);cv=n.mapi(cn,cu);cw=n.tryFind(cq,cv);cx=[cw,cg];if(cx[0].$==1){if(cx[1]){cx[0].$0[0];cA=cx[0].$0[1];if(ci>0?cA<ci-1:false){cC=cx[0].$0[1];cx[0].$0[0];cB=cC+1;}else{if(cx[0].$==1){if(cx[1]){cE=cx[1]?ci-1:0;}else{cx[0].$0[0];cF=cx[0].$0[1];if(ci>0?cF>0:false){cH=cx[0].$0[1];cx[0].$0[0];cG=cH-1;}else{cG=cx[1]?ci-1:0;}cE=cG;}cD=cE;}else{cD=cx[1]?ci-1:0;}cB=cD;}cz=cB;}else{if(cx[0].$==1){if(cx[1]){cJ=cx[1]?ci-1:0;}else{cx[0].$0[0];cK=cx[0].$0[1];if(ci>0?cK>0:false){cM=cx[0].$0[1];cx[0].$0[0];cL=cM-1;}else{cL=cx[1]?ci-1:0;}cJ=cL;}cI=cJ;}else{cI=cx[1]?ci-1:0;}cz=cI;}cy=cz;}else{if(cx[0].$==1){if(cx[1]){cO=cx[1]?ci-1:0;}else{cx[0].$0[0];cP=cx[0].$0[1];if(ci>0?cP>0:false){cR=cx[0].$0[1];cx[0].$0[0];cQ=cR-1;}else{cQ=cx[1]?ci-1:0;}cO=cQ;}cN=cO;}else{cN=cx[1]?ci-1:0;}cy=cN;}cl=cy;}else{cl=ci-1;}ck=cl;cS=n.nth(ck,ch);cj={$:1,$0:cS};}return cj;},varCmd:$.Field(function(){return{$:0};}),varCommandsHistory:$.Field(function(){var cT,cV;cT=function(cU){return j.cmdKey(cU);};cV=A.LocalStorage("CentBetConsoleCommandsHistory",{Encode:(C.get_Default().EncodeRecord(undefined,[["Id",C.get_Default().EncodeUnion(o,"$",[[0,[["$0","Item",D,0]]]]),0],["Text",D,0]]))(),Decode:(C.get_Default().DecodeRecord(undefined,[["Id",C.get_Default().DecodeUnion(o,"$",[[0,[["$0","Item",D,0]]]]),0],["Text",D,0]]))()});return E.CreateWithStorage(cT,cV);}),varConsole:$.Field(function(){var cW,cY;cW=function(cX){return j.recordKey(cX);};cY=A.LocalStorage("CentBetConsole",{Encode:(C.get_Default().EncodeRecord(undefined,[["Id",C.get_Default().EncodeUnion(o,"$",[[0,[["$0","Item",D,0]]]]),0],["Text",D,0],["Level",C.get_Default().EncodeUnion(u,"$",[[0,[]],[1,[]],[2,[]]]),0]]))(),Decode:(C.get_Default().DecodeRecord(undefined,[["Id",C.get_Default().DecodeUnion(o,"$",[[0,[["$0","Item",D,0]]]]),0],["Text",D,0],["Level",C.get_Default().DecodeUnion(u,"$",[[0,[]],[1,[]],[2,[]]]),0]]))()});return E.CreateWithStorage(cW,cY);})},Coupon:{Event:$.Class({},{id:function(cZ){return cZ.gameId;}}),Meetup:$.Class({},{id:function(c0){return c0.game.gameId;},inplay:function(c1){return r.Get(c1.gameInfo).playMinute.$==1;},notinplay:function(c2){return r.Get(c2.gameInfo).playMinute.$==0;},viewGameInfo:function(c3){return c3.gameInfo.get_View();}}),Render:function(){var c4,c5,c6,da,dj;q.Start(F.workloop(),{$:0});c4=t.get_Do();c5=F.varInplayOnly().get_View();c6=G.Bind(function(c7){return G.Bind(function(c8){return G.Bind(function(c9){var c_,c$;c_=n.isEmpty(c9);c$=!c_;return G.Const([c$,c7,c8]);},F.meetups().get_View());},F.varDataRecived().get_View());},c5);da=function(db){var dc,dd,de,df,dg,dh,di;if(db[2]){if(db[0]){de=g.ofArray([F.renderMeetups()]);dd=f.Element("table",$.New(k,{$:0}),g.ofArray([f.Element("tbody",[],de)]));}else{if(db[1]){dg=g.ofArray([f.TextNode("\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0440\u0430\u0437\u044b\u0433\u0440\u044b\u0432\u0430\u0435\u043c\u044b\u0445 \u0432 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0444\u0443\u0442\u0431\u043e\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0442\u0447\u0430\u0445")]);df=f.Element("h1",[],dg);}else{dh=g.ofArray([f.TextNode("\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0444\u0443\u0442\u0431\u043e\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0442\u0447\u0430\u0445 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f")]);df=f.Element("h1",[],dh);}dd=df;}dc=dd;}else{di=g.ofArray([f.TextNode("\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435.")]);dc=f.Element("h1",[],di);}return dc;};dj=t.Map(da,c6);return f.EmbedView(dj);},RenderMenu:function(){var dk;dk=g.ofArray([F.renderMenusInplay(),F.renderMenuCountries()]);return f.Concat(dk);},addNewGames:function(dl){var dm,dn,_do,dy,dA,dC,dD,dE;dm=r.Get(F.meetups().Var);dn=n.toList(dm);F.meetups().Clear();_do=function(dp){var dq,dr,ds,dt,du,dv,dw,dx;dq=dp[0];dr=dp[1];ds=dp[2];dt=dq.gameId;du=dt[0];dv=dt[1];dw=F.tryGetCountry(du,dv);dx=p.Create(dr);return $.New(H,{game:dq,gameInfo:dx,country:p.Create(dw),hash:ds});};dy=function(dz){return r.Get(dz.gameInfo).order;};dA=function(dB){return F.meetups().Add(dB);};dC=g.map(_do,dl);dD=n.append(dn,dC);dE=n.sortBy(dy,dD);return n.iter(dA,dE);},events:$.Field(function(){var dF,dH;dF=function(dG){return I.id(dG);};dH=$.New(k,{$:0});return E.Create(dF,dH);}),meetups:$.Field(function(){var dI,dK;dI=function(dJ){return H.id(dJ);};dK=$.New(k,{$:0});return E.Create(dI,dK);}),processCoupon:function(){return q.Delay(function(){var dM,dO,dP,dQ;dM=function(dN){return[dN.game.gameId,dN.hash];};dO=r.Get(F.meetups().Var);dP=n.map(dM,dO);dQ=n.toList(dP);return q.Bind(y.Async("WebFace:0",[dQ,r.Get(F.varInplayOnly())]),function(dR){var dS,dT,dU;dS=dR[1];dT=dR[2];dU=dR[0];F.updateCoupon(dU,dS,dT);return q.Return(null);});});},processEvents:function(){return q.Delay(function(){var dW,dX,dY,d3,d4,d5,d6;dW=r.Get(F.events().Var);dX=r.Get(F.meetups().Var);dY=function(dZ){var d0,d2;d0=function(d1){return z.Equals(d1.gameId,dZ.game.gameId);};d2=n.tryFind(d0,dW);return d2.$==0?{$:1,$0:dZ.game.gameId}:{$:0};};d3=n.choose(dY,dX);d4=n.toList(d3);if(d4.$==0){d5=q.Return(null);}else{d6=y.Async("WebFace:2",[d4]);d5=q.Bind(d6,function(d7){var d8;d8=q.For(d7,function(d9){var d_,d$,ea;d_=d9[3];d9[1];d$=d9[0];ea=d9[2];F.events().Add($.New(I,{gameId:d$,country:ea,openDate:d_}));return q.Return(null);});return q.Combine(d8,q.Delay(function(){return q.For(r.Get(F.meetups().Var),function(ec){var ed,ee,ef;ed=ec.game.gameId;ee=ed[0];ef=ed[1];r.Set(ec.country,F.tryGetCountry(ee,ef));return q.Return(null);});}));});}return d5;});},renderMeetup:function(eg,eh,ei){var ej,ek,el,em,en,eo,ep,eq,eA,eB,eC,eM,eN,eO,eP,eQ,eR,e1,e2,e3,fb;ej=[eh,r.Get(eg.gameInfo).playMinute,ei];if(ej[0]){if(ej[1].$==0){el=f.get_Empty();}else{if(ej[2].$==1){en=ej[2].$0;if(en!==""?en!==r.Get(eg.country):false){ej[2].$0;eo=f.get_Empty();}else{ep=eg.gameInfo.get_View();eq=function(er){var es,eu,ev,ew,ey,ez;es=function(et){return et.$==1;};eu=g.ofArray([er.drawBack,er.drawLay,er.winBack,er.winLay,er.loseBack,er.loseLay]);if(n.exists(es,eu)){ew=function(ex){return ex;};ey=F.renderMeetup1(eg,ei.$==1);ez=g.map(ew,ey);ev=f.Element("tr",[],ez);}else{ev=f.get_Empty();}return ev;};eA=t.Map(eq,ep);eo=f.EmbedView(eA);}em=eo;}else{eB=eg.gameInfo.get_View();eC=function(eD){var eE,eG,eH,eI,eK,eL;eE=function(eF){return eF.$==1;};eG=g.ofArray([eD.drawBack,eD.drawLay,eD.winBack,eD.winLay,eD.loseBack,eD.loseLay]);if(n.exists(eE,eG)){eI=function(eJ){return eJ;};eK=F.renderMeetup1(eg,ei.$==1);eL=g.map(eI,eK);eH=f.Element("tr",[],eL);}else{eH=f.get_Empty();}return eH;};eM=t.Map(eC,eB);em=f.EmbedView(eM);}el=em;}ek=el;}else{if(ej[2].$==1){eO=ej[2].$0;if(eO!==""?eO!==r.Get(eg.country):false){ej[2].$0;eP=f.get_Empty();}else{eQ=eg.gameInfo.get_View();eR=function(eS){var eT,eV,eW,eX,eZ,e0;eT=function(eU){return eU.$==1;};eV=g.ofArray([eS.drawBack,eS.drawLay,eS.winBack,eS.winLay,eS.loseBack,eS.loseLay]);if(n.exists(eT,eV)){eX=function(eY){return eY;};eZ=F.renderMeetup1(eg,ei.$==1);e0=g.map(eX,eZ);eW=f.Element("tr",[],e0);}else{eW=f.get_Empty();}return eW;};e1=t.Map(eR,eQ);eP=f.EmbedView(e1);}eN=eP;}else{e2=eg.gameInfo.get_View();e3=function(e4){var e5,e7,e8,e9,e$,fa;e5=function(e6){return e6.$==1;};e7=g.ofArray([e4.drawBack,e4.drawLay,e4.winBack,e4.winLay,e4.loseBack,e4.loseLay]);if(n.exists(e5,e7)){e9=function(e_){return e_;};e$=F.renderMeetup1(eg,ei.$==1);fa=g.map(e9,e$);e8=f.Element("tr",[],fa);}else{e8=f.get_Empty();}return e8;};fb=t.Map(e3,e2);eN=f.EmbedView(fb);}ek=eN;}return ek;},renderMeetup1:function(fc,fd){var fe,fi,fl;fe=function(ff){var fg,fh;fg=fc.gameInfo.get_View();fh=t.Map(ff,fg);return f.TextView(fh);};fi=function(fj,fk){return f.Element("td",g.ofArray([m.Create("class",fj?"kef kef-back":"kef kef-lay")]),g.ofArray([fe(fk)]));};fl=function(fm){return J.formatDecimalOption(fm);};return n.toList(n.delay(function(){var fo;fo=g.ofArray([fe(function(fp){var fq,fr,fs;fq=fp.order;fr=fq[0];fs=fq[1];return $$.String(fr)+"."+$$.String(fs);})]);return n.append([f.Element("td",[],fo)],n.delay(function(){return n.append([f.Element("td",g.ofArray([m.Create("class","home-team")]),g.ofArray([f.TextNode(fc.game.home)]))],n.delay(function(){return n.append([f.Element("td",g.ofArray([m.Create("class","game-status")]),g.ofArray([fe(function(fv){return fv.summary;})]))],n.delay(function(){return n.append([f.Element("td",g.ofArray([m.Create("class","away-team")]),g.ofArray([f.TextNode(fc.game.away)]))],n.delay(function(){return n.append([f.Element("td",g.ofArray([m.Create("class","game-status")]),g.ofArray([fe(function(fy){return fy.status;})]))],n.delay(function(){return n.append([fi(true,function(fA){return fl(fA.winBack);})],n.delay(function(){return n.append([fi(false,function(fC){return fl(fC.winLay);})],n.delay(function(){return n.append([fi(true,function(fE){return fl(fE.drawBack);})],n.delay(function(){return n.append([fi(false,function(fG){return fl(fG.drawLay);})],n.delay(function(){return n.append([fi(true,function(fI){return fl(fI.loseBack);})],n.delay(function(){return n.append([fi(false,function(fK){return fl(fK.loseLay);})],n.delay(function(){var fM,fN,fO;if(!fd){fO=f.TextView(fc.country.get_View());fN=g.ofArray([f.Element("span",g.ofArray([m.Create("class","game-status")]),g.ofArray([fO]))]);fM=[f.Element("td",[],fN)];}else{fM=n.empty();}return fM;}));}));}));}));}));}));}));}));}));}));}));}));},renderMeetups:function(){var fP,fQ;fP=F.meetups().get_View();fQ=function(fR){var fS,fX,f1;fS=function(fT){var fU,fV,fW;fU=fT[0];fV=fT[1];fW=fT[2];return F.renderMeetup(fU,fV,fW);};t.get_Do();fX=G.Bind(function(fY){return G.Bind(function(fZ){return G.Bind(function(f0){return G.Const([fY,fZ,f0]);},F.varSelectedCountry().get_View());},F.varInplayOnly().get_View());},fR);f1=t.Map(fS,fX);return f.EmbedView(f1);};return f.ConvertSeq(fQ,fP);},renderMenuCountries:function(){var f2,f5,gd;t.get_Do();f2=G.Bind(function(f3){return G.Bind(function(f4){return G.Const([f3,f4]);},F.varSelectedCountry().get_View());},F.viewCountries());f5=function(f6){var f7,f8,f9,f_,ga,gb,gc;f7=f6[0];f8=f6[1];if(n.isEmpty(f7)){f9=f.get_Empty();}else{f_=function(f$){return F.renderMenuItemCountry(f8,f$);};ga=n.map(f_,f7);gb=f.Concat(ga);gc=F.renderMenuItemAllCountries();f9=f.Append(gc,gb);}return f9;};gd=t.Map(f5,f2);return f.EmbedView(gd);},renderMenuItemAllCountries:function(){var ge,gf,gp;ge=F.varSelectedCountry().get_View();gf=function(gg){return f.Element("a",n.toList(n.delay(function(){var gi,gj,gk;if(gg.$==1){gj=gg.$0;if(gj!==""){gg.$0;gk=n.empty();}else{gk=[m.Create("class","active")];}gi=gk;}else{gi=[m.Create("class","active")];}return n.append(gi,n.delay(function(){return n.append([m.Create("href","#")],n.delay(function(){return[l.Handler("click",function(){return function(){return r.Set(F.varSelectedCountry(),{$:0});};})];}));}));})),g.ofArray([f.TextNode("\u0412\u0441\u0435 \u0441\u0442\u0440\u0430\u043d\u044b")]));};gp=t.Map(gf,ge);return f.EmbedView(gp);},renderMenuItemCountry:function(gq,gr){return f.Element("a",n.toList(n.delay(function(){var gt,gu,gv;if(gq.$==1){gu=gq.$0;if(gu===gr){gq.$0;gv=[m.Create("class","active")];}else{gv=n.empty();}gt=gv;}else{gt=n.empty();}return n.append(gt,n.delay(function(){return n.append([m.Create("href","#")],n.delay(function(){return[l.Handler("click",function(){return function(){return r.Set(F.varSelectedCountry(),{$:1,$0:gr});};})];}));}));})),g.ofArray([f.TextNode(gr)]));},renderMenusInplay:function(){var gA,gB,gR;gA=F.varInplayOnly().get_View();gB=function(gC){var gD,gF,gQ;gD=function(gE){return gE;};gF=g.ofArray([f.Element("a",n.toList(n.delay(function(){return n.append([m.Create("href","#")],n.delay(function(){return n.append([l.Handler("click",function(){return function(){r.Set(F.varSelectedCountry(),{$:0});r.Set(F.varInplayOnly(),true);return r.Set(F.varDataRecived(),false);};})],n.delay(function(){return gC?[m.Create("class","active")]:n.empty();}));}));})),g.ofArray([f.TextNode("\u0412 \u0438\u0433\u0440\u0435")])),f.Element("a",n.toList(n.delay(function(){return n.append([m.Create("href","#")],n.delay(function(){return n.append([l.Handler("click",function(){return function(){r.Set(F.varSelectedCountry(),{$:0});r.Set(F.varInplayOnly(),false);return r.Set(F.varDataRecived(),false);};})],n.delay(function(){return!gC?[m.Create("class","active")]:n.empty();}));}));})),g.ofArray([f.TextNode("\u0412\u0441\u0435 \u043c\u0430\u0442\u0447\u0438")]))]);gQ=g.map(gD,gF);return f.Concat(gQ);};gR=t.Map(gB,gA);return f.EmbedView(gR);},tryGetCountry:function(gS,gT){var gU,gV,gW,gX,gY,gZ,g0;gU=[gS,gT];gV=gU[0];gW=gU[1];gX=F.tryGetEvent(gV,gW);if(gX.$==1){if(gX.$0.country.$==1){g0=gX.$0.country.$0;gZ=g0;}else{gZ="";}gY=gZ;}else{gY="";}return gY;},tryGetEvent:function(g1,g2){var g3,g4,g7;g3=[g1,g2];g4=function(g5){var g6;g6=g5.gameId;return z.Equals(g3,g6);};g7=r.Get(F.events().Var);return n.tryFind(g4,g7);},updateCoupon:function(g8,g9,g_){var g$,ha,hb,he,hf,hg,hh,hj,hm,hn;g$=g8.$==0;if(!g$){hb=function(hc){var hd;hd="adding new games "+$$.String(hc);return K?K.log(hd):undefined;};he=g8.get_Length();hb(he);ha=F.addNewGames(g8);}else{ha=null;}hf=n.isEmpty(g_);if(!hf){hh=function(hi){return F.meetups().RemoveByKey(hi);};n.iter(hh,g_);hj=function(hk){var hl;hl="removing out games "+$$.String(hk);return K?K.log(hl):undefined;};hm=n.length(g_);hg=hj(hm);}else{hg=null;}hn=function(ho){var hp,hq,hr,hs,ht,hu;hp=ho[0];hq=ho[1];hr=ho[2];hs=F.meetups().TryFindByKey(hp);if(hs.$==1){hu=hs.$0;r.Set(hu.gameInfo,hq);ht=void(hu.hash=hr);}else{ht=null;}return ht;};return n.iter(hn,g9);},varDataRecived:$.Field(function(){return p.Create(false);}),varInplayOnly:$.Field(function(){return p.Create(true);}),varSelectedCountry:$.Field(function(){return p.Create({$:0});}),viewCountries:function(){var hv,hw;hv=t.get_Do();hw=F.events().get_View();return G.Bind(function(hx){var hy,hA,hB,hC;hy=function(hz){return[hz.gameId,hz];};hA=n.map(hy,hx);hB=M.OfArray(n.toArray(hA));hC=F.viewGames();return G.Bind(function(hD){var hE,hK,hL,hM,hO,hP,hR,hS;hE=function(hF){var hG,hH,hJ;hG=hF[0];hF[1];hH=function(hI){return hI.country;};hJ=hB.TryFind(hG.gameId);return s.map(hH,hJ);};hK=n.choose(hE,hD);hL={$:0};hM=function(hN){return!z.Equals(hL,hN);};hO=n.filter(hM,hK);hP=function(hQ){return hQ;};hR=n.choose(hP,hO);hS=w.distinct(hR);return G.Const(n.sort(hS));},hC);},hw);},viewGames:$.Field(function(){var hT,hU;hT=t.get_Do();hU=F.meetups().get_View();return G.Bind(function(hV){var hW,hX;if(n.isEmpty(hV)){hW=G.Const(n.empty());}else{hX=F.varInplayOnly().get_View();hW=G.Bind(function(hY){var hZ,h1,h6,h7;hZ=function(h0){return!hY?true:r.Get(h0.gameInfo).playMinute.$==1;};h1=function(h2){var h3,h5;h3=function(h4){return[h2.game,h4];};h5=h2.gameInfo.get_View();return t.Map(h3,h5);};h6=n.filter(hZ,hV);h7=n.map(h1,h6);return G.Bind(function(h8){return G.Const(h8);},G.Sequence(h7));},hX);}return hW;},hU);}),workloop:function(){return q.Delay(function(){return q.Combine(q.TryWith(q.Delay(function(){return q.Bind(F.processCoupon(),function(){return q.Bind(F.processEvents(),function(){r.Set(F.varDataRecived(),true);return q.Return(null);});});}),function(ib){var ic;ic=function(id){var ie;ie="error updating coupon : "+b.prettyPrint(id);return K?K.log(ie):undefined;};ic(ib);return q.Bind(q.Sleep(5000),function(){return q.Return(null);});}),q.Delay(function(){return F.workloop();}));});}},Utils:{dateTimeToString:function($s){var $0=this,$this=this;return $$.dateTimeToString($s);},formatDecimal:function(ih){return J.trimEnd(ih.toFixed(6),g.ofArray([48,46]));},formatDecimalOption:function(ii){var ij,ik;if(ii.$==1){ik=ii.$0;ij=J.formatDecimal(ik);}else{ij="";}return ij;},getDatePart:function(il){var im;im=new N(il.getTime());im.setHours(0,0,0,0);return im;},mkids:function(_in,io){var ip,ir,is,it,iu;ip=function(iq){return[io(iq),iq];};ir=g.map(ip,_in);is=M.OfArray(n.toArray(ir));it=g.map(io,_in);iu=O.New1(P.OfSeq(it));return[iu,is];},trimEnd:function(iv,iw){var ix,iy,iz,iA,iB,iC,iD,iE,iF,iG,iH,iI;ix=[iv,iw];if(ix[0]===""){iy="";}else{if(ix[1].$==1){iA=ix[0];ix[1];iB=ix[1].$0;if(iA.charCodeAt(iA.length-1)===iB){ix[1].$0;iD=ix[1];iE=ix[0];iC=J.trimEnd(Q.string(iE,{$:0},{$:1,$0:iE.length-2}),iD);}else{if(ix[1].$==1){iG=ix[0];iH=ix[1].$1;iF=J.trimEnd(iG,iH);}else{iF=R.Raise(S.New("E:\\User\\Docs\\Visual Studio 2015\\Projects\\Betfair\\CentBet\\WebFace\\ClientUtils.fs",9,18));}iC=iF;}iz=iC;}else{iI=ix[0];iz=iI;}iy=iz;}return iy;}}}}});$.OnInit(function(){a=$.Safe($$.JSON);b=$.Safe($$.WebSharper.PrintfHelpers);c=$.Safe($$.window);d=$.Safe($$.WebSharper.UI);e=$.Safe(d.Next);f=$.Safe(e.Doc);g=$.Safe($$.WebSharper.List);h=$.Safe($$.CentBet);i=$.Safe(h.Client);j=$.Safe(i.Admin);k=$.Safe(g.T);l=$.Safe(e.AttrModule);m=$.Safe(e.AttrProxy);n=$.Safe($$.WebSharper.Seq);o=$.Safe(e.Key);p=$.Safe(e.Var);q=$.Safe($$.WebSharper.Concurrency);r=$.Safe(e.Var1);s=$.Safe($$.WebSharper.Option);t=$.Safe(e.View);u=$.Safe(j.Level);v=$.Safe($$.WebSharper.Strings);w=$.Safe($$.Seq);x=$.Safe($$.WebSharper.Remoting);y=$.Safe(x.AjaxRemotingProvider);z=$.Safe($$.WebSharper.Unchecked);A=$.Safe(e.Storage1);B=$.Safe($$.WebSharper.Json);C=$.Safe(B.Provider);D=$.Safe(C.Id);E=$.Safe(e.ListModel);F=$.Safe(i.Coupon);G=$.Safe(e.View1);H=$.Safe(F.Meetup);I=$.Safe(F.Event);J=$.Safe(i.Utils);K=$.Safe($$.console);L=$.Safe($$.WebSharper.Collections);M=$.Safe(L.MapModule);N=$.Safe($$.Date);O=$.Safe(L.FSharpSet);P=$.Safe(L.BalancedTree);Q=$.Safe($$.WebSharper.Slice);R=$.Safe($$.WebSharper.Operators);return S=$.Safe($$.WebSharper.MatchFailureException);});$.OnLoad(function(){F.viewGames();F.varSelectedCountry();F.varInplayOnly();F.varDataRecived();F.meetups();F.events();j.varConsole();j.varCommandsHistory();j.varCmd();j.renderRecord();j.op_SpliceUntyped();j["cmd-input"]();return;});}());
