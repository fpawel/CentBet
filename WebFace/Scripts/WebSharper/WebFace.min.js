(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8;$.Define($$,{CentBet:{Client:{Admin:{RecordType:$.Class({},{get_color:function(){return function(_9){return _9.$==1?["lightgrey","red"]:_9.$==2?["lightgrey","green"]:["white","navy"];};}}),Render:function(){var _;_=$.New(h,{$:0});return c.Concat(d.ofArray([g.RenderCommandPrompt(),(g.op_SpliceUntyped())(c.Element("br",[],_)),g.RenderRecords()]));},RenderCommandPrompt:function(){var ba;ba=d.ofArray([(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("margin-left","10px")]),$.New(h,{$:0}))),(g.op_SpliceUntyped())(c.Element("label",d.ofArray([j.Create("for",g["cmd-input"]())]),d.ofArray([c.TextNode("Input here:")]))),g.renderInput()]);return c.Concat(ba);},RenderRecords:function(){var ba,be;ba=function(bb){var bc,bd;bd=$.New(h,{$:0});bc=d.ofArray([(g.renderRecord())(bb),(g.op_SpliceUntyped())(c.Element("br",[],bd))]);return c.Concat(bc);};be=g.varConsole().get_View();return c.ConvertSeq(ba,be);},addRecord:function(bf,bg){return g.varConsole().Add({Id:k.Fresh(),Text:bg,RecordType:bf});},"cmd-input":$.Field(function(){return"cmd-input";}),cmdKey:function(bh){return bh.Id;},doc:function(bi){return bi;},op_SpliceUntyped:$.Field(function(){return function(bj){return g.doc(bj);};}),recordKey:function(bk){return bk.Id;},renderInput:function(){var bl,bm,bn,bo,br,bu,by,bz,bP;bl=l.Create("");bm=l.Create(null);bn=l.Create(false);bo=m.Delay(function(){n.Set(bn,true);return m.Bind(g.send(n.Get(bl)),function(){n.Set(bn,false);n.Set(bl,"");return m.Return(null);});});br=function(bs){var bt;bt={$:1,$0:bs};g.varCmd=function(){return bt;};return n.Set(bl,bs.Text);};bu=function(bv){var bw,bx;bw=g.tryGetCommandFromHistory(bv);bx=o.map(br,bw);return;};by=bn.get_View();bz=function(bA){var bB;bB=d.ofArray([c.Input(p.toList(p.delay(function(){return p.append([j.Create("id",g["cmd-input"]())],p.delay(function(){return p.append(bA?[j.Create("disabled","disabled")]:p.empty(),p.delay(function(){return p.append([i.Style("width","80%")],p.delay(function(){return p.append([i.CustomVar(bm,function(bG){return function(){return bG.focus();};},function(){return{$:0};})],p.delay(function(){return[i.Handler("keydown",function(){return function(bL){var bM,bN,bO;bM=bL.keyCode;if(bM===13){bO=n.Get(bl).toLowerCase();bN=bO==="-clear-output"?g.varConsole().Clear():bO==="-clear-hist"?g.varCommandsHistory().Clear():m.Start(bo,{$:0});}else{bN=bM===38?bu(true):bM===40?bu(false):null;}return bN;};})];}));}));}));}));})),bl)]);return c.Concat(bB);};bP=q.Map(bz,by);return c.EmbedView(bP);},renderRecord:$.Field(function(){var bQ;bQ=function(bR){var bS,bT,bU,bV,bW;try{bT=(r.get_color())(bR.RecordType);bU=bT[1];bV=bT[0];bS=(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("color",bU),i.Style("background",bV)]),d.ofArray([c.TextNode(bR.Text)])));}catch(bW){g.varCommandsHistory().Clear();g.varConsole().Clear();bS=c.get_Empty();}return bS;};return function(bX){var bY;bY=q.Map(bQ,bX);return c.EmbedView(bY);};}),send:function(bZ){return m.Delay(function(){var b1,b2,b3,b4,b5,b6;b1=s.Trim(bZ);g.addRecord($.New(r,{$:2}),b1);b3=n.Get(g.varCommandsHistory().Var);if(p.isEmpty(b3)){b4=true;}else{b5=t.last(b3);b4=b5.Text!==b1;}if(b4){g.varCommandsHistory().Add({Id:k.Fresh(),Text:b1});b6=m.Return(null);}else{b6=m.Return(null);}b2=b6;return m.Combine(b2,m.Delay(function(){return m.TryWith(m.Delay(function(){var b9;b9=v.Async("WebFace:2",[b1]);return m.Bind(b9,function(b_){var b$,ca,cb;if(b_.$==1){ca=b_.$0;g.addRecord($.New(r,{$:1}),ca);b$=m.Return(null);}else{cb=b_.$0;g.addRecord($.New(r,{$:0}),cb);b$=m.Return(null);}return b$;});}),function(cc){g.addRecord($.New(r,{$:1}),cc.message);return m.Return(null);});}));});},tryGetCommandFromHistory:function(cd){var ce,cf,cg,ch,ci,cj,ck,cn,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP;ce=n.Get(g.varCommandsHistory().Var);cf=p.length(ce);if(cf===0){cg={$:0};}else{if(g.varCmd().$==1){cj=g.varCmd().$0.Id;ck=function(cl){return function(cm){return[cm,cl];};};cn=function(co){var cp,cq;cp=co[0];co[1];cq=cp.Id;return w.Equals(cq,cj);};cr=n.Get(g.varCommandsHistory().Var);cs=p.mapi(ck,cr);ct=p.tryFind(cn,cs);cu=[ct,cd];if(cu[0].$==1){if(cu[1]){cu[0].$0[0];cx=cu[0].$0[1];if(cf>0?cx<cf-1:false){cz=cu[0].$0[1];cu[0].$0[0];cy=cz+1;}else{if(cu[0].$==1){if(cu[1]){cB=cu[1]?cf-1:0;}else{cu[0].$0[0];cC=cu[0].$0[1];if(cf>0?cC>0:false){cE=cu[0].$0[1];cu[0].$0[0];cD=cE-1;}else{cD=cu[1]?cf-1:0;}cB=cD;}cA=cB;}else{cA=cu[1]?cf-1:0;}cy=cA;}cw=cy;}else{if(cu[0].$==1){if(cu[1]){cG=cu[1]?cf-1:0;}else{cu[0].$0[0];cH=cu[0].$0[1];if(cf>0?cH>0:false){cJ=cu[0].$0[1];cu[0].$0[0];cI=cJ-1;}else{cI=cu[1]?cf-1:0;}cG=cI;}cF=cG;}else{cF=cu[1]?cf-1:0;}cw=cF;}cv=cw;}else{if(cu[0].$==1){if(cu[1]){cL=cu[1]?cf-1:0;}else{cu[0].$0[0];cM=cu[0].$0[1];if(cf>0?cM>0:false){cO=cu[0].$0[1];cu[0].$0[0];cN=cO-1;}else{cN=cu[1]?cf-1:0;}cL=cN;}cK=cL;}else{cK=cu[1]?cf-1:0;}cv=cK;}ci=cv;}else{ci=cf-1;}ch=ci;cP=p.nth(ch,ce);cg={$:1,$0:cP};}return cg;},varCmd:$.Field(function(){return{$:0};}),varCommandsHistory:$.Field(function(){var cQ,cR,cS,cV,cX,cY,cZ,c3,c4,c8,c_;try{cS=function(cT){var cU;cU="restoring list - "+x.prettyPrint(cT);return y?y.log(cU):undefined;};cS("CentBetConsoleCommandsHistory");cV=function(cW){return g.cmdKey(cW);};cX=z.LocalStorage("CentBetConsoleCommandsHistory",{Encode:(B.get_Default().EncodeRecord(undefined,[["Id",B.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0]]))(),Decode:(B.get_Default().DecodeRecord(undefined,[["Id",B.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0]]))()});cY=D.CreateWithStorage(cV,cX);cZ=function(c0){return function(c1){var c2;c2=x.prettyPrint(c0)+" - "+$$.String(c1);return y?y.log(c2):undefined;};};(cZ("CentBetConsoleCommandsHistory"))(cY.get_Length());cR=cY;}catch(c3){c4=function(c5){return function(c6){var c7;c7="error when restoring "+x.prettyPrint(c5)+" - "+x.prettyPrint(c6);return y?y.log(c7):undefined;};};(c4("CentBetConsoleCommandsHistory"))(c3);c8=function(c9){return g.cmdKey(c9);};c_=$.New(h,{$:0});cR=D.Create(c8,c_);}cQ=cR;return cQ;}),varConsole:$.Field(function(){var c$,da,db,de,dg,dh,di,dm,dn,dr,dt;try{db=function(dc){var dd;dd="restoring list - "+x.prettyPrint(dc);return y?y.log(dd):undefined;};db("CentBetConsole");de=function(df){return g.recordKey(df);};dg=z.LocalStorage("CentBetConsole",{Encode:(B.get_Default().EncodeRecord(undefined,[["Id",B.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0],["RecordType",B.get_Default().EncodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))(),Decode:(B.get_Default().DecodeRecord(undefined,[["Id",B.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0],["RecordType",B.get_Default().DecodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))()});dh=D.CreateWithStorage(de,dg);di=function(dj){return function(dk){var dl;dl=x.prettyPrint(dj)+" - "+$$.String(dk);return y?y.log(dl):undefined;};};(di("CentBetConsole"))(dh.get_Length());da=dh;}catch(dm){dn=function(_do){return function(dp){var dq;dq="error when restoring "+x.prettyPrint(_do)+" - "+x.prettyPrint(dp);return y?y.log(dq):undefined;};};(dn("CentBetConsole"))(dm);dr=function(ds){return g.recordKey(ds);};dt=$.New(h,{$:0});da=D.Create(dr,dt);}c$=da;return c$;})},Coupon:{Render:function(){var du,dv,dw,dx,dJ;du=l.Create(false);E.start(du);dw=F.varMode().get_View();dx=function(dy){var dz,dA,dB,dH,dI;if(dy.$==1){dA=dy.$0;dz=G.renderExploreMarkets(dA);}else{dB=function(dC){var dD,dE,dF,dG;if(dC){dE=H["render\u0421oupon"]();dD=H.doc(dE);}else{dF=d.ofArray([c.TextNode("\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435.")]);dG=c.Element("h1",[],dF);dD=H.doc(dG);}return dD;};dH=du.get_View();dI=q.Map(dB,dH);dz=c.EmbedView(dI);}return dz;};dJ=q.Map(dx,dw);dv=d.ofArray([c.EmbedView(dJ)]);return c.Concat(dv);},SettingsDialog:{Helpers:{buttonDoc:function(dK){var dL,dM,dQ;dL=I.view();dM=function(dN){var dO,dP;if((dK?dN===40:false)?true:!dK?dN===10:false){dO=c.get_Empty();}else{dP=K.buttonElt(dK,dN);dO=H.doc(dP);}return dO;};dQ=q.Map(dM,dL);return c.EmbedView(dQ);},buttonElt:function(dR,dS){var d1;d1=dR?"+":"-";return c.Element("button",d.ofArray([K.op_SpliceUntyped("w3-btn w3-teal"),j.Create("style","margin: 10px; width: 50px; height: 50px;"),i.Handler("click",function(){return function(){var dV,dW,dX,dY,dZ,d0;dV=[dR,dS];if(dV[0]){if(dV[1]===40){dX=null;}else{dY=dS+(dR?1:-1);dX=I.set(dY);}dW=dX;}else{if(dV[1]===10){dZ=null;}else{d0=dS+(dR?1:-1);dZ=I.set(d0);}dW=dZ;}return dW;};})]),d.ofArray([c.TextNode(d1)]));},close:function(){return n.Set(K.varVisible(),false);},content:$.Field(function(){var d2,d4,d5,d7;d2=L.titleAndCloseButton("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0442\u0447\u0435\u0439 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435",function(){return K.close();});d5=function(d6){return $$.String(d6);};d7=I.view();d4=c.Element("div",d.ofArray([K.op_SpliceUntyped("w3-xxlarge"),j.Create("style","margin : 10px; float : left;")]),d.ofArray([c.TextView(q.Map(d5,d7))]));return d.ofArray([H.doc(d2),H.doc(d4),K.buttonDoc(true),K.buttonDoc(false)]);}),op_SpliceUntyped:function(d8){return j.Create("class",d8);},renderDialog:$.Field(function(){return L.createModal(K.varVisible().get_View(),function(){return K.close();});}),varVisible:$.Field(function(){return l.Create(false);})},elt:$.Field(function(){return((K.renderDialog())($.New(h,{$:0})))(K.content());}),show:function(){return n.Set(K.varVisible(),true);}},doc:function(d_){return d_;},renderMeetup:$.Field(function(){var d$,ea,eb;d$=[F.varColumnGpbVisible().get_View(),F.varColumnCountryVisible().get_View()];ea=d$[0];eb=d$[1];return function(ec){return M.renderMeetup(ea,eb,ec);};}),renderPagination:$.Field(function(){var ed,ee,ef;ed=q.get_Do();ee=F.varPagesCount().get_View();ef=N.Bind(function(eg){var eh;eh=F.varCurrentPageNumber().get_View();return N.Bind(function(ei){var ej,em,ez;ej=i.Handler("click",function(){return function(){return J.show();};});em=p.toList(p.delay(function(){return p.append(p.map(function(eo){var ep,ev,ew;ep=p.toList(p.delay(function(){return p.append([j.Create("href","#")],p.delay(function(){return p.append([i.Handler("click",function(){return function(){return n.Set(F.varTargetPageNumber(),eo);};})],p.delay(function(){return eo===ei?[j.Create("class","w3-teal")]:p.empty();}));}));}));ew=$$.String(eo+1);ev=d.ofArray([c.Element("a",ep,d.ofArray([c.TextNode(ew)]))]);return c.Element("li",[],ev);},O.range(0,eg-1)),p.delay(function(){var ey;ey=d.ofArray([c.Element("a",d.ofArray([j.Create("href","#"),ej]),d.ofArray([c.TextNode("...")]))]);return[c.Element("li",[],ey)];}));}));ez=d.map(function(eA){return H.doc(eA);},em);return N.Const(c.Concat(ez));},eh);},ee);return c.EmbedView(ef);}),"render\u0421oupon":$.Field(function(){var eB,eC,eD,eE,eF,eG,eJ,eK,eL,eM,eN,eO,eP;eB=d.ofArray([j.Create("class","w3-responsive")]);eD=d.ofArray([j.Create("class","football-games-list w3-table w3-bordered w3-striped w3-hoverable")]);eE=d.ofArray([c.Element("tr",d.ofArray([i.Class("coupon-header-row w3-teal")]),M.renderGamesHeaderRow(F.varColumnGpbVisible().get_View()))]);eG=function(eH){var eI;eI=p.map(H.renderMeetup(),eH);return c.Concat(eI);};eJ=F.meetups().get_View();eK=q.Map(eG,eJ);eF=d.ofArray([c.EmbedView(eK)]);eC=d.ofArray([c.Element("table",eD,d.ofArray([c.Element("thead",[],eE),c.Element("tbody",[],eF)]))]);eL=c.Element("div",eB,eC);eM=d.ofArray([j.Create("class","w3-container")]);eN=q.get_Do();eO=F.varCurrentPageNumber().get_View();eP=N.Bind(function(eQ){return N.Bind(function(eR){var eS,eT,eU,eV;if(eQ===eR){eT=eL;}else{eV="\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u2116 "+$$.String(eR+1)+"...";eU=d.ofArray([c.TextNode(eV)]);eT=c.Element("h1",[],eU);}eS=eT;return N.Const(H.doc(eS));},F.varTargetPageNumber().get_View());},eO);return c.Element("div",eM,d.ofArray([c.Element("div",d.ofArray([j.Create("class","w3-center")]),d.ofArray([c.Element("ul",d.ofArray([j.Create("class","w3-pagination w3-border w3-round")]),d.ofArray([H.renderPagination()]))])),c.EmbedView(eP),J.elt()]));})},Football:{Event:$.Class({},{id:function(eW){return eW.gameId;}}),Market:$.Class({},{New:function(eX,eY,eZ){var e1;e1=function(e2){var e3,e4;e3=e2[0];e4=e2[1];return{selectionId:e4,runnerName:e3};};return $.New(Q,{marketId:eX,marketName:eY,runners:d.map(e1,eZ)});},id:function(e5){return e5.marketId;}}),MarketBook:$.Class({},{New:function(e6){var e7,e9;e7=function(e8){return S.New(e8);};e9=e6.runners;return $.New(R,{marketId:e6.marketId,marketName:e6.marketName,expanded:l.Create(false),runners:d.map(e7,e9),pricesReaded:l.Create(false)});},id:function(e_){return e_.marketId;}}),Meetup:$.Class({},{id:function(e$){return e$.game.gameId;}}),RunnerBook:$.Class({},{New:function(fa){return $.New(S,{selectionId:fa.selectionId,runnerName:fa.runnerName,back:l.Create($.New(h,{$:0})),lay:l.Create($.New(h,{$:0}))});}}),Side:$.Class({},{get_what:function(){return function(fb){return fb.$==1?"lay":"back";};}})},GameDetail:{Helpers:{kefClass:function(fc){return"runner-kef runner-"+x.toSafe((T.get_what())(fc));},renderAvailPricesTooltip:$.Field(function(){var fd,fm;fd=function(fe){var ff,fg,fh,fi,fj,fl;ff=fe[0];fg=fe[1];fi=L.formatDecimal(ff);fh=d.ofArray([c.Element("td",d.ofArray([G.op_SpliceUntyped("runner-tooltip-price")]),d.ofArray([c.TextNode(fi)])),c.Element("td",d.ofArray([G.op_SpliceUntyped("runner-tooltip-size")]),d.ofArray([(U.renderSize())(fg)]))]);fj=d.map(function(fk){return G.doc(fk);},fh);fl=c.Element("tr",[],fj);return G.doc(fl);};fm=d.ofArray([G.op_SpliceUntyped("tooltip-content runner-avail-prices-container")]);return function(fn){var fo,fp;fo=p.map(fd,fn);fp=c.Element("table",fm,fo);return G.doc(fp);};}),renderGameInfo:function(fq){var fr,fu,fv,fw,fx,fy,fI,fJ,fK,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f0;fr=function(fs){var ft;ft=V.getWith("",fs);return c.TextNode(ft);};fu=fq.country.get_View();fv=q.Map(fr,fu);fw=c.EmbedView(fv);fx=fq.totalMatched.get_View();fy=function(fz){var fA,fC,fF,fG,fH;fA=function(fB){return fB[1];};fC=function(fD){return function(fE){return fD+fE;};};fF=d.map(fA,fz);fG=p.fold(fC,0,fF);fH=fG===0?"":$$.String(fG)+" GPB";return c.TextNode(fH);};fI=q.Map(fy,fx);fJ=c.EmbedView(fI);fK=d.ofArray([j.Create("href","#"),i.Handler("click",function(){return function(){return n.Set(F.varMode(),{$:0});};})]);fN=d.ofArray([c.TextNode("\u041d\u0430\u0437\u0430\u0434 \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u043c\u0430\u0442\u0447\u0435\u0439")]);fO=c.Element("a",fK,fN);fP=d.ofArray([fO]);fQ=fq.game.home;fR=d.ofArray([c.TextView(fq.summary.get_View())]);fS=fq.game.away;fT=d.ofArray([fw]);fU=d.ofArray([c.TextView(fq.status.get_View())]);fV=d.ofArray([fJ]);fW=[j.Create("class","w3-indigo")];fX=[];fY=[];fZ=[];f0=[];return c.Concat([c.Element("div",fW,[c.TextNode("\n    "),c.Element("div",[j.Create("style","text-align: left; padding-left : 5px;")],[c.TextNode("\n        "),c.Concat(fP),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("table",fX,[c.TextNode("\n        "),c.Element("tr",fY,[c.TextNode("\n            "),c.Element("td",[j.Create("style","width : 40%")],[c.TextNode("\n                "),c.Element("h1",[j.Create("style","text-align: right;")],[c.TextNode("\n                    "),c.TextNode(fQ),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[j.Create("style","width : 20%")],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: center; color : #b4e500;")],[c.TextNode("\n                    "),c.Concat(fR),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[j.Create("style","width : 40%")],[c.TextNode("\n                "),c.Element("h1",[j.Create("style","text-align: left;")],[c.TextNode("\n                    "),c.TextNode(fS),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n        ")]),c.TextNode("\n    ")]),c.TextNode("\n    "),c.Element("table",fZ,[c.TextNode("\n        "),c.Element("tr",f0,[c.TextNode("\n            "),c.Element("td",[j.Create("style","width : 40%")],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: left; padding-left:5px;")],[c.TextNode("\n                    "),c.Concat(fT),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[j.Create("style","width : 20%")],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: center;")],[c.TextNode("\n                    "),c.Concat(fU),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[j.Create("style","width : 40%")],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: right; padding-right:5px;")],[c.TextNode("\n                    "),c.Concat(fV),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n        ")]),c.TextNode("\n    ")]),c.TextNode("\n")])]);},renderKef:function(f1,f2){var f3,f4,f5,f6;f3=q.get_Do();f4=w.Equals(f1,$.New(T,{$:0}))?f2.back:f2.lay;f5=f4.get_View();f6=N.Bind(function(f7){var f8,f9,f_,f$,ga,gb,gc,gd,ge;if(f7.$==1){if(f7.$1.$==0){f_=f7.$0[0];f$=f7.$0[1];f9=c.Element("td",d.ofArray([G.op_SpliceUntyped(U.kefClass(f1))]),U.renderPriceSizeButton(f_,f$));}else{ga=f7.$1;gb=f7.$0[0];gc=f7.$0[1];gd=(U.renderAvailPricesTooltip())(ga);ge=U.renderPriceSizeButton(gb,gc);f9=c.Element("td",d.ofArray([G.op_SpliceUntyped(U.kefClass(f1))]),d.ofArray([c.Element("div",d.ofArray([G.op_SpliceUntyped("tooltip"),i.Style("width","100%")]),$.New(h,{$:1,$0:gd,$1:ge}))]));}f8=f9;}else{f8=c.Element("td",d.ofArray([G.op_SpliceUntyped("runner-kef")]),$.New(h,{$:0}));}return N.Const(f8);},f5);return c.EmbedView(f6);},renderMarket:function(gf){var gg,gh,gu;gg=gf.expanded.get_View();gh=function(gi){var gj,gk,gl,gm,gn,go,gr,gs,gt;gj=U.renderTitle(gi,gf);if(!gi){gl=gj;}else{gm=d.ofArray([G.op_SpliceUntyped("table-horiz-lines")]);gn=d.ofArray([c.Element("td",d.ofArray([j.Create("colspan","3")]),d.ofArray([gj]))]);go=function(gp){var gq;gq=U.renderRunner(gp);return G.doc(gq);};gr=gf.runners;gs=d.map(go,gr);gl=c.Element("table",gm,d.ofArray([c.Element("tr",[],gn),c.Concat(gs)]));}gk=gl;gt=d.ofArray([gk]);return c.Element("li",[],gt);};gu=q.Map(gh,gg);return c.EmbedView(gu);},renderMarkets:function(gv){var gw,gx,gA,gC,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ,gR,gS,gT,gU,gV;gw=j.Create("style","border-right : 1px solid #ddd;");gx=function(gy){return d.map(function(gz){return U.renderMarket(gz);},gy);};gA=function(gB){return gB.marketName!=="\u0410\u0437\u0438\u0430\u0442\u0441\u043a\u0438\u0439 \u0433\u0430\u043d\u0434\u0438\u043a\u0430\u043f";};gC=function(gD){return[gD.marketName!=="\u0421\u0442\u0430\u0432\u043a\u0438",gD.marketName];};gE=gv.marketsBook;gF=p.filter(gA,gE);gG=p.sortBy(gC,gF);gH=(U.window(3))(gG);if(gH.$==1){if(gH.$1.$==1){if(gH.$1.$1.$==1){if(gH.$1.$1.$1.$==0){gM=gH.$0;gN=gH.$1.$0;gO=gH.$1.$1.$0;gP=d.ofArray([G.op_SpliceUntyped("w3-row")]);gQ=c.Element("div",gP,d.ofArray([c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),gx(gM)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),gx(gN)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),gx(gO))]));gL=G.doc(gQ);}else{gL=c.get_Empty();}gK=gL;}else{gR=gH.$0;gS=gH.$1.$0;gT=c.Element("div",d.ofArray([G.op_SpliceUntyped("w3-row")]),d.ofArray([c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s6")]),gx(gR)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s6")]),gx(gS))]));gK=G.doc(gT);}gJ=gK;}else{gU=gH.$0;gV=c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul")]),gx(gU));gJ=G.doc(gV);}gI=gJ;}else{gI=c.get_Empty();}return gI;},renderPriceSizeButton:function(gW,gX){var gY,g3,g4;gY=function(gZ){var g0,g1,g2;g0=gZ[0];g1=gZ[1];g2=c.Element("div",d.ofArray([G.op_SpliceUntyped(g0)]),d.ofArray([g1]));return G.doc(g2);};g4=L.formatDecimal(gW);g3=d.ofArray([["runner-kef-price",c.TextNode(g4)],["runner-kef-size",(U.renderSize())(gX)]]);return d.map(gY,g3);},renderRunner:function(g5){var g6;g6=d.ofArray([c.Element("td",d.ofArray([G.op_SpliceUntyped("runner-name")]),d.ofArray([c.TextNode(g5.runnerName)])),U.renderKef($.New(T,{$:0}),g5),U.renderKef($.New(T,{$:1}),g5)]);return c.Element("tr",[],g6);},renderSize:$.Field(function(){return function(g7){var g8,g9;g8=L.round(g7);g9=x.toSafe(L.formatDecimal(g8))+"$";return c.TextNode(g9);};}),renderTitle:function(g_,g$){var ha,hb,hc;ha=g_?["up","expanded"]:["down",""];hb=ha[1];hc=ha[0];return c.Element("a",d.ofArray([j.Create("href","#"),i.Handler("click",function(){return function(){return n.Set(g$.expanded,!n.Get(g$.expanded));};}),G.op_SpliceUntyped("runners-title "+x.toSafe(hb))]),d.ofArray([c.Element("i",d.ofArray([G.op_SpliceUntyped("fa fa-chevron-"+x.toSafe(hc))]),$.New(h,{$:0})),c.TextNode(g$.marketName)]));},window:function(hf){var hg,hj,hl;hg=function(hh){return function(hi){return[hh%hf,hi];};};hj=function(hk){return hk[0];};hl=function(hm){var hn,ho;hm[0];hn=hm[1];ho=p.map(function(hp){return hp[1];},hn);return p.toList(ho);};return function(hq){var hr,hs,ht;hr=p.mapi(hg,hq);hs=t.groupBy(hj,hr);ht=p.map(hl,hs);return p.toList(ht);};}},doc:function(hu){return hu;},op_SpliceUntyped:function(hv){return j.Create("class",hv);},renderExploreMarkets:function(hw){var hx;hx=d.ofArray([U.renderGameInfo(hw),U.renderMarkets(hw)]);return c.Concat(hx);},varError:$.Field(function(){return l.Create(false);})},Meetup:{doc:function(hy){return hy;},renderCountry:function(hz,hA){var hB,hC;hB=q.get_Do();hC=N.Bind(function(hD){return!hD?N.Const(c.get_Empty()):N.Bind(function(hE){var hF,hG,hH,hI;if(hE.$==1){hH=hE.$0;hG=c.Element("td",d.ofArray([j.Create("style","color : #009900;")]),d.ofArray([c.TextNode(hH)]));}else{hI=$.New(h,{$:0});hG=c.Element("td",[],hI);}hF=hG;return N.Const(M.doc(hF));},hA);},hz);return c.EmbedView(hC);},renderGamesHeaderRow:function(hJ){return p.toList(p.delay(function(){var hL,hM,hN,hO,hP,hQ;hM=d.ofArray([c.TextNode("\u2116")]);hN=d.ofArray([c.TextNode("\u0414\u043e\u043c\u0430")]);hO=$.New(h,{$:0});hP=d.ofArray([c.TextNode("\u0412 \u0433\u043e\u0441\u0442\u044f\u0445")]);hQ=$.New(h,{$:0});hL=d.ofArray([c.Element("th",[],hM),c.Element("th",[],hN),c.Element("th",[],hO),c.Element("th",[],hP),c.Element("th",[],hQ),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041f\u043e\u0431\u0435\u0434\u0430")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041d\u0438\u0447\u044c\u044f")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u0435")]))]);return p.append(d.map(function(hR){return M.doc(hR);},hL),p.delay(function(){var hT,hY;hT=function(hU){var hV,hW,hX;if(hU){hW=d.ofArray([c.TextNode("GPB")]);hX=c.Element("th",[],hW);hV=M.doc(hX);}else{hV=c.get_Empty();}return hV;};hY=q.Map(hT,hJ);return p.append([c.EmbedView(hY)],p.delay(function(){var h0,h1;h0=$.New(h,{$:0});h1=c.Element("th",[],h0);return[M.doc(h1)];}));}));}));},renderKef:function(h2){var h3,h8,h9;h3=function(h4){var h5,h6,h7;if(h4.$==1){h6=h4.$0;h7=L.formatDecimal(h6);h5=c.TextNode(h7);}else{h5=c.get_Empty();}return h5;};h8=h2.get_View();h9=q.Map(h3,h8);return c.EmbedView(h9);},renderMeetup:function(h_,h$,ia){var ib,_if,ig,ik,il,im,_in,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy;ib=function(ic){return c.Element("a",d.ofArray([j.Create("href","#"),j.Create("style","display: block; text-decoration: none;"),i.Handler("click",function(){return function(){return n.Set(F.varMode(),{$:1,$0:ia});};})]),d.ofArray([c.TextNode(ic)]));};ig=function(ih){var ii,ij;ii=ih[0];ij=ih[1];return $$.String(ii)+"."+$$.String(ij);};ik=ia.order.get_View();il=q.Map(ig,ik);_if=d.ofArray([c.TextView(il)]);im=d.ofArray([ib(ia.game.home)]);_in=d.ofArray([c.TextView(ia.summary.get_View())]);io=d.ofArray([ib(ia.game.away)]);ip=d.ofArray([c.TextView(ia.status.get_View())]);iq=d.ofArray([M.renderKef(ia.winBack)]);ir=d.ofArray([M.renderKef(ia.winLay)]);is=d.ofArray([M.renderKef(ia.drawBack)]);it=d.ofArray([M.renderKef(ia.drawLay)]);iu=d.ofArray([M.renderKef(ia.loseBack)]);iv=d.ofArray([M.renderKef(ia.loseLay)]);iw=d.ofArray([M.renderTotalMatched(h_,ia)]);ix=d.ofArray([M.renderCountry(h$,ia.country.get_View())]);iy=[];return c.Concat([c.Element("tr",iy,[c.TextNode("\n    "),c.Element("td",[],[c.TextNode("\n        "),c.Concat(_if),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("td",[j.Create("style","color : RoyalBlue;")],[c.TextNode("\n        "),c.Concat(im),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("td",[j.Create("style","color : #009900;")],[c.TextNode("\n        "),c.Concat(_in),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("td",[j.Create("style","color : SteelBlue;")],[c.TextNode("\n        "),c.Concat(io),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("style","color : #009900;")],[c.TextNode("\n        "),c.Concat(ip),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef win back")],[c.TextNode("\n        "),c.Concat(iq),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef win lay")],[c.TextNode("\n        "),c.Concat(ir),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef draw back")],[c.TextNode("\n        "),c.Concat(is),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef draw lay")],[c.TextNode("\n        "),c.Concat(it),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef lose back")],[c.TextNode("\n        "),c.Concat(iu),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef lose lay")],[c.TextNode("\n        "),c.Concat(iv),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Concat(iw),c.TextNode("\n\n    "),c.Concat(ix),c.TextNode("\n\n    ")])]);},renderTotalMatched:function(iz,iA){var iB,iC;iB=q.get_Do();iC=N.Bind(function(iD){var iE,iF;if(!iD){iE=N.Const(c.get_Empty());}else{iF=iA.totalMatched.get_View();iE=N.Bind(function(iG){var iH,iJ,iM,iN,iO,iP,iQ,iR,iS;iH=function(iI){return iI[1];};iJ=function(iK){return function(iL){return iK+iL;};};iM=d.map(iH,iG);iN=p.fold(iJ,0,iM);if(iN===0){iQ=$.New(h,{$:0});iP=c.Element("td",[],iQ);}else{iS=$$.String(iN);iR=d.ofArray([c.TextNode(iS)]);iP=c.Element("td",[],iR);}iO=iP;return N.Const(M.doc(iO));},iF);}return iE;},iz);return c.EmbedView(iC);}},State:{PageLen:{get:function(){return I.validateValue(n.Get(I["var"]()));},localStorageKey:$.Field(function(){return"pageLen";}),set:function(iT){var iU,iV;iU=I.validateValue(iT);if(iU!==n.Get(I["var"]())){n.Set(I["var"](),iU);iV=W.set(I.localStorageKey(),iU);}else{iV=null;}return iV;},validateValue:function(iW){return iW<10?30:iW>40?40:iW;},"var":$.Field(function(){var iX,iY;iX=W.getWithDef(I.localStorageKey(),30);iY=I.validateValue(iX);return l.Create(iY);}),view:$.Field(function(){return I["var"]().get_View();})},ServerBetfairsSession:{check:$.Field(function(){return m.Delay(function(){return m.Bind(v.Async("WebFace:3",[]),function(i0){X.hasServerBetfairsSession=function(){return i0;};return m.Return(null);});});}),has:function(){return X.hasServerBetfairsSession();},hasNot:function(){return!X.hasServerBetfairsSession();},hasServerBetfairsSession:$.Field(function(){return true;})},events:$.Field(function(){var i1,i2,i3,i4,i6,i7,i8,i9,jb,jd,je;i1=W.checkTodayKey("CentBetEventsCatalogueCreated","CentBetEventsCatalogue");try{i4=function(i5){return Y.id(i5);};i7=(B.get_Default().EncodeRecord(Y,[["gameId",B.get_Default().EncodeTuple([C,C]),0],["country",C,1],["markets",B.get_Default().EncodeList(B.get_Default().EncodeRecord(Q,[["marketId",C,0],["marketName",C,0],["runners",B.get_Default().EncodeList(B.get_Default().EncodeRecord(undefined,[["selectionId",C,0],["runnerName",C,0]])),0]])),0]]))();i6=z.LocalStorage("CentBetEventsCatalogue",{Encode:i7,Decode:(B.get_Default().DecodeRecord(Y,[["gameId",B.get_Default().DecodeTuple([C,C]),0],["country",C,1],["markets",B.get_Default().DecodeList(B.get_Default().DecodeRecord(Q,[["marketId",C,0],["marketName",C,0],["runners",B.get_Default().DecodeList(B.get_Default().DecodeRecord(undefined,[["selectionId",C,0],["runnerName",C,0]])),0]])),0]]))()});i3=D.CreateWithStorage(i4,i6);}catch(i8){i9=function(i_){return function(i$){var ja;ja="error when restoring "+x.prettyPrint(i_)+" - "+x.prettyPrint(i$);return y?y.log(ja):undefined;};};(i9("CentBetEventsCatalogue"))(i8);jb=function(jc){return Y.id(jc);};jd=$.New(h,{$:0});i3=D.Create(jb,jd);}i2=i3;je=function(jf){return function(jg){return function(jh){var ji;ji=x.prettyPrint(jf)+" - "+$$.String(jg)+", "+x.prettyPrint(jh);return y?y.log(ji):undefined;};};};((je("CentBetEventsCatalogue"))(i2.get_Length()))(i1);return i2;}),isCouponMode:function(){return w.Equals(n.Get(F.varMode()),{$:0});},meetups:$.Field(function(){var jj,jl;jj=function(jk){return Z.id(jk);};jl=$.New(h,{$:0});return D.Create(jj,jl);}),mtpevt:$.Field(function(){return function(jm){var jn,jo,jp;jn=Z.id(jm);jo=jn[0];jp=jn[1];return F.tryGetEventById(jo,jp);};}),notCouponMode:function(){var jq;jq=F.isCouponMode();return!jq;},tryGetCountry:$.Field(function(){var jr;jr=function(js){return js.country;};return function(jt){var ju,jv,jw;ju=jt[0];jv=jt[1];jw=F.tryGetEventById(ju,jv);return o.bind(jr,jw);};}),tryGetEventById:function(jx,jy){var jz,jA,jD;jz=[jx,jy];jA=function(jB){var jC;jC=jB.gameId;return w.Equals(jz,jC);};jD=n.Get(F.events().Var);return p.tryFind(jA,jD);},tryGetMarkets:$.Field(function(){var jE;jE=function(jF){return jF.markets;};return function(jG){var jH,jI,jJ;jH=jG[0];jI=jG[1];jJ=F.tryGetEventById(jH,jI);return o.map(jE,jJ);};}),varColumnCountryVisible:$.Field(function(){return l.Create(false);}),varColumnGpbVisible:$.Field(function(){return l.Create(false);}),varCurrentPageNumber:$.Field(function(){return l.Create(0);}),varGameDetailError:$.Field(function(){return l.Create(false);}),varMode:$.Field(function(){return l.Create({$:0});}),varPagesCount:$.Field(function(){return l.Create(1);}),varTargetPageNumber:$.Field(function(){return l.Create(0);})},Utils:{Left:function(jK){return{$:0,$0:jK};},LocalStorage:{checkTodayKey:function(jL,jM){var jN,jO,jP,jQ;jN=_0.now();jO=W.getWithDef(jL,jN);if(jN-jO>1*86400000){W.clear(jM);W.set(jL,_0.now());jQ=function(jR){return function(jS){var jT;jT="local storage "+x.prettyPrint(jR)+" of "+x.prettyPrint(jS)+" is inspired";return y?y.log(jT):undefined;};};(jQ(jM))(jO);jP=jN;}else{jP=jO;}return jP;},clear:function(jU){return W.strg().removeItem(jU);},get:function(jV){var jW,jX,jY,jZ,j0;try{jX=W.strg().getItem(jV);jY=_1.parse(jX);jW={$:1,$0:jY};}catch(jZ){j0=function(j1){return function(j2){var j3;j3="error getting from local storage, key "+x.prettyPrint(j1)+" : "+x.prettyPrint(j2);return y?y.log(j3):undefined;};};(j0(jV))(jZ);jW={$:0};}return jW;},getWithDef:function(j4,j5){var j6,j7,j8;j6=W.get(j4);if(j6.$==1){j8=j6.$0;j7=j8;}else{j7=j5;}return j7;},set:function(j9,j_){var j$,ka,kb,kc;try{ka=_1.stringify(j_);j$=W.strg().setItem(j9,ka);}catch(kb){kc=function(kd){return function(ke){return function(kf){return O.FailWith("error setting to local storage, key "+x.prettyPrint(kd)+", value "+x.prettyPrint(ke)+" : "+x.prettyPrint(kf));};};};j$=((kc(j9))(j_))(kb);}return j$;},strg:$.Field(function(){return _2.localStorage;})},Option:{getWith:function(kg,kh){var ki,kj;if(kh.$==0){ki=kg;}else{kj=kh.$0;ki=kj;}return ki;}},Right:function(kk){return{$:1,$0:kk};},createModal:function(kl,km){var kn,kp,kr;kn=function(ko){return ko;};kp=function(kq){return j.Create("class",kq);};(L.initializeModalVar())(km);kr=function(ks){return function(kt){var ku,ky;ku=function(kv){return kv?kn(c.Element("div",d.ofArray([kp("w3-modal"),j.Create("style","display : block;")]),d.ofArray([c.Element("div",p.toList(p.delay(function(){return p.append(ks,p.delay(function(){return[kp("w3-modal-content w3-animate-zoom w3-card-8")];}));})),kt)]))):c.get_Empty();};ky=q.Map(ku,kl);return c.EmbedView(ky);};};return kr;},dateTimeToString:function($s){var $0=this,$this=this;return $$.dateTimeToString($s);},formatDecimal:function(kz){return L.trimEnd(kz.toFixed(6),d.ofArray([48,46]));},formatDecimalOption:function(kA){var kB,kC;if(kA.$==1){kC=kA.$0;kB=L.formatDecimal(kC);}else{kB="";}return kB;},getDatePart:function(kD){var kE;kE=new _0(kD.getTime());kE.setHours(0,0,0,0);return kE;},initializeModalVar:$.Field(function(){var kF,kG;kF=[$.New(h,{$:0})];kG=function(kH){var kI,kJ,kL;if(kH.target.className==="w3-modal"){kJ=function(kK){return kK(null);};kL=kF[0];kI=p.iter(kJ,kL);}else{kI=null;}return kI;};_2.addEventListener("click",kG,false);return function(kM){kF[0]=$.New(h,{$:1,$0:kM,$1:kF[0]});};}),round:function($x){var $0=this,$this=this;return $$.Math.round($x);},titleAndCloseButton:function(kN,kO){var kP,kR;kP=function(kQ){return j.Create("class",kQ);};kR=d.ofArray([kP("w3-row w3-teal")]);return c.Element("header",kR,d.ofArray([c.Element("h4",d.ofArray([kP("w3-col s11 w3-center"),j.Create("style","padding-left : 10px;")]),d.ofArray([c.TextNode(kN)])),c.Element("div",d.ofArray([kP("w3-col s1 w3-center")]),d.ofArray([c.Element("span",d.ofArray([kP("w3-closebtn"),j.Create("style","padding-right : 5px;"),i.Handler("click",function(){return function(){return kO(null);};})]),d.ofArray([c.TextNode("×")]))]))]));},trimEnd:function(kU,kV){var kW,kX,kY,kZ,k0,k1,k2,k3,k4,k5,k6,k7;kW=[kU,kV];if(kW[0]===""){kX="";}else{if(kW[1].$==1){kZ=kW[0];kW[1];k0=kW[1].$0;if(kZ.charCodeAt(kZ.length-1)===k0){kW[1].$0;k2=kW[1];k3=kW[0];k1=L.trimEnd(_3.string(k3,{$:0},{$:1,$0:k3.length-2}),k2);}else{if(kW[1].$==1){k5=kW[0];k6=kW[1].$1;k4=L.trimEnd(k5,k6);}else{k4=O.Raise(_4.New("C:\\Users\\fpawel\\Documents\\Visual Studio 2015\\Projects\\Betfair\\CentBet\\WebFace\\ClientUtils.fs",8,18));}k1=k4;}kY=k1;}else{k7=kW[0];kY=k7;}kX=kY;}return kX;},updateVarValue:function(k8,k9){return!w.Equals(n.Get(k8),k9)?n.Set(k8,k9):null;},"|Left|Right|":function(k_){var k$,la,lb;if(k_.$==1){la=k_.$0;k$={$:1,$0:la};}else{lb=k_.$0;k$={$:0,$0:lb};}return k$;}},Work:{Work:$.Class({},{loop:function(lc){return m.Delay(function(){var le;le=m.Delay(function(){return m.Bind(lc.work,function(){return m.Bind(m.Sleep(lc.sleepInterval),function(){return m.Return(null);});});});return m.Combine(m.TryWith(le,function(li){var lj,ln;lj=function(lk){return function(ll){var lm;lm="task error "+x.prettyPrint(lk)+" : "+x.prettyPrint(ll);return y?y.log(lm):undefined;};};ln=lc.what;(lj(ln))(li);return m.Bind(m.Sleep(lc.sleepErrorInterval),function(){return m.Return(null);});}),m.Delay(function(){return _5.loop(lc);}));});},"new":function(lq,lr,ls,lt){var lu;lu=$.New(_5,{what:lq,sleepInterval:lr,sleepErrorInterval:ls,work:lt});return _5.run(lu);},run:function(lv){var lw;lw=m.Delay(function(){var ly,lB;ly=function(lz){var lA;lA="task "+x.prettyPrint(lz)+" : started";return y?y.log(lA):undefined;};lB=lv.what;ly(lB);return m.Bind(_5.loop(lv),function(){var lD,lG;lD=function(lE){var lF;lF="task "+x.prettyPrint(lE)+" : terminated";return y?y.log(lF):undefined;};lG=lv.what;lD(lG);return m.Return(null);});});return m.Start(lw,{$:0});}}),addNewGames:function(lH){var lI,lJ,lK,lZ,l1,l3,l4,l5;lI=n.Get(F.meetups().Var);lJ=p.toList(lI);F.meetups().Clear();lK=function(lL){var lM,lN,lO,lP,lQ,lR,lS,lV,lW,lX,lY;lM=lL[0];lN=lL[1];lO=lL[2];lP=lM.gameId;lQ=lP[0];lR=lP[1];lS=function(lT){return d.map(function(lU){return R.New(lU);},lT.markets);};lV=F.tryGetEventById(lQ,lR);lW=o.map(lS,lV);lX=$.New(h,{$:0});lY=V.getWith(lX,lW);return $.New(Z,{game:lM,playMinute:l.Create(lN.playMinute),status:l.Create(lN.status),summary:l.Create(lN.summary),order:l.Create(lN.order),winBack:l.Create(lN.winBack),winLay:l.Create(lN.winLay),drawBack:l.Create(lN.drawBack),drawLay:l.Create(lN.drawLay),loseBack:l.Create(lN.loseBack),loseLay:l.Create(lN.loseLay),marketsBook:lY,totalMatched:l.Create($.New(h,{$:0})),country:l.Create((F.tryGetCountry())(lM.gameId)),hash:lO});};lZ=function(l0){return n.Get(l0.order);};l1=function(l2){return F.meetups().Add(l2);};l3=d.map(lK,lH);l4=p.append(lJ,l3);l5=p.sortBy(lZ,l4);return p.iter(l1,l5);},processCoupon:function(l6){return m.Delay(function(){var l8,l9,l$,ma,mb,mc,md;if(F.notCouponMode()){l8=m.Return(null);}else{l9=function(l_){return[l_.game.gameId,l_.hash];};l$=n.Get(F.meetups().Var);ma=p.map(l9,l$);mb=p.toList(ma);mc=I.get();md=v.Async("WebFace:0",[mb,n.Get(F.varTargetPageNumber()),mc]);l8=m.Bind(md,function(me){var mf,mg,mh,mi,mj,mk,ml;mf=me[1];mg=me[2];mh=me[0];mi=me[3];mj=(mi/mc>>0)+(mi%mc===0?0:1);L.updateVarValue(F.varPagesCount(),mj);if(n.Get(F.varTargetPageNumber())>mj){n.Set(F.varTargetPageNumber(),0);ml=m.Return(null);}else{ml=m.Return(null);}mk=ml;return m.Combine(mk,m.Delay(function(){var mn,mo,mp;mo=mh.$==0;if(!mo){E.addNewGames(mh);mp=m.Return(null);}else{mp=m.Return(null);}mn=mp;return m.Combine(mn,m.Delay(function(){var mr;mr=function(ms){return F.meetups().RemoveByKey(ms);};p.iter(mr,mg);(E.updateCurentCoupon())(mf);E.updateColumnCountryVisible();E.updateColumnGpbVisible();L.updateVarValue(l6,true);L.updateVarValue(F.varCurrentPageNumber(),n.Get(F.varTargetPageNumber()));return m.Return(null);}));}));});}return l8;});},processEvents:$.Field(function(){return m.Delay(function(){var mu,mv,mw,mx,mA,mB,mC,mE,mF,mG;if(F.notCouponMode()){mu=m.Return(null);}else{mv=n.Get(F.meetups().Var);mw=F.mtpevt();mx=function(my){var mz;mz=mw(my);return mz.$==0;};mA=p.filter(mx,mv);if(p.isEmpty(mA)?true:X.hasNot()){mB=m.Return(null);}else{mC=function(mD){return mD.game.gameId;};mE=p.map(mC,mA);mF=p.toList(mE);mG=v.Async("WebFace:4",[mF]);mB=m.Bind(mG,function(mH){return m.Combine(m.For(mH,function(mI){var mJ,mK,mL,mM,mN,mP;mJ=mI[1];mK=mI[0];mL=mI[2];mM=$.New(Y,{gameId:mK,country:mL,markets:$.New(h,{$:0})});F.events().Add(mM);mN=function(mO){return n.Set(mO.country,mM.country);};mP=F.meetups().TryFindByKey(mK);o.iter(mN,mP);return m.Return(null);}),m.Delay(function(){E.updateColumnCountryVisible();E.updateColumnGpbVisible();return m.Return(null);}));});}mu=mB;}return mu;});}),processGameDetail:$.Field(function(){return m.Delay(function(){var mS,mT,mU,mV,mW,mX,mY;mS=n.Get(F.varMode());if(mS.$==1){mU=mS.$0;mV=mU.game.gameId;mW=mV[0];mX=mV[1];mY=v.Async("WebFace:1",[mW,mX]);mT=m.Bind(mY,function(mZ){var m0,m1,m2,m3,m4,m5;m0=F.varGameDetailError();m1=mZ.$==0;n.Set(m0,m1);if(mZ.$==1){m4=mZ.$0[0];m5=mZ.$0[1];E.updateGameInfo(mU,m4,m5);m3=m.Return(null);}else{m3=m.Return(null);}m2=m3;return m.Combine(m2,m.Delay(function(){var m7,m9,m_,m$,nb,nc,nd;m7=function(m8){return n.Get(m8.expanded);};m9=mU.marketsBook;m_=p.filter(m7,m9);m$=function(na){return R.id(na);};nb=p.map(m$,m_);nc=p.toList(nb);nd=v.Async("WebFace:7",[nc]);return m.Bind(nd,function(ne){return m.For(m_,function(nf){var ng,nh;L.updateVarValue(nf.pricesReaded,true);ng=_7.TryFind(nf.marketId,ne);nh=function(ni){var nj,nk,nl,nm,nn,nr;nj=nf.runners;nk=_8.Get(nj);try{while(nk.MoveNext()){nm=nk.get_Current();nn=function(no){var np,nq;np=no[0];nq=no[1];L.updateVarValue(nm.back,np);return L.updateVarValue(nm.lay,nq);};nr=_7.TryFind(nm.selectionId,ni);o.iter(nn,nr);}}finally{nk.Dispose!=undefined?nk.Dispose():null;}return nl;};o.iter(nh,ng);return m.Return(null);});});}));});}else{mT=m.Return(null);}return mT;});}),processMarkets:$.Field(function(){return m.Delay(function(){var nt,nu,nv,nA,nB,nC,nD,nE,nF;if(F.notCouponMode()){nt=m.Return(null);}else{nu=n.Get(F.meetups().Var);nv=function(nw){var nx,nz;nx=function(ny){return ny.markets.$==0?{$:1,$0:nw.game.gameId}:{$:0};};nz=(F.mtpevt())(nw);return o.bind(nx,nz);};nA=p.choose(nv,nu);if(p.isEmpty(nA)?true:X.hasNot()){nB=m.Return(null);}else{nC=p.head(nA);nD=nC[0];nE=nC[1];nF=v.Async("WebFace:5",[nD,nE]);nB=m.Bind(nF,function(nG){var nH;nH=function(nI){var nJ,nR;nJ=function(nK){var nL;nL=d.map(function(nM){var nN,nO,nP,nQ;nN=nM[0];nO=nM[1];nP=nM[2];nQ=nM[3];return Q.New(nN,nO,nP,nQ);},nI);return{$:1,$0:$.New(Y,{gameId:nK.gameId,country:nK.country,markets:nL})};};F.events().UpdateBy(nJ,nC);nR=function(nS){var nT;nT=d.map(function(nU){var nV,nW,nX,nY,nZ;nV=nU[0];nW=nU[1];nX=nU[2];nY=nU[3];nZ=Q.New(nV,nW,nX,nY);return R.New(nZ);},nI);return{$:1,$0:$.New(Z,{game:nS.game,playMinute:nS.playMinute,status:nS.status,summary:nS.summary,order:nS.order,winBack:nS.winBack,winLay:nS.winLay,drawBack:nS.drawBack,drawLay:nS.drawLay,loseBack:nS.loseBack,loseLay:nS.loseLay,marketsBook:nT,totalMatched:nS.totalMatched,country:nS.country,hash:nS.hash})};};return F.meetups().UpdateBy(nR,nC);};o.iter(nH,nG);return m.Return(null);});}nt=nB;}return nt;});}),processTotalMatched:$.Field(function(){return m.Delay(function(){var n1,n2,n3,n$;if(F.notCouponMode()){n1=m.Return(null);}else{n2=n.Get(F.meetups().Var);n3=function(n4){var n5,n7,n9,n_;n5=function(n6){return n6.markets;};n7=function(n8){return n8.$==0?{$:0}:{$:1,$0:n4.game.gameId};};n9=(F.mtpevt())(n4);n_=o.map(n5,n9);return o.bind(n7,n_);};n$=p.choose(n3,n2);n1=(p.isEmpty(n$)?true:X.hasNot())?m.Return(null):m.Combine(m.For(n$,function(oa){var ob,oc,od;if(F.notCouponMode()){ob=m.Return(null);}else{oc=oa[0];od=oa[1];ob=m.Bind(v.Async("WebFace:6",[oc,od]),function(oe){var of,og,oh;if(oe.$==0){of=m.Return(null);}else{og=oa[0];oh=oa[1];E.updateTotalMatched(og,oh,oe);of=m.Return(null);}return of;});}return ob;}),m.Delay(function(){E.updateColumnGpbVisible();return m.Return(null);}));}return n1;});}),start:function(oj){var ok;ok=function(ol,om){var on,oo,op;on=ol[0];oo=ol[1];op=ol[2];return _5["new"](on,oo,op,om);};ok(["COUPON",0,0],E.processCoupon(oj));ok(["CHECK-SERVER-BETFAIRS-SESSION",0,0],X.check());ok(["EVENTS-CATALOGUE",0,0],E.processEvents());ok(["MARKETS-CATALOGUE",0,0],E.processMarkets());ok(["TOTAL-MATCHED",0,0],E.processTotalMatched());return ok(["GAME-DETAIL",0,0],E.processGameDetail());},updateColumnCountryVisible:function(){var oq,or,oA;oq=n.Get(F.meetups().Var);or=function(os){var ot,ov,ow,ox,oy,oz;ot=function(ou){return ou.country;};ov=(F.mtpevt())(os);ow=o.bind(ot,ov);if(ow.$==1){oy=ow.$0;if(oy!==""){ow.$0;oz=true;}else{oz=false;}ox=oz;}else{ox=false;}return ox;};oA=p.exists(or,oq);return L.updateVarValue(F.varColumnCountryVisible(),oA);},updateColumnGpbVisible:function(){var oB,oC,oK;oB=n.Get(F.meetups().Var);oC=function(oD){var oE,oG,oI,oJ;oE=function(oF){return oF[1];};oG=function(oH){return 0<oH;};oI=n.Get(oD.totalMatched);oJ=p.map(oE,oI);return p.exists(oG,oJ);};oK=p.exists(oC,oB);return L.updateVarValue(F.varColumnGpbVisible(),oK);},updateCurentCoupon:$.Field(function(){var oL;oL=function(oM){var oN,oO,oP,oQ,oS;oN=oM[0];oO=oM[1];oP=oM[2];oQ=function(oR){return[oR,oO,oP];};oS=F.meetups().TryFindByKey(oN);return o.map(oQ,oS);};return function(oT){var oU;oU=d.choose(oL,oT);return p.iter(function(oV){var oW,oX,oY;oW=oV[0];oX=oV[1];oY=oV[2];return E.updateGameInfo(oW,oX,oY);},oU);};}),updateGameInfo:function(oZ,o0,o1){oZ.hash=o1;L.updateVarValue(oZ.playMinute,o0.playMinute);L.updateVarValue(oZ.status,o0.status);L.updateVarValue(oZ.summary,o0.summary);L.updateVarValue(oZ.order,o0.order);L.updateVarValue(oZ.winBack,o0.winBack);L.updateVarValue(oZ.winLay,o0.winLay);L.updateVarValue(oZ.drawBack,o0.drawBack);L.updateVarValue(oZ.drawLay,o0.drawLay);L.updateVarValue(oZ.loseBack,o0.loseBack);return L.updateVarValue(oZ.loseLay,o0.loseLay);},updateTotalMatched:function(o2,o3,o4){var o5,o6,o8;o5=[o2,o3];o6=function(o7){return L.updateVarValue(o7.totalMatched,o4);};o8=F.meetups().TryFindByKey(o5);return o.iter(o6,o8);}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.UI);b=$.Safe(a.Next);c=$.Safe(b.Doc);d=$.Safe($$.WebSharper.List);e=$.Safe($$.CentBet);f=$.Safe(e.Client);g=$.Safe(f.Admin);h=$.Safe(d.T);i=$.Safe(b.AttrModule);j=$.Safe(b.AttrProxy);k=$.Safe(b.Key);l=$.Safe(b.Var);m=$.Safe($$.WebSharper.Concurrency);n=$.Safe(b.Var1);o=$.Safe($$.WebSharper.Option);p=$.Safe($$.WebSharper.Seq);q=$.Safe(b.View);r=$.Safe(g.RecordType);s=$.Safe($$.WebSharper.Strings);t=$.Safe($$.Seq);u=$.Safe($$.WebSharper.Remoting);v=$.Safe(u.AjaxRemotingProvider);w=$.Safe($$.WebSharper.Unchecked);x=$.Safe($$.WebSharper.PrintfHelpers);y=$.Safe($$.console);z=$.Safe(b.Storage1);A=$.Safe($$.WebSharper.Json);B=$.Safe(A.Provider);C=$.Safe(B.Id);D=$.Safe(b.ListModel);E=$.Safe(f.Work);F=$.Safe(f.State);G=$.Safe(f.GameDetail);H=$.Safe(f.Coupon);I=$.Safe(F.PageLen);J=$.Safe(H.SettingsDialog);K=$.Safe(J.Helpers);L=$.Safe(f.Utils);M=$.Safe(f.Meetup);N=$.Safe(b.View1);O=$.Safe($$.WebSharper.Operators);P=$.Safe(f.Football);Q=$.Safe(P.Market);R=$.Safe(P.MarketBook);S=$.Safe(P.RunnerBook);T=$.Safe(P.Side);U=$.Safe(G.Helpers);V=$.Safe(L.Option);W=$.Safe(L.LocalStorage);X=$.Safe(F.ServerBetfairsSession);Y=$.Safe(P.Event);Z=$.Safe(P.Meetup);_0=$.Safe($$.Date);_1=$.Safe($$.JSON);_2=$.Safe($$.window);_3=$.Safe($$.WebSharper.Slice);_4=$.Safe($$.WebSharper.MatchFailureException);_5=$.Safe(E.Work);_6=$.Safe($$.WebSharper.Collections);_7=$.Safe(_6.MapModule);return _8=$.Safe($$.WebSharper.Enumerator);});$.OnLoad(function(){E.updateCurentCoupon();E.processTotalMatched();E.processMarkets();E.processGameDetail();E.processEvents();L.initializeModalVar();W.strg();F.varTargetPageNumber();F.varPagesCount();F.varMode();F.varGameDetailError();F.varCurrentPageNumber();F.varColumnGpbVisible();F.varColumnCountryVisible();F.tryGetMarkets();F.tryGetCountry();F.mtpevt();F.meetups();F.events();X.hasServerBetfairsSession();X.check();I.view();I["var"]();I.localStorageKey();G.varError();U.renderSize();U.renderAvailPricesTooltip();H["render\u0421oupon"]();H.renderPagination();H.renderMeetup();J.elt();K.varVisible();K.renderDialog();K.content();g.varConsole();g.varCommandsHistory();g.varCmd();g.renderRecord();g.op_SpliceUntyped();g["cmd-input"]();return;});}());
