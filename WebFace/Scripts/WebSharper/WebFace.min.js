(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6;$.Define($$,{CentBet:{Client:{Admin:{RecordType:$.Class({},{get_color:function(){return function(_7){return _7.$==1?["lightgrey","red"]:_7.$==2?["lightgrey","green"]:["white","navy"];};}}),Render:function(){var _8;_8=$.New(h,{$:0});return c.Concat(d.ofArray([g.RenderCommandPrompt(),(g.op_SpliceUntyped())(c.Element("br",[],_8)),g.RenderRecords()]));},RenderCommandPrompt:function(){var _9;_9=d.ofArray([(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("margin-left","10px")]),$.New(h,{$:0}))),(g.op_SpliceUntyped())(c.Element("label",d.ofArray([j.Create("for",g["cmd-input"]())]),d.ofArray([c.TextNode("Input here:")]))),g.renderInput()]);return c.Concat(_9);},RenderRecords:function(){var _,bd;_=function(ba){var bb,bc;bc=$.New(h,{$:0});bb=d.ofArray([(g.renderRecord())(ba),(g.op_SpliceUntyped())(c.Element("br",[],bc))]);return c.Concat(bb);};bd=g.varConsole().get_View();return c.ConvertSeq(_,bd);},addRecord:function(bd,be){return g.varConsole().Add({Id:k.Fresh(),Text:be,RecordType:bd});},"cmd-input":$.Field(function(){return"cmd-input";}),cmdKey:function(bf){return bf.Id;},doc:function(bg){return bg;},op_SpliceUntyped:$.Field(function(){return function(bh){return g.doc(bh);};}),recordKey:function(bi){return bi.Id;},renderInput:function(){var bj,bk,bl,bm,bp,bs,bw,bx,bN;bj=l.Create("");bk=l.Create(null);bl=l.Create(false);bm=m.Delay(function(){n.Set(bl,true);return m.Bind(g.send(n.Get(bj)),function(){n.Set(bl,false);n.Set(bj,"");return m.Return(null);});});bp=function(bq){var br;br={$:1,$0:bq};g.varCmd=function(){return br;};return n.Set(bj,bq.Text);};bs=function(bt){var bu,bv;bu=g.tryGetCommandFromHistory(bt);bv=o.map(bp,bu);return;};bw=bl.get_View();bx=function(by){var bz;bz=d.ofArray([c.Input(p.toList(p.delay(function(){return p.append([j.Create("id",g["cmd-input"]())],p.delay(function(){return p.append(by?[j.Create("disabled","disabled")]:p.empty(),p.delay(function(){return p.append([i.Style("width","80%")],p.delay(function(){return p.append([i.CustomVar(bk,function(bE){return function(){return bE.focus();};},function(){return{$:0};})],p.delay(function(){return[i.Handler("keydown",function(){return function(bJ){var bK,bL,bM;bK=bJ.keyCode;if(bK===13){bM=n.Get(bj).toLowerCase();bL=bM==="-clear-output"?g.varConsole().Clear():bM==="-clear-hist"?g.varCommandsHistory().Clear():m.Start(bm,{$:0});}else{bL=bK===38?bs(true):bK===40?bs(false):null;}return bL;};})];}));}));}));}));})),bj)]);return c.Concat(bz);};bN=q.Map(bx,bw);return c.EmbedView(bN);},renderRecord:$.Field(function(){var bO;bO=function(bP){var bQ,bR,bS,bT,bU;try{bR=(r.get_color())(bP.RecordType);bS=bR[1];bT=bR[0];bQ=(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("color",bS),i.Style("background",bT)]),d.ofArray([c.TextNode(bP.Text)])));}catch(bU){g.varCommandsHistory().Clear();g.varConsole().Clear();bQ=c.get_Empty();}return bQ;};return function(bV){var bW;bW=q.Map(bO,bV);return c.EmbedView(bW);};}),send:function(bX){return m.Delay(function(){var bZ,b0,b1,b2,b3,b4;bZ=s.Trim(bX);g.addRecord($.New(r,{$:2}),bZ);b1=n.Get(g.varCommandsHistory().Var);if(p.isEmpty(b1)){b2=true;}else{b3=t.last(b1);b2=b3.Text!==bZ;}if(b2){g.varCommandsHistory().Add({Id:k.Fresh(),Text:bZ});b4=m.Return(null);}else{b4=m.Return(null);}b0=b4;return m.Combine(b0,m.Delay(function(){return m.TryWith(m.Delay(function(){var b7;b7=v.Async("WebFace:2",[bZ]);return m.Bind(b7,function(b8){var b9,b_,b$;if(b8.$==1){b_=b8.$0;g.addRecord($.New(r,{$:1}),b_);b9=m.Return(null);}else{b$=b8.$0;g.addRecord($.New(r,{$:0}),b$);b9=m.Return(null);}return b9;});}),function(ca){g.addRecord($.New(r,{$:1}),ca.message);return m.Return(null);});}));});},tryGetCommandFromHistory:function(cb){var cc,cd,ce,cf,cg,ch,ci,cl,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN;cc=n.Get(g.varCommandsHistory().Var);cd=p.length(cc);if(cd===0){ce={$:0};}else{if(g.varCmd().$==1){ch=g.varCmd().$0.Id;ci=function(cj){return function(ck){return[ck,cj];};};cl=function(cm){var cn,co;cn=cm[0];cm[1];co=cn.Id;return w.Equals(co,ch);};cp=n.Get(g.varCommandsHistory().Var);cq=p.mapi(ci,cp);cr=p.tryFind(cl,cq);cs=[cr,cb];if(cs[0].$==1){if(cs[1]){cs[0].$0[0];cv=cs[0].$0[1];if(cd>0?cv<cd-1:false){cx=cs[0].$0[1];cs[0].$0[0];cw=cx+1;}else{if(cs[0].$==1){if(cs[1]){cz=cs[1]?cd-1:0;}else{cs[0].$0[0];cA=cs[0].$0[1];if(cd>0?cA>0:false){cC=cs[0].$0[1];cs[0].$0[0];cB=cC-1;}else{cB=cs[1]?cd-1:0;}cz=cB;}cy=cz;}else{cy=cs[1]?cd-1:0;}cw=cy;}cu=cw;}else{if(cs[0].$==1){if(cs[1]){cE=cs[1]?cd-1:0;}else{cs[0].$0[0];cF=cs[0].$0[1];if(cd>0?cF>0:false){cH=cs[0].$0[1];cs[0].$0[0];cG=cH-1;}else{cG=cs[1]?cd-1:0;}cE=cG;}cD=cE;}else{cD=cs[1]?cd-1:0;}cu=cD;}ct=cu;}else{if(cs[0].$==1){if(cs[1]){cJ=cs[1]?cd-1:0;}else{cs[0].$0[0];cK=cs[0].$0[1];if(cd>0?cK>0:false){cM=cs[0].$0[1];cs[0].$0[0];cL=cM-1;}else{cL=cs[1]?cd-1:0;}cJ=cL;}cI=cJ;}else{cI=cs[1]?cd-1:0;}ct=cI;}cg=ct;}else{cg=cd-1;}cf=cg;cN=p.nth(cf,cc);ce={$:1,$0:cN};}return ce;},varCmd:$.Field(function(){return{$:0};}),varCommandsHistory:$.Field(function(){var cO,cP,cQ,cT,cV,cW,cX,c1,c2,c6,c8;try{cQ=function(cR){var cS;cS="restoring list - "+x.prettyPrint(cR);return y?y.log(cS):undefined;};cQ("CentBetConsoleCommandsHistory");cT=function(cU){return g.cmdKey(cU);};cV=z.LocalStorage("CentBetConsoleCommandsHistory",{Encode:(B.get_Default().EncodeRecord(undefined,[["Id",B.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0]]))(),Decode:(B.get_Default().DecodeRecord(undefined,[["Id",B.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0]]))()});cW=D.CreateWithStorage(cT,cV);cX=function(cY){return function(cZ){var c0;c0=x.prettyPrint(cY)+" - "+$$.String(cZ);return y?y.log(c0):undefined;};};(cX("CentBetConsoleCommandsHistory"))(cW.get_Length());cP=cW;}catch(c1){c2=function(c3){return function(c4){var c5;c5="error when restoring "+x.prettyPrint(c3)+" - "+x.prettyPrint(c4);return y?y.log(c5):undefined;};};(c2("CentBetConsoleCommandsHistory"))(c1);c6=function(c7){return g.cmdKey(c7);};c8=$.New(h,{$:0});cP=D.Create(c6,c8);}cO=cP;return cO;}),varConsole:$.Field(function(){var c9,c_,c$,dc,de,df,dg,dk,dl,dp,dr;try{c$=function(da){var db;db="restoring list - "+x.prettyPrint(da);return y?y.log(db):undefined;};c$("CentBetConsole");dc=function(dd){return g.recordKey(dd);};de=z.LocalStorage("CentBetConsole",{Encode:(B.get_Default().EncodeRecord(undefined,[["Id",B.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0],["RecordType",B.get_Default().EncodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))(),Decode:(B.get_Default().DecodeRecord(undefined,[["Id",B.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0],["RecordType",B.get_Default().DecodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))()});df=D.CreateWithStorage(dc,de);dg=function(dh){return function(di){var dj;dj=x.prettyPrint(dh)+" - "+$$.String(di);return y?y.log(dj):undefined;};};(dg("CentBetConsole"))(df.get_Length());c_=df;}catch(dk){dl=function(dm){return function(dn){var _do;_do="error when restoring "+x.prettyPrint(dm)+" - "+x.prettyPrint(dn);return y?y.log(_do):undefined;};};(dl("CentBetConsole"))(dk);dp=function(dq){return g.recordKey(dq);};dr=$.New(h,{$:0});c_=D.Create(dp,dr);}c9=c_;return c9;})},Coupon:{Render:function(){var ds,dt,du,dv,dH;ds=l.Create(false);E.start(ds);du=F.varMode().get_View();dv=function(dw){var dx,dy,dz,dF,dG;if(dw.$==1){dy=dw.$0;dx=G.renderExploreMarkets(dy);}else{dz=function(dA){var dB,dC,dD,dE;if(dA){dC=H["render\u0421oupon"]();dB=H.doc(dC);}else{dD=d.ofArray([c.TextNode("\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435.")]);dE=c.Element("h1",[],dD);dB=H.doc(dE);}return dB;};dF=ds.get_View();dG=q.Map(dz,dF);dx=c.EmbedView(dG);}return dx;};dH=q.Map(dv,du);dt=d.ofArray([c.EmbedView(dH)]);return c.Concat(dt);},SettingsDialog:{Helpers:{buttonDoc:function(dI){var dJ,dK,dO;dJ=I.view();dK=function(dL){var dM,dN;if((dI?dL===40:false)?true:!dI?dL===10:false){dM=c.get_Empty();}else{dN=K.buttonElt(dI,dL);dM=H.doc(dN);}return dM;};dO=q.Map(dK,dJ);return c.EmbedView(dO);},buttonElt:function(dP,dQ){var dZ;dZ=dP?"+":"-";return c.Element("button",d.ofArray([K.op_SpliceUntyped("w3-btn w3-teal"),j.Create("style","margin: 10px; width: 50px; height: 50px;"),i.Handler("click",function(){return function(){var dT,dU,dV,dW,dX,dY;dT=[dP,dQ];if(dT[0]){if(dT[1]===40){dV=null;}else{dW=dQ+(dP?1:-1);dV=I.set(dW);}dU=dV;}else{if(dT[1]===10){dX=null;}else{dY=dQ+(dP?1:-1);dX=I.set(dY);}dU=dX;}return dU;};})]),d.ofArray([c.TextNode(dZ)]));},close:function(){return n.Set(K.varVisible(),false);},content:$.Field(function(){var d0,d2,d3,d5;d0=L.titleAndCloseButton("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0442\u0447\u0435\u0439 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435",function(){return K.close();});d3=function(d4){return $$.String(d4);};d5=I.view();d2=c.Element("div",d.ofArray([K.op_SpliceUntyped("w3-xxlarge"),j.Create("style","margin : 10px; float : left;")]),d.ofArray([c.TextView(q.Map(d3,d5))]));return d.ofArray([H.doc(d0),H.doc(d2),K.buttonDoc(true),K.buttonDoc(false)]);}),op_SpliceUntyped:function(d6){return j.Create("class",d6);},renderDialog:$.Field(function(){return L.createModal(K.varVisible().get_View(),function(){return K.close();});}),varVisible:$.Field(function(){return l.Create(false);})},elt:$.Field(function(){return((K.renderDialog())($.New(h,{$:0})))(K.content());}),show:function(){return n.Set(K.varVisible(),true);}},doc:function(d8){return d8;},renderMeetup:$.Field(function(){var d9,d_,d$;d9=[F.varColumnGpbVisible().get_View(),F.varColumnCountryVisible().get_View()];d_=d9[0];d$=d9[1];return function(ea){return M.renderMeetup(d_,d$,ea);};}),renderPagination:$.Field(function(){var eb,ec,ed;eb=q.get_Do();ec=F.varPagesCount().get_View();ed=N.Bind(function(ee){var ef;ef=F.varCurrentPageNumber().get_View();return N.Bind(function(eg){var eh,ek,ex;eh=i.Handler("click",function(){return function(){return J.show();};});ek=p.toList(p.delay(function(){return p.append(p.map(function(em){var en,et,eu;en=p.toList(p.delay(function(){return p.append([j.Create("href","#")],p.delay(function(){return p.append([i.Handler("click",function(){return function(){return n.Set(F.varTargetPageNumber(),em);};})],p.delay(function(){return em===eg?[j.Create("class","w3-teal")]:p.empty();}));}));}));eu=$$.String(em+1);et=d.ofArray([c.Element("a",en,d.ofArray([c.TextNode(eu)]))]);return c.Element("li",[],et);},O.range(0,ee-1)),p.delay(function(){var ew;ew=d.ofArray([c.Element("a",d.ofArray([j.Create("href","#"),eh]),d.ofArray([c.TextNode("...")]))]);return[c.Element("li",[],ew)];}));}));ex=d.map(function(ey){return H.doc(ey);},ek);return N.Const(c.Concat(ex));},ef);},ec);return c.EmbedView(ed);}),"render\u0421oupon":$.Field(function(){var ez,eA,eB,eC,eD,eE,eH,eI,eJ,eK,eL,eM,eN;ez=d.ofArray([j.Create("class","w3-responsive")]);eB=d.ofArray([j.Create("class","football-games-list w3-table w3-bordered w3-striped w3-hoverable")]);eC=d.ofArray([c.Element("tr",d.ofArray([i.Class("coupon-header-row w3-teal")]),M.renderGamesHeaderRow(F.varColumnGpbVisible().get_View()))]);eE=function(eF){var eG;eG=p.map(H.renderMeetup(),eF);return c.Concat(eG);};eH=F.meetups().get_View();eI=q.Map(eE,eH);eD=d.ofArray([c.EmbedView(eI)]);eA=d.ofArray([c.Element("table",eB,d.ofArray([c.Element("thead",[],eC),c.Element("tbody",[],eD)]))]);eJ=c.Element("div",ez,eA);eK=d.ofArray([j.Create("class","w3-container")]);eL=q.get_Do();eM=F.varCurrentPageNumber().get_View();eN=N.Bind(function(eO){return N.Bind(function(eP){var eQ,eR,eS,eT;if(eO===eP){eR=eJ;}else{eT="\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u2116 "+$$.String(eP+1)+"...";eS=d.ofArray([c.TextNode(eT)]);eR=c.Element("h1",[],eS);}eQ=eR;return N.Const(H.doc(eQ));},F.varTargetPageNumber().get_View());},eM);return c.Element("div",eK,d.ofArray([c.Element("div",d.ofArray([j.Create("class","w3-center")]),d.ofArray([c.Element("ul",d.ofArray([j.Create("class","w3-pagination w3-border w3-round")]),d.ofArray([H.renderPagination()]))])),c.EmbedView(eN),J.elt()]));})},Football:{Event:$.Class({},{id:function(eU){return eU.gameId;}}),Market:$.Class({},{New:function(eV,eW,eX){var eZ;eZ=function(e0){var e1,e2;e1=e0[0];e2=e0[1];return{selectionId:e2,runnerName:e1};};return $.New(Q,{marketId:eV,marketName:eW,runners:d.map(eZ,eX)});},id:function(e3){return e3.marketId;}}),MarketBook:$.Class({},{New:function(e4){var e5,e7;e5=function(e6){return S.New(e6);};e7=e4.runners;return $.New(R,{marketId:e4.marketId,marketName:e4.marketName,expanded:l.Create(false),runners:d.map(e5,e7)});},id:function(e8){return e8.marketId;}}),Meetup:$.Class({},{id:function(e9){return e9.game.gameId;}}),RunnerBook:$.Class({},{New:function(e_){var e$;e$=function(){return l.Create({$:0});};return $.New(S,{selectionId:e_.selectionId,runnerName:e_.runnerName,backPrice:e$(null),backSize:e$(null),layPrice:e$(null),laySize:e$(null)});}})},GameDetail:{Helpers:{renderGameInfo:function(fb){var fc,ff,fg,fh,fi,fj,ft,fu,fv,fy,fz,fA,fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK;fc=function(fd){var fe;fe=T.getWith("",fd);return c.TextNode(fe);};ff=fb.country.get_View();fg=q.Map(fc,ff);fh=c.EmbedView(fg);fi=fb.totalMatched.get_View();fj=function(fk){var fl,fn,fq,fr,fs;fl=function(fm){return fm[1];};fn=function(fo){return function(fp){return fo+fp;};};fq=d.map(fl,fk);fr=p.fold(fn,0,fq);fs=fr===0?"":$$.String(fr)+" GPB";return c.TextNode(fs);};ft=q.Map(fj,fi);fu=c.EmbedView(ft);fv=d.ofArray([j.Create("href","#"),i.Handler("click",function(){return function(){return n.Set(F.varMode(),{$:0});};})]);fy=d.ofArray([c.TextNode("\u041d\u0430\u0437\u0430\u0434 \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u043c\u0430\u0442\u0447\u0435\u0439")]);fz=c.Element("a",fv,fy);fA=d.ofArray([fz]);fB=fb.game.home;fC=d.ofArray([c.TextView(fb.summary.get_View())]);fD=fb.game.away;fE=d.ofArray([fh]);fF=d.ofArray([c.TextView(fb.status.get_View())]);fG=d.ofArray([fu]);fH=[j.Create("class","w3-indigo")];fI=[];fJ=[];fK=[];return c.Concat([c.Element("div",fH,[c.TextNode("\n    "),c.Element("div",[j.Create("style","text-align: left; padding-left : 5px;")],[c.TextNode("\n        "),c.Concat(fA),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("table",fI,[c.TextNode("\n        "),c.Element("tr",fJ,[c.TextNode("\n            "),c.Element("td",[],[c.TextNode("\n                "),c.Element("h1",[j.Create("style","text-align: right;")],[c.TextNode("\n                    "),c.TextNode(fB),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: center; color : #b4e500;")],[c.TextNode("\n                    "),c.Concat(fC),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[],[c.TextNode("\n                "),c.Element("h1",[j.Create("style","text-align: left;")],[c.TextNode("\n                    "),c.TextNode(fD),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n        ")]),c.TextNode("\n        "),c.Element("tr",fK,[c.TextNode("\n            "),c.Element("td",[],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: left; padding-left:5px;")],[c.TextNode("\n                    "),c.Concat(fE),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: center;")],[c.TextNode("\n                    "),c.Concat(fF),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n            "),c.Element("td",[],[c.TextNode("\n                "),c.Element("h3",[j.Create("style","text-align: right; padding-right:5px;")],[c.TextNode("\n                    "),c.Concat(fG),c.TextNode("\n                ")]),c.TextNode("\n            ")]),c.TextNode("\n        ")]),c.TextNode("\n    ")]),c.TextNode("\n")])]);},renderKef:function(fL,fM,fN){var fO,fP,fQ,fR,fS,fT;fO=q.get_Do();fP=fL.$==1?"lay":"back";fQ="price "+x.toSafe(fP);fR=j.Create("class",fQ);fS=fM.get_View();fT=N.Bind(function(fU){var fV,fZ,f0,f1,f2,f3;fV=function(fW){var fX,fY;fY=L.formatDecimal(fW);fX=d.ofArray([c.TextNode(fY)]);return c.Element("td",d.ofArray([fR]),d.ofArray([c.Element("b",[],fX)]));};fZ=o.map(fV,fU);f0=$.New(h,{$:0});f1=c.Element("td",[],f0);f2=T.getWith(f1,fZ);f3=fN.get_View();return N.Bind(function(f4){var f5,f_,f$,ga,gb;f5=function(f6){var f7,f8,f9;f9=x.toSafe(L.formatDecimal(f6))+" $";f8=d.ofArray([c.TextNode(f9)]);f7=d.ofArray([c.Element("i",[],f8)]);return c.Element("td",[],f7);};f_=o.map(f5,f4);f$=$.New(h,{$:0});ga=c.Element("td",[],f$);gb=T.getWith(ga,f_);return N.Const(c.Concat(d.ofArray([gb,f2])));},f3);},fS);return c.EmbedView(fT);},renderMarket:function(gc){var gd,ge,gr;gd=gc.expanded.get_View();ge=function(gf){var gg,gh,gi,gj,gk,gl,go,gp,gq;gg=U.renderTitle(gf,gc);if(!gf){gi=gg;}else{gj=d.ofArray([G.op_SpliceUntyped("my-table-striped")]);gk=d.ofArray([c.Element("td",d.ofArray([j.Create("colspan","5")]),d.ofArray([gg]))]);gl=function(gm){var gn;gn=U.renderRunner(gm);return G.doc(gn);};go=gc.runners;gp=d.map(gl,go);gi=c.Element("table",gj,d.ofArray([c.Element("tr",[],gk),c.Concat(gp)]));}gh=gi;gq=d.ofArray([gh]);return c.Element("li",[],gq);};gr=q.Map(ge,gd);return c.EmbedView(gr);},renderMarkets:function(gs){var gt,gu,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM;gt=j.Create("style","border-right : 1px solid #ddd;");gu=function(gv){return d.map(function(gw){return U.renderMarket(gw);},gv);};gx=gs.marketsBook;gy=(U.window(3))(gx);if(gy.$==1){if(gy.$1.$==1){if(gy.$1.$1.$==1){if(gy.$1.$1.$1.$==0){gD=gy.$0;gE=gy.$1.$0;gF=gy.$1.$1.$0;gG=d.ofArray([G.op_SpliceUntyped("w3-row")]);gH=c.Element("div",gG,d.ofArray([c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),gu(gD)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),gu(gE)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),gu(gF))]));gC=G.doc(gH);}else{gC=c.get_Empty();}gB=gC;}else{gI=gy.$0;gJ=gy.$1.$0;gK=c.Element("div",d.ofArray([G.op_SpliceUntyped("w3-row")]),d.ofArray([c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s6")]),gu(gI)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s6")]),gu(gJ))]));gB=G.doc(gK);}gA=gB;}else{gL=gy.$0;gM=c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul")]),gu(gL));gA=G.doc(gM);}gz=gA;}else{gz=c.get_Empty();}return gz;},renderRunner:function(gN){var gO,gP;gP=d.ofArray([c.TextNode(gN.runnerName)]);gO=d.ofArray([c.Element("td",[],gP),U.renderKef({$:0},gN.backPrice,gN.backSize),U.renderKef({$:1},gN.layPrice,gN.laySize)]);return c.Element("tr",[],gO);},renderTitle:function(gQ,gR){var gS,gT,gU;gS=gQ?["up","expanded"]:["down",""];gT=gS[1];gU=gS[0];return c.Element("a",d.ofArray([j.Create("href","#"),i.Handler("click",function(){return function(){return n.Set(gR.expanded,!n.Get(gR.expanded));};}),G.op_SpliceUntyped("runners-title "+x.toSafe(gT))]),d.ofArray([c.Element("i",d.ofArray([G.op_SpliceUntyped("fa fa-chevron-"+x.toSafe(gU))]),$.New(h,{$:0})),c.TextNode(gR.marketName)]));},window:function(gX){var gY,g1,g3;gY=function(gZ){return function(g0){return[gZ%gX,g0];};};g1=function(g2){return g2[0];};g3=function(g4){var g5,g6;g4[0];g5=g4[1];g6=p.map(function(g7){return g7[1];},g5);return p.toList(g6);};return function(g8){var g9,g_,g$;g9=p.mapi(gY,g8);g_=t.groupBy(g1,g9);g$=p.map(g3,g_);return p.toList(g$);};}},doc:function(ha){return ha;},op_SpliceUntyped:function(hb){return j.Create("class",hb);},renderExploreMarkets:function(hc){var hd;hd=d.ofArray([U.renderGameInfo(hc),U.renderMarkets(hc)]);return c.Concat(hd);},varError:$.Field(function(){return l.Create(false);})},Meetup:{doc:function(he){return he;},renderCountry:function(hf,hg){var hh,hi;hh=q.get_Do();hi=N.Bind(function(hj){return!hj?N.Const(c.get_Empty()):N.Bind(function(hk){var hl,hm,hn,ho;if(hk.$==1){hn=hk.$0;hm=c.Element("td",d.ofArray([j.Create("style","color : #009900;")]),d.ofArray([c.TextNode(hn)]));}else{ho=$.New(h,{$:0});hm=c.Element("td",[],ho);}hl=hm;return N.Const(M.doc(hl));},hg);},hf);return c.EmbedView(hi);},renderGamesHeaderRow:function(hp){return p.toList(p.delay(function(){var hr,hs,ht,hu,hv,hw;hs=d.ofArray([c.TextNode("\u2116")]);ht=d.ofArray([c.TextNode("\u0414\u043e\u043c\u0430")]);hu=$.New(h,{$:0});hv=d.ofArray([c.TextNode("\u0412 \u0433\u043e\u0441\u0442\u044f\u0445")]);hw=$.New(h,{$:0});hr=d.ofArray([c.Element("th",[],hs),c.Element("th",[],ht),c.Element("th",[],hu),c.Element("th",[],hv),c.Element("th",[],hw),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041f\u043e\u0431\u0435\u0434\u0430")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041d\u0438\u0447\u044c\u044f")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u0435")]))]);return p.append(d.map(function(hx){return M.doc(hx);},hr),p.delay(function(){var hz,hE;hz=function(hA){var hB,hC,hD;if(hA){hC=d.ofArray([c.TextNode("GPB")]);hD=c.Element("th",[],hC);hB=M.doc(hD);}else{hB=c.get_Empty();}return hB;};hE=q.Map(hz,hp);return p.append([c.EmbedView(hE)],p.delay(function(){var hG,hH;hG=$.New(h,{$:0});hH=c.Element("th",[],hG);return[M.doc(hH)];}));}));}));},renderKef:function(hI){var hJ,hO,hP;hJ=function(hK){var hL,hM,hN;if(hK.$==1){hM=hK.$0;hN=L.formatDecimal(hM);hL=c.TextNode(hN);}else{hL=c.get_Empty();}return hL;};hO=hI.get_View();hP=q.Map(hJ,hO);return c.EmbedView(hP);},renderMeetup:function(hQ,hR,hS){var hT,hX,hY,h2,h3,h4,h5,h6,h7,h8,h9,h_,h$,ia,ib,ic,id,ie;hT=function(hU){return c.Element("a",d.ofArray([j.Create("href","#"),j.Create("style","display: block; text-decoration: none;"),i.Handler("click",function(){return function(){return n.Set(F.varMode(),{$:1,$0:hS});};})]),d.ofArray([c.TextNode(hU)]));};hY=function(hZ){var h0,h1;h0=hZ[0];h1=hZ[1];return $$.String(h0)+"."+$$.String(h1);};h2=hS.order.get_View();h3=q.Map(hY,h2);hX=d.ofArray([c.TextView(h3)]);h4=d.ofArray([hT(hS.game.home)]);h5=d.ofArray([c.TextView(hS.summary.get_View())]);h6=d.ofArray([hT(hS.game.away)]);h7=d.ofArray([c.TextView(hS.status.get_View())]);h8=d.ofArray([M.renderKef(hS.winBack)]);h9=d.ofArray([M.renderKef(hS.winLay)]);h_=d.ofArray([M.renderKef(hS.drawBack)]);h$=d.ofArray([M.renderKef(hS.drawLay)]);ia=d.ofArray([M.renderKef(hS.loseBack)]);ib=d.ofArray([M.renderKef(hS.loseLay)]);ic=d.ofArray([M.renderTotalMatched(hQ,hS)]);id=d.ofArray([M.renderCountry(hR,hS.country.get_View())]);ie=[];return c.Concat([c.Element("tr",ie,[c.TextNode("\n    "),c.Element("td",[],[c.TextNode("\n        "),c.Concat(hX),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("td",[j.Create("style","color : RoyalBlue;")],[c.TextNode("\n        "),c.Concat(h4),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("td",[j.Create("style","color : #009900;")],[c.TextNode("\n        "),c.Concat(h5),c.TextNode("\n    ")]),c.TextNode("\n    \n    "),c.Element("td",[j.Create("style","color : SteelBlue;")],[c.TextNode("\n        "),c.Concat(h6),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("style","color : #009900;")],[c.TextNode("\n        "),c.Concat(h7),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef win back")],[c.TextNode("\n        "),c.Concat(h8),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef win lay")],[c.TextNode("\n        "),c.Concat(h9),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef draw back")],[c.TextNode("\n        "),c.Concat(h_),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef draw lay")],[c.TextNode("\n        "),c.Concat(h$),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef lose back")],[c.TextNode("\n        "),c.Concat(ia),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Element("td",[j.Create("class","kef lose lay")],[c.TextNode("\n        "),c.Concat(ib),c.TextNode("\n    ")]),c.TextNode("\n\n    "),c.Concat(ic),c.TextNode("\n\n    "),c.Concat(id),c.TextNode("\n\n    ")])]);},renderTotalMatched:function(_if,ig){var ih,ii;ih=q.get_Do();ii=N.Bind(function(ij){var ik,il;if(!ij){ik=N.Const(c.get_Empty());}else{il=ig.totalMatched.get_View();ik=N.Bind(function(im){var _in,ip,is,it,iu,iv,iw,ix,iy;_in=function(io){return io[1];};ip=function(iq){return function(ir){return iq+ir;};};is=d.map(_in,im);it=p.fold(ip,0,is);if(it===0){iw=$.New(h,{$:0});iv=c.Element("td",[],iw);}else{iy=$$.String(it);ix=d.ofArray([c.TextNode(iy)]);iv=c.Element("td",[],ix);}iu=iv;return N.Const(M.doc(iu));},il);}return ik;},_if);return c.EmbedView(ii);}},State:{PageLen:{get:function(){return I.validateValue(n.Get(I["var"]()));},localStorageKey:$.Field(function(){return"pageLen";}),set:function(iz){var iA,iB;iA=I.validateValue(iz);if(iA!==n.Get(I["var"]())){n.Set(I["var"](),iA);iB=V.set(I.localStorageKey(),iA);}else{iB=null;}return iB;},validateValue:function(iC){return iC<10?30:iC>40?40:iC;},"var":$.Field(function(){var iD,iE;iD=V.getWithDef(I.localStorageKey(),30);iE=I.validateValue(iD);return l.Create(iE);}),view:$.Field(function(){return I["var"]().get_View();})},ServerBetfairsSession:{check:$.Field(function(){return m.Delay(function(){return m.Bind(v.Async("WebFace:3",[]),function(iG){W.hasServerBetfairsSession=function(){return iG;};return m.Return(null);});});}),has:function(){return W.hasServerBetfairsSession();},hasNot:function(){return!W.hasServerBetfairsSession();},hasServerBetfairsSession:$.Field(function(){return true;})},events:$.Field(function(){var iH,iI,iJ,iK,iM,iN,iO,iP,iT,iV,iW;iH=V.checkTodayKey("CentBetEventsCatalogueCreated","CentBetEventsCatalogue");try{iK=function(iL){return X.id(iL);};iN=(B.get_Default().EncodeRecord(X,[["gameId",B.get_Default().EncodeTuple([C,C]),0],["country",C,1],["markets",B.get_Default().EncodeList(B.get_Default().EncodeRecord(Q,[["marketId",C,0],["marketName",C,0],["runners",B.get_Default().EncodeList(B.get_Default().EncodeRecord(undefined,[["selectionId",C,0],["runnerName",C,0]])),0]])),0]]))();iM=z.LocalStorage("CentBetEventsCatalogue",{Encode:iN,Decode:(B.get_Default().DecodeRecord(X,[["gameId",B.get_Default().DecodeTuple([C,C]),0],["country",C,1],["markets",B.get_Default().DecodeList(B.get_Default().DecodeRecord(Q,[["marketId",C,0],["marketName",C,0],["runners",B.get_Default().DecodeList(B.get_Default().DecodeRecord(undefined,[["selectionId",C,0],["runnerName",C,0]])),0]])),0]]))()});iJ=D.CreateWithStorage(iK,iM);}catch(iO){iP=function(iQ){return function(iR){var iS;iS="error when restoring "+x.prettyPrint(iQ)+" - "+x.prettyPrint(iR);return y?y.log(iS):undefined;};};(iP("CentBetEventsCatalogue"))(iO);iT=function(iU){return X.id(iU);};iV=$.New(h,{$:0});iJ=D.Create(iT,iV);}iI=iJ;iW=function(iX){return function(iY){return function(iZ){var i0;i0=x.prettyPrint(iX)+" - "+$$.String(iY)+", "+x.prettyPrint(iZ);return y?y.log(i0):undefined;};};};((iW("CentBetEventsCatalogue"))(iI.get_Length()))(iH);return iI;}),isCouponMode:function(){return w.Equals(n.Get(F.varMode()),{$:0});},meetups:$.Field(function(){var i1,i3;i1=function(i2){return Y.id(i2);};i3=$.New(h,{$:0});return D.Create(i1,i3);}),mtpevt:$.Field(function(){return function(i4){var i5,i6,i7;i5=Y.id(i4);i6=i5[0];i7=i5[1];return F.tryGetEventById(i6,i7);};}),notCouponMode:function(){var i8;i8=F.isCouponMode();return!i8;},tryGetCountry:$.Field(function(){var i9;i9=function(i_){return i_.country;};return function(i$){var ja,jb,jc;ja=i$[0];jb=i$[1];jc=F.tryGetEventById(ja,jb);return o.bind(i9,jc);};}),tryGetEventById:function(jd,je){var jf,jg,jj;jf=[jd,je];jg=function(jh){var ji;ji=jh.gameId;return w.Equals(jf,ji);};jj=n.Get(F.events().Var);return p.tryFind(jg,jj);},tryGetMarkets:$.Field(function(){var jk;jk=function(jl){return jl.markets;};return function(jm){var jn,jo,jp;jn=jm[0];jo=jm[1];jp=F.tryGetEventById(jn,jo);return o.map(jk,jp);};}),varColumnCountryVisible:$.Field(function(){return l.Create(false);}),varColumnGpbVisible:$.Field(function(){return l.Create(false);}),varCurrentPageNumber:$.Field(function(){return l.Create(0);}),varGameDetailError:$.Field(function(){return l.Create(false);}),varMode:$.Field(function(){return l.Create({$:0});}),varPagesCount:$.Field(function(){return l.Create(1);}),varTargetPageNumber:$.Field(function(){return l.Create(0);})},Utils:{Left:function(jq){return{$:0,$0:jq};},LocalStorage:{checkTodayKey:function(jr,js){var jt,ju,jv,jw;jt=Z.now();ju=V.getWithDef(jr,jt);if(jt-ju>1*86400000){V.clear(js);V.set(jr,Z.now());jw=function(jx){return function(jy){var jz;jz="local storage "+x.prettyPrint(jx)+" of "+x.prettyPrint(jy)+" is inspired";return y?y.log(jz):undefined;};};(jw(js))(ju);jv=jt;}else{jv=ju;}return jv;},clear:function(jA){return V.strg().removeItem(jA);},get:function(jB){var jC,jD,jE,jF,jG;try{jD=V.strg().getItem(jB);jE=_0.parse(jD);jC={$:1,$0:jE};}catch(jF){jG=function(jH){return function(jI){var jJ;jJ="error getting from local storage, key "+x.prettyPrint(jH)+" : "+x.prettyPrint(jI);return y?y.log(jJ):undefined;};};(jG(jB))(jF);jC={$:0};}return jC;},getWithDef:function(jK,jL){var jM,jN,jO;jM=V.get(jK);if(jM.$==1){jO=jM.$0;jN=jO;}else{jN=jL;}return jN;},set:function(jP,jQ){var jR,jS,jT,jU;try{jS=_0.stringify(jQ);jR=V.strg().setItem(jP,jS);}catch(jT){jU=function(jV){return function(jW){return function(jX){return O.FailWith("error setting to local storage, key "+x.prettyPrint(jV)+", value "+x.prettyPrint(jW)+" : "+x.prettyPrint(jX));};};};jR=((jU(jP))(jQ))(jT);}return jR;},strg:$.Field(function(){return _1.localStorage;})},Option:{getWith:function(jY,jZ){var j0,j1;if(jZ.$==0){j0=jY;}else{j1=jZ.$0;j0=j1;}return j0;}},Right:function(j2){return{$:1,$0:j2};},createModal:function(j3,j4){var j5,j7,j9;j5=function(j6){return j6;};j7=function(j8){return j.Create("class",j8);};(L.initializeModalVar())(j4);j9=function(j_){return function(j$){var ka,ke;ka=function(kb){return kb?j5(c.Element("div",d.ofArray([j7("w3-modal"),j.Create("style","display : block;")]),d.ofArray([c.Element("div",p.toList(p.delay(function(){return p.append(j_,p.delay(function(){return[j7("w3-modal-content w3-animate-zoom w3-card-8")];}));})),j$)]))):c.get_Empty();};ke=q.Map(ka,j3);return c.EmbedView(ke);};};return j9;},dateTimeToString:function($s){var $0=this,$this=this;return $$.dateTimeToString($s);},formatDecimal:function(kf){return L.trimEnd(kf.toFixed(6),d.ofArray([48,46]));},formatDecimalOption:function(kg){var kh,ki;if(kg.$==1){ki=kg.$0;kh=L.formatDecimal(ki);}else{kh="";}return kh;},getDatePart:function(kj){var kk;kk=new Z(kj.getTime());kk.setHours(0,0,0,0);return kk;},initializeModalVar:$.Field(function(){var kl,km;kl=[$.New(h,{$:0})];km=function(kn){var ko,kp,kr;if(kn.target.className==="w3-modal"){kp=function(kq){return kq(null);};kr=kl[0];ko=p.iter(kp,kr);}else{ko=null;}return ko;};_1.addEventListener("click",km,false);return function(ks){kl[0]=$.New(h,{$:1,$0:ks,$1:kl[0]});};}),titleAndCloseButton:function(kt,ku){var kv,kx;kv=function(kw){return j.Create("class",kw);};kx=d.ofArray([kv("w3-row w3-teal")]);return c.Element("header",kx,d.ofArray([c.Element("h4",d.ofArray([kv("w3-col s11 w3-center"),j.Create("style","padding-left : 10px;")]),d.ofArray([c.TextNode(kt)])),c.Element("div",d.ofArray([kv("w3-col s1 w3-center")]),d.ofArray([c.Element("span",d.ofArray([kv("w3-closebtn"),j.Create("style","padding-right : 5px;"),i.Handler("click",function(){return function(){return ku(null);};})]),d.ofArray([c.TextNode("Ã—")]))]))]));},trimEnd:function(kA,kB){var kC,kD,kE,kF,kG,kH,kI,kJ,kK,kL,kM,kN;kC=[kA,kB];if(kC[0]===""){kD="";}else{if(kC[1].$==1){kF=kC[0];kC[1];kG=kC[1].$0;if(kF.charCodeAt(kF.length-1)===kG){kC[1].$0;kI=kC[1];kJ=kC[0];kH=L.trimEnd(_2.string(kJ,{$:0},{$:1,$0:kJ.length-2}),kI);}else{if(kC[1].$==1){kL=kC[0];kM=kC[1].$1;kK=L.trimEnd(kL,kM);}else{kK=O.Raise(_3.New("E:\\binf\\Documents\\Visual Studio 2015\\Projects\\CentBet\\WebFace\\ClientUtils.fs",8,18));}kH=kK;}kE=kH;}else{kN=kC[0];kE=kN;}kD=kE;}return kD;},updateVarValue:function(kO,kP){return!w.Equals(n.Get(kO),kP)?n.Set(kO,kP):null;},"|Left|Right|":function(kQ){var kR,kS,kT;if(kQ.$==1){kS=kQ.$0;kR={$:1,$0:kS};}else{kT=kQ.$0;kR={$:0,$0:kT};}return kR;}},Work:{Work:$.Class({},{loop:function(kU){return m.Delay(function(){var kW;kW=m.Delay(function(){return m.Bind(kU.work,function(){return m.Bind(m.Sleep(kU.sleepInterval),function(){return m.Return(null);});});});return m.Combine(m.TryWith(kW,function(k0){var k1,k5;k1=function(k2){return function(k3){var k4;k4="task error "+x.prettyPrint(k2)+" : "+x.prettyPrint(k3);return y?y.log(k4):undefined;};};k5=kU.what;(k1(k5))(k0);return m.Bind(m.Sleep(kU.sleepErrorInterval),function(){return m.Return(null);});}),m.Delay(function(){return _4.loop(kU);}));});},"new":function(k8,k9,k_,k$){var la;la=$.New(_4,{what:k8,sleepInterval:k9,sleepErrorInterval:k_,work:k$});return _4.run(la);},run:function(lb){var lc;lc=m.Delay(function(){var le,lh;le=function(lf){var lg;lg="task "+x.prettyPrint(lf)+" : started";return y?y.log(lg):undefined;};lh=lb.what;le(lh);return m.Bind(_4.loop(lb),function(){var lj,lm;lj=function(lk){var ll;ll="task "+x.prettyPrint(lk)+" : terminated";return y?y.log(ll):undefined;};lm=lb.what;lj(lm);return m.Return(null);});});return m.Start(lc,{$:0});}}),addNewGames:function(ln){var lo,lp,lq,lF,lH,lJ,lK,lL;lo=n.Get(F.meetups().Var);lp=p.toList(lo);F.meetups().Clear();lq=function(lr){var ls,lt,lu,lv,lw,lx,ly,lB,lC,lD,lE;ls=lr[0];lt=lr[1];lu=lr[2];lv=ls.gameId;lw=lv[0];lx=lv[1];ly=function(lz){return d.map(function(lA){return R.New(lA);},lz.markets);};lB=F.tryGetEventById(lw,lx);lC=o.map(ly,lB);lD=$.New(h,{$:0});lE=T.getWith(lD,lC);return $.New(Y,{game:ls,playMinute:l.Create(lt.playMinute),status:l.Create(lt.status),summary:l.Create(lt.summary),order:l.Create(lt.order),winBack:l.Create(lt.winBack),winLay:l.Create(lt.winLay),drawBack:l.Create(lt.drawBack),drawLay:l.Create(lt.drawLay),loseBack:l.Create(lt.loseBack),loseLay:l.Create(lt.loseLay),marketsBook:lE,totalMatched:l.Create($.New(h,{$:0})),country:l.Create((F.tryGetCountry())(ls.gameId)),hash:lu});};lF=function(lG){return n.Get(lG.order);};lH=function(lI){return F.meetups().Add(lI);};lJ=d.map(lq,ln);lK=p.append(lp,lJ);lL=p.sortBy(lF,lK);return p.iter(lH,lL);},processCoupon:function(lM){return m.Delay(function(){var lO,lP,lR,lS,lT,lU,lV;if(F.notCouponMode()){lO=m.Return(null);}else{lP=function(lQ){return[lQ.game.gameId,lQ.hash];};lR=n.Get(F.meetups().Var);lS=p.map(lP,lR);lT=p.toList(lS);lU=I.get();lV=v.Async("WebFace:0",[lT,n.Get(F.varTargetPageNumber()),lU]);lO=m.Bind(lV,function(lW){var lX,lY,lZ,l0,l1,l2,l3;lX=lW[1];lY=lW[2];lZ=lW[0];l0=lW[3];l1=(l0/lU>>0)+(l0%lU===0?0:1);L.updateVarValue(F.varPagesCount(),l1);if(n.Get(F.varTargetPageNumber())>l1){n.Set(F.varTargetPageNumber(),0);l3=m.Return(null);}else{l3=m.Return(null);}l2=l3;return m.Combine(l2,m.Delay(function(){var l5,l6,l7;l6=lZ.$==0;if(!l6){E.addNewGames(lZ);l7=m.Return(null);}else{l7=m.Return(null);}l5=l7;return m.Combine(l5,m.Delay(function(){var l9;l9=function(l_){return F.meetups().RemoveByKey(l_);};p.iter(l9,lY);(E.updateCurentCoupon())(lX);E.updateColumnCountryVisible();E.updateColumnGpbVisible();L.updateVarValue(lM,true);L.updateVarValue(F.varCurrentPageNumber(),n.Get(F.varTargetPageNumber()));return m.Return(null);}));}));});}return lO;});},processEvents:$.Field(function(){return m.Delay(function(){var ma,mb,mc,md,mg,mh,mi,mk,ml,mm;if(F.notCouponMode()){ma=m.Return(null);}else{mb=n.Get(F.meetups().Var);mc=F.mtpevt();md=function(me){var mf;mf=mc(me);return mf.$==0;};mg=p.filter(md,mb);if(p.isEmpty(mg)?true:W.hasNot()){mh=m.Return(null);}else{mi=function(mj){return mj.game.gameId;};mk=p.map(mi,mg);ml=p.toList(mk);mm=v.Async("WebFace:4",[ml]);mh=m.Bind(mm,function(mn){return m.Combine(m.For(mn,function(mo){var mp,mq,mr,ms,mt,mv;mp=mo[1];mq=mo[0];mr=mo[2];ms=$.New(X,{gameId:mq,country:mr,markets:$.New(h,{$:0})});F.events().Add(ms);mt=function(mu){return n.Set(mu.country,ms.country);};mv=F.meetups().TryFindByKey(mq);o.iter(mt,mv);return m.Return(null);}),m.Delay(function(){E.updateColumnCountryVisible();E.updateColumnGpbVisible();return m.Return(null);}));});}ma=mh;}return ma;});}),processGameDetail:$.Field(function(){return m.Delay(function(){var my,mz,mA,mB,mC,mD,mE;my=n.Get(F.varMode());if(my.$==1){mA=my.$0;mB=mA.game.gameId;mC=mB[0];mD=mB[1];mE=v.Async("WebFace:1",[mC,mD]);mz=m.Bind(mE,function(mF){var mG,mH,mI,mJ,mK,mL;mG=F.varGameDetailError();mH=mF.$==0;n.Set(mG,mH);if(mF.$==1){mK=mF.$0[0];mL=mF.$0[1];E.updateGameInfo(mA,mK,mL);mJ=m.Return(null);}else{mJ=m.Return(null);}mI=mJ;return m.Combine(mI,m.Delay(function(){var mN,mO,mQ,mR,mS;mN=mA.marketsBook;mO=function(mP){return R.id(mP);};mQ=p.map(mO,mN);mR=p.toList(mQ);mS=v.Async("WebFace:7",[mR]);return m.Bind(mS,function(mT){var mU;mU=function(mV){var mW,mX;mW=mV.runners;mX=function(mY){var mZ,m2,m3,m4;mZ=function(m0,m1){return L.updateVarValue(m0,_6.TryFind(mY.selectionId,m1));};m2=mV.marketId;m3=_6.TryFind(m2,mT);m4=function(m5){var m6,m7,m8,m9;m6=m5[0];m7=m5[1];m8=m5[2];m9=m5[3];mZ(mY.backPrice,m6);mZ(mY.backSize,m7);mZ(mY.layPrice,m8);return mZ(mY.laySize,m9);};return o.iter(m4,m3);};return p.iter(mX,mW);};p.iter(mU,mN);return m.Return(null);});}));});}else{mz=m.Return(null);}return mz;});}),processMarkets:$.Field(function(){return m.Delay(function(){var m$,na,nb,ng,nh,ni,nj,nk,nl;if(F.notCouponMode()){m$=m.Return(null);}else{na=n.Get(F.meetups().Var);nb=function(nc){var nd,nf;nd=function(ne){return ne.markets.$==0?{$:1,$0:nc.game.gameId}:{$:0};};nf=(F.mtpevt())(nc);return o.bind(nd,nf);};ng=p.choose(nb,na);if(p.isEmpty(ng)?true:W.hasNot()){nh=m.Return(null);}else{ni=p.head(ng);nj=ni[0];nk=ni[1];nl=v.Async("WebFace:5",[nj,nk]);nh=m.Bind(nl,function(nm){var nn;nn=function(no){var np,nx;np=function(nq){var nr;nr=d.map(function(ns){var nt,nu,nv,nw;nt=ns[0];nu=ns[1];nv=ns[2];nw=ns[3];return Q.New(nt,nu,nv,nw);},no);return{$:1,$0:$.New(X,{gameId:nq.gameId,country:nq.country,markets:nr})};};F.events().UpdateBy(np,ni);nx=function(ny){var nz;nz=d.map(function(nA){var nB,nC,nD,nE,nF;nB=nA[0];nC=nA[1];nD=nA[2];nE=nA[3];nF=Q.New(nB,nC,nD,nE);return R.New(nF);},no);return{$:1,$0:$.New(Y,{game:ny.game,playMinute:ny.playMinute,status:ny.status,summary:ny.summary,order:ny.order,winBack:ny.winBack,winLay:ny.winLay,drawBack:ny.drawBack,drawLay:ny.drawLay,loseBack:ny.loseBack,loseLay:ny.loseLay,marketsBook:nz,totalMatched:ny.totalMatched,country:ny.country,hash:ny.hash})};};return F.meetups().UpdateBy(nx,ni);};o.iter(nn,nm);return m.Return(null);});}m$=nh;}return m$;});}),processTotalMatched:$.Field(function(){return m.Delay(function(){var nH,nI,nJ,nR;if(F.notCouponMode()){nH=m.Return(null);}else{nI=n.Get(F.meetups().Var);nJ=function(nK){var nL,nN,nP,nQ;nL=function(nM){return nM.markets;};nN=function(nO){return nO.$==0?{$:0}:{$:1,$0:nK.game.gameId};};nP=(F.mtpevt())(nK);nQ=o.map(nL,nP);return o.bind(nN,nQ);};nR=p.choose(nJ,nI);nH=(p.isEmpty(nR)?true:W.hasNot())?m.Return(null):m.Combine(m.For(nR,function(nS){var nT,nU,nV;if(F.notCouponMode()){nT=m.Return(null);}else{nU=nS[0];nV=nS[1];nT=m.Bind(v.Async("WebFace:6",[nU,nV]),function(nW){var nX,nY,nZ;if(nW.$==0){nX=m.Return(null);}else{nY=nS[0];nZ=nS[1];E.updateTotalMatched(nY,nZ,nW);nX=m.Return(null);}return nX;});}return nT;}),m.Delay(function(){E.updateColumnGpbVisible();return m.Return(null);}));}return nH;});}),start:function(n1){var n2;n2=function(n3,n4){var n5,n6,n7;n5=n3[0];n6=n3[1];n7=n3[2];return _4["new"](n5,n6,n7,n4);};n2(["COUPON",0,0],E.processCoupon(n1));n2(["CHECK-SERVER-BETFAIRS-SESSION",0,0],W.check());n2(["EVENTS-CATALOGUE",0,0],E.processEvents());n2(["MARKETS-CATALOGUE",0,0],E.processMarkets());n2(["TOTAL-MATCHED",0,0],E.processTotalMatched());return n2(["GAME-DETAIL",0,0],E.processGameDetail());},updateColumnCountryVisible:function(){var n8,n9,og;n8=n.Get(F.meetups().Var);n9=function(n_){var n$,ob,oc,od,oe,of;n$=function(oa){return oa.country;};ob=(F.mtpevt())(n_);oc=o.bind(n$,ob);if(oc.$==1){oe=oc.$0;if(oe!==""){oc.$0;of=true;}else{of=false;}od=of;}else{od=false;}return od;};og=p.exists(n9,n8);return L.updateVarValue(F.varColumnCountryVisible(),og);},updateColumnGpbVisible:function(){var oh,oi,oq;oh=n.Get(F.meetups().Var);oi=function(oj){var ok,om,oo,op;ok=function(ol){return ol[1];};om=function(on){return 0<on;};oo=n.Get(oj.totalMatched);op=p.map(ok,oo);return p.exists(om,op);};oq=p.exists(oi,oh);return L.updateVarValue(F.varColumnGpbVisible(),oq);},updateCurentCoupon:$.Field(function(){var or;or=function(os){var ot,ou,ov,ow,oy;ot=os[0];ou=os[1];ov=os[2];ow=function(ox){return[ox,ou,ov];};oy=F.meetups().TryFindByKey(ot);return o.map(ow,oy);};return function(oz){var oA;oA=d.choose(or,oz);return p.iter(function(oB){var oC,oD,oE;oC=oB[0];oD=oB[1];oE=oB[2];return E.updateGameInfo(oC,oD,oE);},oA);};}),updateGameInfo:function(oF,oG,oH){oF.hash=oH;L.updateVarValue(oF.playMinute,oG.playMinute);L.updateVarValue(oF.status,oG.status);L.updateVarValue(oF.summary,oG.summary);L.updateVarValue(oF.order,oG.order);L.updateVarValue(oF.winBack,oG.winBack);L.updateVarValue(oF.winLay,oG.winLay);L.updateVarValue(oF.drawBack,oG.drawBack);L.updateVarValue(oF.drawLay,oG.drawLay);L.updateVarValue(oF.loseBack,oG.loseBack);return L.updateVarValue(oF.loseLay,oG.loseLay);},updateTotalMatched:function(oI,oJ,oK){var oL,oM,oO;oL=[oI,oJ];oM=function(oN){return L.updateVarValue(oN.totalMatched,oK);};oO=F.meetups().TryFindByKey(oL);return o.iter(oM,oO);}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.UI);b=$.Safe(a.Next);c=$.Safe(b.Doc);d=$.Safe($$.WebSharper.List);e=$.Safe($$.CentBet);f=$.Safe(e.Client);g=$.Safe(f.Admin);h=$.Safe(d.T);i=$.Safe(b.AttrModule);j=$.Safe(b.AttrProxy);k=$.Safe(b.Key);l=$.Safe(b.Var);m=$.Safe($$.WebSharper.Concurrency);n=$.Safe(b.Var1);o=$.Safe($$.WebSharper.Option);p=$.Safe($$.WebSharper.Seq);q=$.Safe(b.View);r=$.Safe(g.RecordType);s=$.Safe($$.WebSharper.Strings);t=$.Safe($$.Seq);u=$.Safe($$.WebSharper.Remoting);v=$.Safe(u.AjaxRemotingProvider);w=$.Safe($$.WebSharper.Unchecked);x=$.Safe($$.WebSharper.PrintfHelpers);y=$.Safe($$.console);z=$.Safe(b.Storage1);A=$.Safe($$.WebSharper.Json);B=$.Safe(A.Provider);C=$.Safe(B.Id);D=$.Safe(b.ListModel);E=$.Safe(f.Work);F=$.Safe(f.State);G=$.Safe(f.GameDetail);H=$.Safe(f.Coupon);I=$.Safe(F.PageLen);J=$.Safe(H.SettingsDialog);K=$.Safe(J.Helpers);L=$.Safe(f.Utils);M=$.Safe(f.Meetup);N=$.Safe(b.View1);O=$.Safe($$.WebSharper.Operators);P=$.Safe(f.Football);Q=$.Safe(P.Market);R=$.Safe(P.MarketBook);S=$.Safe(P.RunnerBook);T=$.Safe(L.Option);U=$.Safe(G.Helpers);V=$.Safe(L.LocalStorage);W=$.Safe(F.ServerBetfairsSession);X=$.Safe(P.Event);Y=$.Safe(P.Meetup);Z=$.Safe($$.Date);_0=$.Safe($$.JSON);_1=$.Safe($$.window);_2=$.Safe($$.WebSharper.Slice);_3=$.Safe($$.WebSharper.MatchFailureException);_4=$.Safe(E.Work);_5=$.Safe($$.WebSharper.Collections);return _6=$.Safe(_5.MapModule);});$.OnLoad(function(){E.updateCurentCoupon();E.processTotalMatched();E.processMarkets();E.processGameDetail();E.processEvents();L.initializeModalVar();V.strg();F.varTargetPageNumber();F.varPagesCount();F.varMode();F.varGameDetailError();F.varCurrentPageNumber();F.varColumnGpbVisible();F.varColumnCountryVisible();F.tryGetMarkets();F.tryGetCountry();F.mtpevt();F.meetups();F.events();W.hasServerBetfairsSession();W.check();I.view();I["var"]();I.localStorageKey();G.varError();H["render\u0421oupon"]();H.renderPagination();H.renderMeetup();J.elt();K.varVisible();K.renderDialog();K.content();g.varConsole();g.varCommandsHistory();g.varCmd();g.renderRecord();g.op_SpliceUntyped();g["cmd-input"]();return;});}());
