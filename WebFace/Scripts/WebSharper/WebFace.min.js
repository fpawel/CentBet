(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;$.Define($$,{CentBet:{Client:{Admin:{RecordType:$.Class({},{get_color:function(){return function(Y){return Y.$==1?["lightgrey","red"]:Y.$==2?["lightgrey","green"]:["white","navy"];};}}),Render:function(){var Z;Z=$.New(h,{$:0});return c.Concat(d.ofArray([g.RenderCommandPrompt(),(g.op_SpliceUntyped())(c.Element("br",[],Z)),g.RenderRecords()]));},RenderCommandPrompt:function(){var _0;_0=d.ofArray([(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("margin-left","10px")]),$.New(h,{$:0}))),(g.op_SpliceUntyped())(c.Element("label",d.ofArray([j.Create("for",g["cmd-input"]())]),d.ofArray([c.TextNode("Input here:")]))),g.renderInput()]);return c.Concat(_0);},RenderRecords:function(){var _1,_5;_1=function(_2){var _3,_4;_4=$.New(h,{$:0});_3=d.ofArray([(g.renderRecord())(_2),(g.op_SpliceUntyped())(c.Element("br",[],_4))]);return c.Concat(_3);};_5=g.varConsole().get_View();return c.ConvertSeq(_1,_5);},addRecord:function(_6,_7){return g.varConsole().Add({Id:k.Fresh(),Text:_7,RecordType:_6});},"cmd-input":$.Field(function(){return"cmd-input";}),cmdKey:function(_8){return _8.Id;},doc:function(_9){return _9;},op_SpliceUntyped:$.Field(function(){return function(_){return g.doc(_);};}),recordKey:function(ba){return ba.Id;},renderInput:function(){var ba,bb,bc,bd,bg,bj,bn,bo,bE;ba=l.Create("");bb=l.Create(null);bc=l.Create(false);bd=m.Delay(function(){n.Set(bc,true);return m.Bind(g.send(n.Get(ba)),function(){n.Set(bc,false);n.Set(ba,"");return m.Return(null);});});bg=function(bh){var bi;bi={$:1,$0:bh};g.varCmd=function(){return bi;};return n.Set(ba,bh.Text);};bj=function(bk){var bl,bm;bl=g.tryGetCommandFromHistory(bk);bm=o.map(bg,bl);return;};bn=bc.get_View();bo=function(bp){var bq;bq=d.ofArray([c.Input(p.toList(p.delay(function(){return p.append([j.Create("id",g["cmd-input"]())],p.delay(function(){return p.append(bp?[j.Create("disabled","disabled")]:p.empty(),p.delay(function(){return p.append([i.Style("width","80%")],p.delay(function(){return p.append([i.CustomVar(bb,function(bv){return function(){return bv.focus();};},function(){return{$:0};})],p.delay(function(){return[i.Handler("keydown",function(){return function(bA){var bB,bC,bD;bB=bA.keyCode;if(bB===13){bD=n.Get(ba).toLowerCase();bC=bD==="-clear-output"?g.varConsole().Clear():bD==="-clear-hist"?g.varCommandsHistory().Clear():m.Start(bd,{$:0});}else{bC=bB===38?bj(true):bB===40?bj(false):null;}return bC;};})];}));}));}));}));})),ba)]);return c.Concat(bq);};bE=q.Map(bo,bn);return c.EmbedView(bE);},renderRecord:$.Field(function(){var bF;bF=function(bG){var bH,bI,bJ;bH=(r.get_color())(bG.RecordType);bI=bH[1];bJ=bH[0];return(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("color",bI),i.Style("background",bJ)]),d.ofArray([c.TextNode(bG.Text)])));};return function(bK){var bL;bL=q.Map(bF,bK);return c.EmbedView(bL);};}),send:function(bM){return m.Delay(function(){var bO,bP,bQ,bR,bS,bT;bO=s.Trim(bM);g.addRecord($.New(r,{$:2}),bO);bQ=n.Get(g.varCommandsHistory().Var);if(p.isEmpty(bQ)){bR=true;}else{bS=t.last(bQ);bR=bS.Text!==bO;}if(bR){g.varCommandsHistory().Add({Id:k.Fresh(),Text:bO});bT=m.Return(null);}else{bT=m.Return(null);}bP=bT;return m.Combine(bP,m.Delay(function(){return m.TryWith(m.Delay(function(){var bW;bW=v.Async("WebFace:1",[bO]);return m.Bind(bW,function(bX){var bY,bZ,b0;if(bX.$==1){bZ=bX.$0;g.addRecord($.New(r,{$:1}),bZ);bY=m.Return(null);}else{b0=bX.$0;g.addRecord($.New(r,{$:0}),b0);bY=m.Return(null);}return bY;});}),function(b1){g.addRecord($.New(r,{$:1}),b1.message);return m.Return(null);});}));});},tryGetCommandFromHistory:function(b2){var b3,b4,b5,b6,b7,b8,b9,ca,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC;b3=n.Get(g.varCommandsHistory().Var);b4=p.length(b3);if(b4===0){b5={$:0};}else{if(g.varCmd().$==1){b8=g.varCmd().$0.Id;b9=function(b_){return function(b$){return[b$,b_];};};ca=function(cb){var cc,cd;cc=cb[0];cb[1];cd=cc.Id;return w.Equals(cd,b8);};ce=n.Get(g.varCommandsHistory().Var);cf=p.mapi(b9,ce);cg=p.tryFind(ca,cf);ch=[cg,b2];if(ch[0].$==1){if(ch[1]){ch[0].$0[0];ck=ch[0].$0[1];if(b4>0?ck<b4-1:false){cm=ch[0].$0[1];ch[0].$0[0];cl=cm+1;}else{if(ch[0].$==1){if(ch[1]){co=ch[1]?b4-1:0;}else{ch[0].$0[0];cp=ch[0].$0[1];if(b4>0?cp>0:false){cr=ch[0].$0[1];ch[0].$0[0];cq=cr-1;}else{cq=ch[1]?b4-1:0;}co=cq;}cn=co;}else{cn=ch[1]?b4-1:0;}cl=cn;}cj=cl;}else{if(ch[0].$==1){if(ch[1]){ct=ch[1]?b4-1:0;}else{ch[0].$0[0];cu=ch[0].$0[1];if(b4>0?cu>0:false){cw=ch[0].$0[1];ch[0].$0[0];cv=cw-1;}else{cv=ch[1]?b4-1:0;}ct=cv;}cs=ct;}else{cs=ch[1]?b4-1:0;}cj=cs;}ci=cj;}else{if(ch[0].$==1){if(ch[1]){cy=ch[1]?b4-1:0;}else{ch[0].$0[0];cz=ch[0].$0[1];if(b4>0?cz>0:false){cB=ch[0].$0[1];ch[0].$0[0];cA=cB-1;}else{cA=ch[1]?b4-1:0;}cy=cA;}cx=cy;}else{cx=ch[1]?b4-1:0;}ci=cx;}b7=ci;}else{b7=b4-1;}b6=b7;cC=p.nth(b6,b3);b5={$:1,$0:cC};}return b5;},varCmd:$.Field(function(){return{$:0};}),varCommandsHistory:$.Field(function(){var cD,cE,cG,cH,cI,cK;try{cE=function(cF){return g.cmdKey(cF);};cG=x.LocalStorage("CentBetConsoleCommandsHistory",{Encode:(z.get_Default().EncodeRecord(undefined,[["Id",z.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0]]))(),Decode:(z.get_Default().DecodeRecord(undefined,[["Id",z.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0]]))()});cD=B.CreateWithStorage(cE,cG);}catch(cH){cI=function(cJ){return g.cmdKey(cJ);};cK=$.New(h,{$:0});cD=B.Create(cI,cK);}return cD;}),varConsole:$.Field(function(){var cL,cM,cO,cP,cQ,cS;try{cM=function(cN){return g.recordKey(cN);};cO=x.LocalStorage("CentBetConsole",{Encode:(z.get_Default().EncodeRecord(undefined,[["Id",z.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0],["RecordType",z.get_Default().EncodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))(),Decode:(z.get_Default().DecodeRecord(undefined,[["Id",z.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0],["RecordType",z.get_Default().DecodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))()});cL=B.CreateWithStorage(cM,cO);}catch(cP){cQ=function(cR){return g.recordKey(cR);};cS=$.New(h,{$:0});cL=B.Create(cQ,cS);}return cL;})},Coupon:{EventCatalogue:$.Class({},{id:function(cT){return cT.gameId;}}),Meetup:$.Class({},{id:function(cU){return cU.game.gameId;}}),PageLen:{get:function(){return D.validateValue(n.Get(D["var"]()));},localStorageKey:$.Field(function(){return"pageLen";}),set:function(cV){var cW,cX;cW=D.validateValue(cV);if(cW!==n.Get(D["var"]())){n.Set(D["var"](),cW);cX=F.set(D.localStorageKey(),cW);}else{cX=null;}return cX;},validateValue:function(cY){return cY<10?10:cY>40?40:cY;},"var":$.Field(function(){var cZ,c0;cZ=F.getWithDef(D.localStorageKey(),30);c0=D.validateValue(cZ);return l.Create(c0);}),view:$.Field(function(){return D["var"]().get_View();})},Render:function(){var c1,c2,c3,c4,c5,c7,c8,c9,c_,c$,db,dc,dd,de,df,dh,di,dj,dk,dl,dn,dr,ds;c1=["COUPON",0,0];c2=c1[0];c3=c1[1];c4=c1[2];c5=function(){return C.processCoupon();};G["new"](c2,c3,c4,c5);c7=["CHECK-SERVER-BETFAIRS-SESSION",0,0];c8=c7[0];c9=c7[1];c_=c7[2];c$=function(){return H.check();};G["new"](c8,c9,c_,c$);db=["EVENTS-CATALOGUE",0,0];dc=db[0];dd=db[1];de=db[2];df=function(){return C.processEvents();};G["new"](dc,dd,de,df);dh=["MARKETS-CATALOGUE",0,0];di=dh[0];dj=dh[1];dk=dh[2];dl=function(){return C.processMarkets();};G["new"](di,dj,dk,dl);dn=function(_do){var dp,dq;if(_do){dp=C["render\u0421oupon"]();}else{dq=d.ofArray([c.TextNode("\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435.")]);dp=c.Element("h1",[],dq);}return dp;};dr=C.varDataRecived().get_View();ds=q.Map(dn,dr);return c.EmbedView(ds);},ServerBetfairsSession:{check:function(){return m.Delay(function(){return m.Bind(v.Async("WebFace:2",[]),function(du){H.hasServerBetfairsSession=function(){return du;};return m.Return(null);});});},has:function(){return H.hasServerBetfairsSession();},hasNot:function(){return!H.hasServerBetfairsSession();},hasServerBetfairsSession:$.Field(function(){return true;})},SettingsDialog:{buttonDoc:function(dv){var dw,dx,dB;dw=D.view();dx=function(dy){var dz,dA;if((dv?dy===40:false)?true:!dv?dy===10:false){dz=c.get_Empty();}else{dA=I.buttonElt(dv,dy);dz=C.doc(dA);}return dz;};dB=q.Map(dx,dw);return c.EmbedView(dB);},buttonElt:function(dC,dD){var dM;dM=dC?"+":"-";return c.Element("button",d.ofArray([I.op_SpliceUntyped("w3-btn w3-teal"),j.Create("style","margin: 10px; width: 50px; height: 50px;"),i.Handler("click",function(){return function(){var dG,dH,dI,dJ,dK,dL;dG=[dC,dD];if(dG[0]){if(dG[1]===40){dI=null;}else{dJ=dD+(dC?1:-1);dI=D.set(dJ);}dH=dI;}else{if(dG[1]===10){dK=null;}else{dL=dD+(dC?1:-1);dK=D.set(dL);}dH=dK;}return dH;};})]),d.ofArray([c.TextNode(dM)]));},"id'":$.Field(function(){return"id-settings-dialog";}),op_SpliceUntyped:function(dN){return j.Create("class",dN);},render:$.Field(function(){var dO,dP,dQ,dR,dS,dT,dV;dO=d.ofArray([I.op_SpliceUntyped("w3-modal"),j.Create("id",I["id'"]())]);dP=d.ofArray([I.op_SpliceUntyped("w3-modal-content w3-animate-zoom w3-card-8")]);dQ=d.ofArray([I.op_SpliceUntyped("w3-container w3-teal")]);dR="document.getElementById('"+J.toSafe(I["id'"]())+"').style.display='none'";dS=d.ofArray([c.TextNode("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0442\u0447\u0435\u0439 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435")]);dT=function(dU){return $$.String(dU);};dV=D.view();return c.Element("div",dO,d.ofArray([c.Element("div",dP,d.ofArray([c.Element("header",dQ,d.ofArray([c.Element("span",d.ofArray([I.op_SpliceUntyped("w3-closebtn"),j.Create("onclick",dR)]),d.ofArray([c.TextNode("×")])),c.Element("h2",[],dS)])),c.Element("div",d.ofArray([I.op_SpliceUntyped("w3-xxlarge"),j.Create("style","margin : 10px; float : left;")]),d.ofArray([c.TextView(q.Map(dT,dV))])),I.buttonDoc(true),I.buttonDoc(false)]))]));})},Work:$.Class({},{loop:function(dW){return m.Delay(function(){var dY;dY=m.Delay(function(){return m.Bind(dW.work.call(null,null),function(){return m.Bind(m.Sleep(dW.sleepInterval),function(){return m.Return(null);});});});return m.Combine(m.TryWith(dY,function(d2){var d3,d7;d3=function(d4){return function(d5){var d6;d6="task error "+J.prettyPrint(d4)+" : "+J.prettyPrint(d5);return K?K.log(d6):undefined;};};d7=dW.what;(d3(d7))(d2);return m.Bind(m.Sleep(dW.sleepErrorInterval),function(){return m.Return(null);});}),m.Delay(function(){return G.loop(dW);}));});},"new":function(d_,d$,ea,eb){var ec;ec=$.New(G,{what:d_,sleepInterval:d$,sleepErrorInterval:ea,work:eb});return G.run(ec);},run:function(ed){var ee;ee=m.Delay(function(){var eg,ej;eg=function(eh){var ei;ei="task "+J.prettyPrint(eh)+" : started";return K?K.log(ei):undefined;};ej=ed.what;eg(ej);return m.Bind(G.loop(ed),function(){var el,eo;el=function(em){var en;en="task "+J.prettyPrint(em)+" : terminated";return K?K.log(en):undefined;};eo=ed.what;el(eo);return m.Return(null);});});return m.Start(ee,{$:0});}}),addNewGames:function(ep){var eq,er,es,eL,eN,eP,eQ,eR;eq=n.Get(C.meetups().Var);er=p.toList(eq);C.meetups().Clear();es=function(et){var eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK;eu=et[0];ev=et[1];ew=et[2];ex=eu.gameId;ey=ex[0];ez=ex[1];eA=C.tryGetCountry(ey,ez);eB=l.Create(ev.playMinute);eC=l.Create(ev.status);eD=l.Create(ev.summary);eE=l.Create(ev.order);eF=l.Create(ev.winBack);eG=l.Create(ev.winLay);eH=l.Create(ev.drawBack);eI=l.Create(ev.drawLay);eJ=l.Create(ev.loseBack);eK=l.Create(ev.loseLay);return $.New(L,{game:eu,playMinute:eB,status:eC,summary:eD,order:eE,winBack:eF,winLay:eG,drawBack:eH,drawLay:eI,loseBack:eJ,loseLay:eK,country:l.Create(eA),totalMatched:l.Create({$:0}),hash:ew});};eL=function(eM){return n.Get(eM.order);};eN=function(eO){return C.meetups().Add(eO);};eP=d.map(es,ep);eQ=p.append(er,eP);eR=p.sortBy(eL,eQ);return p.iter(eN,eR);},doc:function(eS){return eS;},eventsCatalogue:$.Field(function(){var eT,eU,eV,eW,eY,eZ,e0,e1,e5,e7,e8;eT=F.checkTodayKey("CentBetEventsCatalogueCreated","CentBetEventsCatalogue");try{eW=function(eX){return M.id(eX);};eZ=(z.get_Default().EncodeRecord(M,[["gameId",z.get_Default().EncodeTuple([A,A]),0],["country",A,1],["markets",z.get_Default().EncodeList(z.get_Default().EncodeRecord(undefined,[["marketId",A,0],["marketName",A,0],["runners",z.get_Default().EncodeList(z.get_Default().EncodeRecord(undefined,[["selectionId",A,0],["runnerName",A,0]])),0]])),0]]))();eY=x.LocalStorage("CentBetEventsCatalogue",{Encode:eZ,Decode:(z.get_Default().DecodeRecord(M,[["gameId",z.get_Default().DecodeTuple([A,A]),0],["country",A,1],["markets",z.get_Default().DecodeList(z.get_Default().DecodeRecord(undefined,[["marketId",A,0],["marketName",A,0],["runners",z.get_Default().DecodeList(z.get_Default().DecodeRecord(undefined,[["selectionId",A,0],["runnerName",A,0]])),0]])),0]]))()});eV=B.CreateWithStorage(eW,eY);}catch(e0){e1=function(e2){return function(e3){var e4;e4="error when restoring "+J.prettyPrint(e2)+" - "+J.prettyPrint(e3);return K?K.log(e4):undefined;};};(e1("CentBetEventsCatalogue"))(e0);e5=function(e6){return M.id(e6);};e7=$.New(h,{$:0});eV=B.Create(e5,e7);}eU=eV;e8=function(e9){return function(e_){return function(e$){var fa;fa=J.prettyPrint(e9)+" - "+$$.String(e_)+", "+J.prettyPrint(e$);return K?K.log(fa):undefined;};};};((e8("CentBetEventsCatalogue"))(eU.get_Length()))(eT);return eU;}),meetups:$.Field(function(){var fb,fd;fb=function(fc){return L.id(fc);};fd=$.New(h,{$:0});return B.Create(fb,fd);}),processCoupon:function(){return m.Delay(function(){var ff,fh,fi,fj,fk,fl,fo;ff=function(fg){return[fg.game.gameId,fg.hash];};fh=n.Get(C.meetups().Var);fi=p.map(ff,fh);fj=p.toList(fi);fk=D.get();fl=function(fm){var fn;fn="pagelen "+$$.String(fm);return K?K.log(fn):undefined;};fl(fk);fo=v.Async("WebFace:0",[fj,n.Get(C.varCurrentPageNumber()),fk]);return m.Bind(fo,function(fp){var fq,fr,fs,ft,fu,fv,fw;fq=fp[1];fr=fp[2];fs=fp[0];ft=fp[3];fu=(ft/fk>>0)+1;if(n.Get(C.varPagesCount())!==fu){n.Set(C.varPagesCount(),fu);fw=m.Return(null);}else{fw=m.Return(null);}fv=fw;return m.Combine(fv,m.Delay(function(){var fy,fz;if(n.Get(C.varCurrentPageNumber())>fu){n.Set(C.varCurrentPageNumber(),0);fz=m.Return(null);}else{fz=m.Return(null);}fy=fz;return m.Combine(fy,m.Delay(function(){var fB;if(!n.Get(C.varDataRecived())){n.Set(C.varDataRecived(),true);fB=m.Return(null);}else{fB=m.Return(null);}return m.Combine(fB,m.Delay(function(){C.updateCoupon(fs,fq,fr);return m.Return(null);}));}));}));});});},processEvents:function(){return m.Delay(function(){var fE,fF,fG,fL,fM,fN,fO;fE=n.Get(C.eventsCatalogue().Var);fF=n.Get(C.meetups().Var);fG=function(fH){var fI,fK;fI=function(fJ){return w.Equals(fJ.gameId,fH.game.gameId);};fK=p.tryFind(fI,fE);return fK.$==0?{$:1,$0:fH.game.gameId}:{$:0};};fL=p.choose(fG,fF);fM=p.toList(fL);if(fM.$==0?true:H.hasNot()){fN=m.Return(null);}else{fO=v.Async("WebFace:3",[fM]);fN=m.Bind(fO,function(fP){var fQ;fQ=m.For(fP,function(fR){var fS,fT;fR[1];fS=fR[0];fT=fR[2];C.eventsCatalogue().Add($.New(M,{gameId:fS,country:fT,markets:$.New(h,{$:0})}));return m.Return(null);});return m.Combine(fQ,m.Delay(function(){return m.For(n.Get(C.meetups().Var),function(fV){var fW,fX,fY;fW=fV.game.gameId;fX=fW[0];fY=fW[1];n.Set(fV.country,C.tryGetCountry(fX,fY));return m.Return(null);});}));});}return fN;});},processMarkets:function(){return m.Delay(function(){var f0,f2,f3,f4;f0=function(f1){return f1.markets.$==0;};f2=n.Get(C.eventsCatalogue().Var);f3=p.filter(f0,f2);f4=p.toList(f3);return(f4.$==0?true:H.hasNot())?m.Return(null):m.For(f4,function(f5){var f6,f7,f8,f9;f6=f5.gameId;f7=f6[0];f8=f6[1];f9=v.Async("WebFace:4",[f7,f8]);return m.Bind(f9,function(f_){var f$,ga,gb,ge,gh,gi,gj,gk,gl,gm,gv,gw,gy;if(f_.$==1){ga=f_.$0;gb=function(gc){var gd;gc[0];gc[1];gc[2];gd=gc[3];return gd;};ge=function(gf){return function(gg){return gf+gg;};};gh=f5.gameId;gi=gh[0];gj=gh[1];gk=d.choose(gb,ga);gl=p.fold(ge,0,gk);C.updateTotalMatched(gi,gj,gl);gm=function(gn){var go,gp,gq,gr;go=gn[0];gp=gn[1];gq=gn[2];gn[3];gr=function(gs){var gt,gu;gt=gs[0];gu=gs[1];return{selectionId:gu,runnerName:gt};};return{marketId:go,marketName:gp,runners:d.map(gr,gq)};};gv=d.map(gm,ga);gw=function(gx){return{$:1,$0:$.New(M,{gameId:gx.gameId,country:gx.country,markets:gv})};};gy=f5.gameId;C.eventsCatalogue().UpdateBy(gw,gy);f$=m.Return(null);}else{f$=m.Return(null);}return f$;});});});},renderGamesHeaderRow:$.Field(function(){var gz,gA,gB,gC,gD,gE,gF;gz=d.ofArray([c.TextNode("\u2116")]);gA=d.ofArray([c.TextNode("1")]);gB=$.New(h,{$:0});gC=d.ofArray([c.TextNode("2")]);gD=$.New(h,{$:0});gE=d.ofArray([c.TextNode("GPB")]);gF=$.New(h,{$:0});return d.ofArray([c.Element("th",[],gz),c.Element("th",[],gA),c.Element("th",[],gB),c.Element("th",[],gC),c.Element("th",[],gD),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("1")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("×")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("2")])),c.Element("th",[],gE),c.Element("th",[],gF)]);}),renderMeetup:function(gG){var gH,gP,gQ,gR,gS,gT,gX,gY,gZ,g0,g1,g2,g3,hg,hh,hi,hj,hp,hq;gH=function(gI){return function(gJ){var gK,gL,gN,gO;gL=function(gM){return E.formatDecimalOption(gM);};gN=gJ.get_View();gO=q.Map(gL,gN);gK=c.Element("td",d.ofArray([j.Create("class",gI?"kef kef-back":"kef kef-lay")]),d.ofArray([c.TextView(gO)]));return C.doc(gK);};};gP=gH(true);gQ=gH(false);gT=function(gU){var gV,gW;gV=gU[0];gW=gU[1];return $$.String(gV)+"."+$$.String(gW);};gX=gG.order.get_View();gY=q.Map(gT,gX);gS=d.ofArray([c.TextView(gY)]);gZ=c.Element("td",[],gS);g0=c.Element("td",d.ofArray([j.Create("class","home-team")]),d.ofArray([c.TextNode(gG.game.home)]));g1=q.get_Do();g2=gG.playMinute.get_View();g3=N.Bind(function(g4){var g5;g5=gG.summary.get_View();return N.Bind(function(g6){var g7,g8,g9,g_,g$,ha,hb,hc,hd,he,hf;if(g4.$==1){if(g6!==""){g9=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(g6)]));g8=C.doc(g9);}else{if(g6!==""){g$=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(g6)]));g_=C.doc(g$);}else{ha=$.New(h,{$:0});hb=c.Element("td",[],ha);g_=C.doc(hb);}g8=g_;}g7=g8;}else{if(g6!==""){hd=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(g6)]));hc=C.doc(hd);}else{he=$.New(h,{$:0});hf=c.Element("td",[],he);hc=C.doc(hf);}g7=hc;}return N.Const(g7);},g5);},g2);hg=c.Element("td",d.ofArray([j.Create("class","away-team")]),d.ofArray([c.TextNode(gG.game.away)]));hh=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextView(gG.status.get_View())]));hi=gG.totalMatched.get_View();hj=function(hk){var hl,hm,hn,ho;if(hk.$==1){hm=hk.$0;hn=$$.String(hm);hl=c.Element("td",d.ofArray([j.Create("class","game-gpb")]),d.ofArray([c.TextNode(hn)]));}else{ho=$.New(h,{$:0});hl=c.Element("td",[],ho);}return hl;};hp=q.Map(hj,hi);hq=c.Element("td",d.ofArray([j.Create("class","game-country")]),d.ofArray([c.TextView(gG.country.get_View())]));gR=d.ofArray([C.doc(gZ),C.doc(g0),c.EmbedView(g3),C.doc(hg),C.doc(hh),gP(gG.winBack),gQ(gG.winLay),gP(gG.drawBack),gQ(gG.drawLay),gP(gG.loseBack),gQ(gG.loseLay),c.EmbedView(hp),C.doc(hq)]);return c.Element("tr",[],gR);},renderPagination:$.Field(function(){var hr,hs,ht;hr=q.get_Do();hs=C.varPagesCount().get_View();ht=N.Bind(function(hu){var hv,hw;if(hu<2){hv=N.Const(c.get_Empty());}else{hw=C.varCurrentPageNumber().get_View();hv=N.Bind(function(hx){var hy,hz,hA,hN;hy="document.getElementById('"+J.toSafe(I["id'"]())+"').style.display='block'";hz=j.Create("onclick",hy);hA=p.toList(p.delay(function(){return p.append(p.map(function(hC){var hD,hJ,hK;hD=p.toList(p.delay(function(){return p.append([j.Create("href","#")],p.delay(function(){return p.append([i.Handler("click",function(){return function(){return n.Set(C.varCurrentPageNumber(),hC);};})],p.delay(function(){return hC===hx?[j.Create("class","w3-green")]:p.empty();}));}));}));hK=$$.String(hC+1);hJ=d.ofArray([c.Element("a",hD,d.ofArray([c.TextNode(hK)]))]);return c.Element("li",[],hJ);},O.range(0,hu-1)),p.delay(function(){var hM;hM=d.ofArray([c.Element("a",d.ofArray([j.Create("href","#"),hz]),d.ofArray([c.TextNode("...")]))]);return[c.Element("li",[],hM)];}));}));hN=d.map(function(hO){return C.doc(hO);},hA);return N.Const(c.Concat(hN));},hw);}return hv;},hs);return c.EmbedView(ht);}),"render\u0421oupon":$.Field(function(){var hP,hQ,hR,hS,hU,hV,hY,h1,h2;hP=d.ofArray([j.Create("class","w3-container")]);hQ=d.ofArray([j.Create("class","w3-responsive")]);hR=d.ofArray([j.Create("class","w3-table w3-bordered w3-striped w3-hoverable")]);hS=d.ofArray([c.Element("tr",d.ofArray([i.Class("coupon-header-row w3-pale-green")]),p.map(function(hT){return C.doc(hT);},C.renderGamesHeaderRow()))]);hV=function(hW){var hX;hX=C.renderMeetup(hW);return C.doc(hX);};hY=function(hZ){var h0;h0=p.map(hV,hZ);return c.Concat(h0);};h1=C.meetups().get_View();h2=q.Map(hY,h1);hU=d.ofArray([c.EmbedView(h2)]);return c.Element("div",hP,d.ofArray([c.Element("div",d.ofArray([j.Create("class","w3-center")]),d.ofArray([c.Element("ul",d.ofArray([j.Create("class","w3-pagination w3-border w3-round")]),d.ofArray([C.renderPagination()]))])),c.Element("div",hQ,d.ofArray([c.Element("table",hR,d.ofArray([c.Element("thead",[],hS),c.Element("tbody",[],hU)]))])),I.render()]));}),stvr:function(h3,h4){return!w.Equals(n.Get(h3),h4)?n.Set(h3,h4):null;},tryGetCountry:function(h5,h6){var h7,h8,h9,h_,h$,ia,ib;h7=[h5,h6];h8=h7[0];h9=h7[1];h_=C.tryGetEvent(h8,h9);if(h_.$==1){if(h_.$0.country.$==1){ib=h_.$0.country.$0;ia=ib;}else{ia="";}h$=ia;}else{h$="";}return h$;},tryGetEvent:function(ic,id){var ie,_if,ii;ie=[ic,id];_if=function(ig){var ih;ih=ig.gameId;return w.Equals(ie,ih);};ii=n.Get(C.eventsCatalogue().Var);return p.tryFind(_if,ii);},updateCoupon:function(ij,ik,il){var im,_in,io,ir,is,it,iu,iw,iz,iA;im=ij.$==0;if(!im){io=function(ip){var iq;iq="adding new games "+$$.String(ip);return K?K.log(iq):undefined;};ir=ij.get_Length();io(ir);_in=C.addNewGames(ij);}else{_in=null;}is=p.isEmpty(il);if(!is){iu=function(iv){return C.meetups().RemoveByKey(iv);};p.iter(iu,il);iw=function(ix){var iy;iy="removing out games "+$$.String(ix);return K?K.log(iy):undefined;};iz=p.length(il);it=iw(iz);}else{it=null;}iA=function(iB){var iC,iD,iE,iF,iG,iH,iI,iJ;iC=iB[0];iD=iB[1];iE=iB[2];iF=C.meetups().TryFindByKey(iC);if(iF.$==1){iH=iF.$0;if(iH.hash!==iE){iJ=iF.$0;iJ.hash=iE;C.stvr(iJ.playMinute,iD.playMinute);C.stvr(iJ.status,iD.status);C.stvr(iJ.summary,iD.summary);C.stvr(iJ.order,iD.order);C.stvr(iJ.winBack,iD.winBack);C.stvr(iJ.winLay,iD.winLay);C.stvr(iJ.drawBack,iD.drawBack);C.stvr(iJ.drawLay,iD.drawLay);C.stvr(iJ.loseBack,iD.loseBack);iI=C.stvr(iJ.loseLay,iD.loseLay);}else{iI=null;}iG=iI;}else{iG=null;}return iG;};return p.iter(iA,ik);},updateTotalMatched:function(iK,iL,iM){var iN,iO,iP,iQ;iN=[iK,iL];iO=C.meetups().TryFindByKey(iN);if(iO.$==1){iQ=iO.$0;iP=n.Set(iQ.totalMatched,{$:1,$0:iM});}else{iP=null;}return iP;},varCurrentPageNumber:$.Field(function(){return l.Create(0);}),varDataRecived:$.Field(function(){return l.Create(false);}),varPagesCount:$.Field(function(){return l.Create(1);})},Utils:{Left:function(iR){return{$:0,$0:iR};},LocalStorage:{checkTodayKey:function(iS,iT){var iU,iV,iW,iX;iU=P.now();iV=F.getWithDef(iS,iU);if(iU-iV>1*86400000){F.clear(iT);F.set(iS,P.now());iX=function(iY){return function(iZ){var i0;i0="local storage "+J.prettyPrint(iY)+" of "+J.prettyPrint(iZ)+" is inspired";return K?K.log(i0):undefined;};};(iX(iT))(iV);iW=iU;}else{iW=iV;}return iW;},clear:function(i1){return F.strg().removeItem(i1);},get:function(i2){var i3,i4,i5,i6,i7;try{i4=F.strg().getItem(i2);i5=Q.parse(i4);i3={$:1,$0:i5};}catch(i6){i7=function(i8){return function(i9){var i_;i_="error getting from local storage, key "+J.prettyPrint(i8)+" : "+J.prettyPrint(i9);return K?K.log(i_):undefined;};};(i7(i2))(i6);i3={$:0};}return i3;},getWithDef:function(i$,ja){var jb,jc,jd;jb=F.get(i$);if(jb.$==1){jd=jb.$0;jc=jd;}else{jc=ja;}return jc;},set:function(je,jf){var jg,jh,ji,jj;try{jh=Q.stringify(jf);jg=F.strg().setItem(je,jh);}catch(ji){jj=function(jk){return function(jl){return function(jm){return O.FailWith("error setting to local storage, key "+J.prettyPrint(jk)+", value "+J.prettyPrint(jl)+" : "+J.prettyPrint(jm));};};};jg=((jj(je))(jf))(ji);}return jg;},strg:$.Field(function(){return R.localStorage;})},Right:function(jn){return{$:1,$0:jn};},dateTimeToString:function($s){var $0=this,$this=this;return $$.dateTimeToString($s);},formatDecimal:function(jo){return E.trimEnd(jo.toFixed(6),d.ofArray([48,46]));},formatDecimalOption:function(jp){var jq,jr;if(jp.$==1){jr=jp.$0;jq=E.formatDecimal(jr);}else{jq="";}return jq;},getDatePart:function(js){var jt;jt=new P(js.getTime());jt.setHours(0,0,0,0);return jt;},mkids:function(ju,jv){var jw,jy,jz,jA,jB;jw=function(jx){return[jv(jx),jx];};jy=d.map(jw,ju);jz=T.OfArray(p.toArray(jy));jA=d.map(jv,ju);jB=U.New1(V.OfSeq(jA));return[jB,jz];},trimEnd:function(jC,jD){var jE,jF,jG,jH,jI,jJ,jK,jL,jM,jN,jO,jP;jE=[jC,jD];if(jE[0]===""){jF="";}else{if(jE[1].$==1){jH=jE[0];jE[1];jI=jE[1].$0;if(jH.charCodeAt(jH.length-1)===jI){jE[1].$0;jK=jE[1];jL=jE[0];jJ=E.trimEnd(W.string(jL,{$:0},{$:1,$0:jL.length-2}),jK);}else{if(jE[1].$==1){jN=jE[0];jO=jE[1].$1;jM=E.trimEnd(jN,jO);}else{jM=O.Raise(X.New("C:\\Users\\User\\Documents\\Visual Studio 2015\\Projects\\Betfair\\CentBet\\WebFace\\ClientUtils.fs",8,18));}jJ=jM;}jG=jJ;}else{jP=jE[0];jG=jP;}jF=jG;}return jF;},"|Left|Right|":function(jQ){var jR,jS,jT;if(jQ.$==1){jS=jQ.$0;jR={$:1,$0:jS};}else{jT=jQ.$0;jR={$:0,$0:jT};}return jR;}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.UI);b=$.Safe(a.Next);c=$.Safe(b.Doc);d=$.Safe($$.WebSharper.List);e=$.Safe($$.CentBet);f=$.Safe(e.Client);g=$.Safe(f.Admin);h=$.Safe(d.T);i=$.Safe(b.AttrModule);j=$.Safe(b.AttrProxy);k=$.Safe(b.Key);l=$.Safe(b.Var);m=$.Safe($$.WebSharper.Concurrency);n=$.Safe(b.Var1);o=$.Safe($$.WebSharper.Option);p=$.Safe($$.WebSharper.Seq);q=$.Safe(b.View);r=$.Safe(g.RecordType);s=$.Safe($$.WebSharper.Strings);t=$.Safe($$.Seq);u=$.Safe($$.WebSharper.Remoting);v=$.Safe(u.AjaxRemotingProvider);w=$.Safe($$.WebSharper.Unchecked);x=$.Safe(b.Storage1);y=$.Safe($$.WebSharper.Json);z=$.Safe(y.Provider);A=$.Safe(z.Id);B=$.Safe(b.ListModel);C=$.Safe(f.Coupon);D=$.Safe(C.PageLen);E=$.Safe(f.Utils);F=$.Safe(E.LocalStorage);G=$.Safe(C.Work);H=$.Safe(C.ServerBetfairsSession);I=$.Safe(C.SettingsDialog);J=$.Safe($$.WebSharper.PrintfHelpers);K=$.Safe($$.console);L=$.Safe(C.Meetup);M=$.Safe(C.EventCatalogue);N=$.Safe(b.View1);O=$.Safe($$.WebSharper.Operators);P=$.Safe($$.Date);Q=$.Safe($$.JSON);R=$.Safe($$.window);S=$.Safe($$.WebSharper.Collections);T=$.Safe(S.MapModule);U=$.Safe(S.FSharpSet);V=$.Safe(S.BalancedTree);W=$.Safe($$.WebSharper.Slice);return X=$.Safe($$.WebSharper.MatchFailureException);});$.OnLoad(function(){F.strg();C.varPagesCount();C.varDataRecived();C.varCurrentPageNumber();C["render\u0421oupon"]();C.renderPagination();C.renderGamesHeaderRow();C.meetups();C.eventsCatalogue();I.render();I["id'"]();H.hasServerBetfairsSession();D.view();D["var"]();D.localStorageKey();g.varConsole();g.varCommandsHistory();g.varCmd();g.renderRecord();g.op_SpliceUntyped();g["cmd-input"]();return;});}());
