(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V;$.Define($$,{CentBet:{Client:{Admin:{RecordType:$.Class({},{get_color:function(){return function(W){return W.$==1?["lightgrey","red"]:W.$==2?["lightgrey","green"]:["white","navy"];};}}),Render:function(){var X;X=$.New(h,{$:0});return c.Concat(d.ofArray([g.RenderCommandPrompt(),(g.op_SpliceUntyped())(c.Element("br",[],X)),g.RenderRecords()]));},RenderCommandPrompt:function(){var Y;Y=d.ofArray([(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("margin-left","10px")]),$.New(h,{$:0}))),(g.op_SpliceUntyped())(c.Element("label",d.ofArray([j.Create("for",g["cmd-input"]())]),d.ofArray([c.TextNode("Input here:")]))),g.renderInput()]);return c.Concat(Y);},RenderRecords:function(){var Z,_3;Z=function(_0){var _1,_2;_2=$.New(h,{$:0});_1=d.ofArray([(g.renderRecord())(_0),(g.op_SpliceUntyped())(c.Element("br",[],_2))]);return c.Concat(_1);};_3=g.varConsole().get_View();return c.ConvertSeq(Z,_3);},addRecord:function(_4,_5){return g.varConsole().Add({Id:k.Fresh(),Text:_5,RecordType:_4});},"cmd-input":$.Field(function(){return"cmd-input";}),cmdKey:function(_6){return _6.Id;},doc:function(_7){return _7;},op_SpliceUntyped:$.Field(function(){return function(_8){return g.doc(_8);};}),recordKey:function(_9){return _9.Id;},renderInput:function(){var _,ba,bb,bc,bf,bi,bm,bn,bC;_=l.Create("");ba=l.Create(null);bb=l.Create(false);bc=m.Delay(function(){n.Set(bb,true);return m.Bind(g.send(n.Get(_)),function(){n.Set(bb,false);n.Set(_,"");return m.Return(null);});});bf=function(bg){var bh;bh={$:1,$0:bg};g.varCmd=function(){return bh;};return n.Set(_,bg.Text);};bi=function(bj){var bk,bl;bk=g.tryGetCommandFromHistory(bj);bl=o.map(bf,bk);return;};bm=bb.get_View();bn=function(bo){var bp;bp=d.ofArray([c.Input(p.toList(p.delay(function(){return p.append([j.Create("id",g["cmd-input"]())],p.delay(function(){return p.append(bo?[j.Create("disabled","disabled")]:p.empty(),p.delay(function(){return p.append([i.Style("width","80%")],p.delay(function(){return p.append([i.CustomVar(ba,function(bu){return function(){return bu.focus();};},function(){return{$:0};})],p.delay(function(){return[i.Handler("keydown",function(){return function(by){var bz,bA,bB;bz=by.keyCode;if(bz===13){bB=n.Get(_).toLowerCase();bA=bB==="-clear-output"?g.varConsole().Clear():bB==="-clear-hist"?g.varCommandsHistory().Clear():m.Start(bc,{$:0});}else{bA=bz===38?bi(true):bz===40?bi(false):null;}return bA;};})];}));}));}));}));})),_)]);return c.Concat(bp);};bC=q.Map(bn,bm);return c.EmbedView(bC);},renderRecord:$.Field(function(){var bD;bD=function(bE){var bF,bG,bH;bF=(r.get_color())(bE.RecordType);bG=bF[1];bH=bF[0];return(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("color",bG),i.Style("background",bH)]),d.ofArray([c.TextNode(bE.Text)])));};return function(bI){var bJ;bJ=q.Map(bD,bI);return c.EmbedView(bJ);};}),send:function(bK){return m.Delay(function(){var bM,bN,bO,bP,bQ,bR;bM=s.Trim(bK);g.addRecord($.New(r,{$:2}),bM);bO=n.Get(g.varCommandsHistory().Var);if(p.isEmpty(bO)){bP=true;}else{bQ=t.last(bO);bP=bQ.Text!==bM;}if(bP){g.varCommandsHistory().Add({Id:k.Fresh(),Text:bM});bR=m.Return(null);}else{bR=m.Return(null);}bN=bR;return m.Combine(bN,m.Delay(function(){return m.TryWith(m.Delay(function(){var bU;bU=v.Async("WebFace:1",[bM]);return m.Bind(bU,function(bV){var bW,bX,bY;if(bV.$==1){bX=bV.$0;g.addRecord($.New(r,{$:1}),bX);bW=m.Return(null);}else{bY=bV.$0;g.addRecord($.New(r,{$:0}),bY);bW=m.Return(null);}return bW;});}),function(bZ){g.addRecord($.New(r,{$:1}),bZ.message);return m.Return(null);});}));});},tryGetCommandFromHistory:function(b0){var b1,b2,b3,b4,b5,b6,b7,b_,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA;b1=n.Get(g.varCommandsHistory().Var);b2=p.length(b1);if(b2===0){b3={$:0};}else{if(g.varCmd().$==1){b6=g.varCmd().$0.Id;b7=function(b8){return function(b9){return[b9,b8];};};b_=function(b$){var ca,cb;ca=b$[0];b$[1];cb=ca.Id;return w.Equals(cb,b6);};cc=n.Get(g.varCommandsHistory().Var);cd=p.mapi(b7,cc);ce=p.tryFind(b_,cd);cf=[ce,b0];if(cf[0].$==1){if(cf[1]){cf[0].$0[0];ci=cf[0].$0[1];if(b2>0?ci<b2-1:false){ck=cf[0].$0[1];cf[0].$0[0];cj=ck+1;}else{if(cf[0].$==1){if(cf[1]){cm=cf[1]?b2-1:0;}else{cf[0].$0[0];cn=cf[0].$0[1];if(b2>0?cn>0:false){cp=cf[0].$0[1];cf[0].$0[0];co=cp-1;}else{co=cf[1]?b2-1:0;}cm=co;}cl=cm;}else{cl=cf[1]?b2-1:0;}cj=cl;}ch=cj;}else{if(cf[0].$==1){if(cf[1]){cr=cf[1]?b2-1:0;}else{cf[0].$0[0];cs=cf[0].$0[1];if(b2>0?cs>0:false){cu=cf[0].$0[1];cf[0].$0[0];ct=cu-1;}else{ct=cf[1]?b2-1:0;}cr=ct;}cq=cr;}else{cq=cf[1]?b2-1:0;}ch=cq;}cg=ch;}else{if(cf[0].$==1){if(cf[1]){cw=cf[1]?b2-1:0;}else{cf[0].$0[0];cx=cf[0].$0[1];if(b2>0?cx>0:false){cz=cf[0].$0[1];cf[0].$0[0];cy=cz-1;}else{cy=cf[1]?b2-1:0;}cw=cy;}cv=cw;}else{cv=cf[1]?b2-1:0;}cg=cv;}b5=cg;}else{b5=b2-1;}b4=b5;cA=p.nth(b4,b1);b3={$:1,$0:cA};}return b3;},varCmd:$.Field(function(){return{$:0};}),varCommandsHistory:$.Field(function(){var cB,cC,cE,cF,cG,cI;try{cC=function(cD){return g.cmdKey(cD);};cE=x.LocalStorage("CentBetConsoleCommandsHistory",{Encode:(z.get_Default().EncodeRecord(undefined,[["Id",z.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0]]))(),Decode:(z.get_Default().DecodeRecord(undefined,[["Id",z.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0]]))()});cB=B.CreateWithStorage(cC,cE);}catch(cF){cG=function(cH){return g.cmdKey(cH);};cI=$.New(h,{$:0});cB=B.Create(cG,cI);}return cB;}),varConsole:$.Field(function(){var cJ,cK,cM,cN,cO,cQ;try{cK=function(cL){return g.recordKey(cL);};cM=x.LocalStorage("CentBetConsole",{Encode:(z.get_Default().EncodeRecord(undefined,[["Id",z.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0],["RecordType",z.get_Default().EncodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))(),Decode:(z.get_Default().DecodeRecord(undefined,[["Id",z.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",A,0]]]]),0],["Text",A,0],["RecordType",z.get_Default().DecodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))()});cJ=B.CreateWithStorage(cK,cM);}catch(cN){cO=function(cP){return g.recordKey(cP);};cQ=$.New(h,{$:0});cJ=B.Create(cO,cQ);}return cJ;})},Coupon:{EventCatalogue:$.Class({},{id:function(cR){return cR.gameId;}}),Meetup:$.Class({},{id:function(cS){return cS.game.gameId;}}),Render:function(){var cT,cU,cV,cW,cX,cZ,c0,c1,c2,c3,c5,c6,c7,c8,c9,c$,da,db,dc,dd,df,dj,dk;cT=["COUPON",0,0];cU=cT[0];cV=cT[1];cW=cT[2];cX=function(){return D.check();};E["new"](cU,cV,cW,cX);cZ=["CHECK-SERVER-BETFAIRS-SESSION",0,0];c0=cZ[0];c1=cZ[1];c2=cZ[2];c3=function(){return C.processCoupon();};E["new"](c0,c1,c2,c3);c5=["EVENTS-CATALOGUE",0,0];c6=c5[0];c7=c5[1];c8=c5[2];c9=function(){return C.processEvents();};E["new"](c6,c7,c8,c9);c$=["MARKETS-CATALOGUE",0,0];da=c$[0];db=c$[1];dc=c$[2];dd=function(){return C.processMarkets();};E["new"](da,db,dc,dd);df=function(dg){var dh,di;if(dg){dh=C["render\u0421oupon"]();}else{di=d.ofArray([c.TextNode("\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435.")]);dh=c.Element("h1",[],di);}return dh;};dj=C.varDataRecived().get_View();dk=q.Map(df,dj);return c.EmbedView(dk);},ServerBetfairsSession:{check:function(){return m.Delay(function(){return m.Bind(v.Async("WebFace:2",[]),function(dm){D.hasServerBetfairsSession=function(){return dm;};return m.Return(null);});});},has:function(){return D.hasServerBetfairsSession();},hasNot:function(){return!D.hasServerBetfairsSession();},hasServerBetfairsSession:$.Field(function(){return true;})},Work:$.Class({},{loop:function(dn){return m.Delay(function(){var dp;dp=m.Delay(function(){return m.Bind(dn.work.call(null,null),function(){return m.Bind(m.Sleep(dn.sleepInterval),function(){return m.Return(null);});});});return m.Combine(m.TryWith(dp,function(dt){var du,dy;du=function(dv){return function(dw){var dx;dx="task error "+F.prettyPrint(dv)+" : "+F.prettyPrint(dw);return G?G.log(dx):undefined;};};dy=dn.what;(du(dy))(dt);return m.Bind(m.Sleep(dn.sleepErrorInterval),function(){return m.Return(null);});}),m.Delay(function(){return E.loop(dn);}));});},"new":function(dB,dC,dD,dE){var dF;dF=$.New(E,{what:dB,sleepInterval:dC,sleepErrorInterval:dD,work:dE});return E.run(dF);},run:function(dG){var dH;dH=m.Delay(function(){var dJ,dM;dJ=function(dK){var dL;dL="task "+F.prettyPrint(dK)+" : started";return G?G.log(dL):undefined;};dM=dG.what;dJ(dM);return m.Bind(E.loop(dG),function(){var dO,dR;dO=function(dP){var dQ;dQ="task "+F.prettyPrint(dP)+" : terminated";return G?G.log(dQ):undefined;};dR=dG.what;dO(dR);return m.Return(null);});});return m.Start(dH,{$:0});}}),addNewGames:function(dS){var dT,dU,dV,ec,ee,eg,eh,ei;dT=n.Get(C.meetups().Var);dU=p.toList(dT);C.meetups().Clear();dV=function(dW){var dX,dY,dZ,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d_,d$,ea,eb;dX=dW[0];dY=dW[1];dZ=dW[2];d0=dX.gameId;d1=d0[0];d2=d0[1];d3=C.tryGetCountry(d1,d2);d4=l.Create(dY.playMinute);d5=l.Create(dY.status);d6=l.Create(dY.summary);d7=l.Create(dY.order);d8=l.Create(dY.winBack);d9=l.Create(dY.winLay);d_=l.Create(dY.drawBack);d$=l.Create(dY.drawLay);ea=l.Create(dY.loseBack);eb=l.Create(dY.loseLay);return $.New(H,{game:dX,playMinute:d4,status:d5,summary:d6,order:d7,winBack:d8,winLay:d9,drawBack:d_,drawLay:d$,loseBack:ea,loseLay:eb,country:l.Create(d3),totalMatched:l.Create({$:0}),hash:dZ});};ec=function(ed){return n.Get(ed.order);};ee=function(ef){return C.meetups().Add(ef);};eg=d.map(dV,dS);eh=p.append(dU,eg);ei=p.sortBy(ec,eh);return p.iter(ee,ei);},doc:function(ej){return ej;},eventsCatalogue:$.Field(function(){var ek,el,em,en,ep,eq,er,es,ew,ey,ez;ek=J.checkTodayKey("CentBetEventsCatalogueCreated","CentBetEventsCatalogue");try{en=function(eo){return K.id(eo);};eq=(z.get_Default().EncodeRecord(K,[["gameId",z.get_Default().EncodeTuple([A,A]),0],["country",A,1],["markets",z.get_Default().EncodeList(z.get_Default().EncodeRecord(undefined,[["marketId",A,0],["marketName",A,0],["runners",z.get_Default().EncodeList(z.get_Default().EncodeRecord(undefined,[["selectionId",A,0],["runnerName",A,0]])),0]])),0]]))();ep=x.LocalStorage("CentBetEventsCatalogue",{Encode:eq,Decode:(z.get_Default().DecodeRecord(K,[["gameId",z.get_Default().DecodeTuple([A,A]),0],["country",A,1],["markets",z.get_Default().DecodeList(z.get_Default().DecodeRecord(undefined,[["marketId",A,0],["marketName",A,0],["runners",z.get_Default().DecodeList(z.get_Default().DecodeRecord(undefined,[["selectionId",A,0],["runnerName",A,0]])),0]])),0]]))()});em=B.CreateWithStorage(en,ep);}catch(er){es=function(et){return function(eu){var ev;ev="error when restoring "+F.prettyPrint(et)+" - "+F.prettyPrint(eu);return G?G.log(ev):undefined;};};(es("CentBetEventsCatalogue"))(er);ew=function(ex){return K.id(ex);};ey=$.New(h,{$:0});em=B.Create(ew,ey);}el=em;ez=function(eA){return function(eB){return function(eC){var eD;eD=F.prettyPrint(eA)+" - "+$$.String(eB)+", "+F.prettyPrint(eC);return G?G.log(eD):undefined;};};};((ez("CentBetEventsCatalogue"))(el.get_Length()))(ek);return el;}),meetups:$.Field(function(){var eE,eG;eE=function(eF){return H.id(eF);};eG=$.New(h,{$:0});return B.Create(eE,eG);}),processCoupon:function(){return m.Delay(function(){var eI,eK,eL,eM,eN;eI=function(eJ){return[eJ.game.gameId,eJ.hash];};eK=n.Get(C.meetups().Var);eL=p.map(eI,eK);eM=p.toList(eL);eN=v.Async("WebFace:0",[eM,n.Get(C.varCurrentPageNumber()),30]);return m.Bind(eN,function(eO){var eP,eQ,eR,eS,eT,eU,eV;eP=eO[1];eQ=eO[2];eR=eO[0];eS=eO[3];eT=eS/30>>0;if(n.Get(C.varPagesCount())!==eT){n.Set(C.varPagesCount(),eT);eV=m.Return(null);}else{eV=m.Return(null);}eU=eV;return m.Combine(eU,m.Delay(function(){var eX,eY;if(n.Get(C.varCurrentPageNumber())>eT){n.Set(C.varCurrentPageNumber(),0);eY=m.Return(null);}else{eY=m.Return(null);}eX=eY;return m.Combine(eX,m.Delay(function(){var e0;if(!n.Get(C.varDataRecived())){n.Set(C.varDataRecived(),true);e0=m.Return(null);}else{e0=m.Return(null);}return m.Combine(e0,m.Delay(function(){C.updateCoupon(eR,eP,eQ);return m.Return(null);}));}));}));});});},processEvents:function(){return m.Delay(function(){var e3,e4,e5,e_,e$,fa,fb;e3=n.Get(C.eventsCatalogue().Var);e4=n.Get(C.meetups().Var);e5=function(e6){var e7,e9;e7=function(e8){return w.Equals(e8.gameId,e6.game.gameId);};e9=p.tryFind(e7,e3);return e9.$==0?{$:1,$0:e6.game.gameId}:{$:0};};e_=p.choose(e5,e4);e$=p.toList(e_);if(e$.$==0?true:D.hasNot()){fa=m.Return(null);}else{fb=v.Async("WebFace:3",[e$]);fa=m.Bind(fb,function(fc){var fd;fd=m.For(fc,function(fe){var ff,fg;fe[1];ff=fe[0];fg=fe[2];C.eventsCatalogue().Add($.New(K,{gameId:ff,country:fg,markets:$.New(h,{$:0})}));return m.Return(null);});return m.Combine(fd,m.Delay(function(){return m.For(n.Get(C.meetups().Var),function(fi){var fj,fk,fl;fj=fi.game.gameId;fk=fj[0];fl=fj[1];n.Set(fi.country,C.tryGetCountry(fk,fl));return m.Return(null);});}));});}return fa;});},processMarkets:function(){return m.Delay(function(){var fn,fp,fq,fr;fn=function(fo){return fo.markets.$==0;};fp=n.Get(C.eventsCatalogue().Var);fq=p.filter(fn,fp);fr=p.toList(fq);return(fr.$==0?true:D.hasNot())?m.Return(null):m.For(fr,function(fs){var ft,fu,fv,fw;ft=fs.gameId;fu=ft[0];fv=ft[1];fw=v.Async("WebFace:4",[fu,fv]);return m.Bind(fw,function(fx){var fy,fz,fA,fD,fG,fH,fI,fJ,fK,fL,fU,fV,fX;if(fx.$==1){fz=fx.$0;fA=function(fB){var fC;fB[0];fB[1];fB[2];fC=fB[3];return fC;};fD=function(fE){return function(fF){return fE+fF;};};fG=fs.gameId;fH=fG[0];fI=fG[1];fJ=d.choose(fA,fz);fK=p.fold(fD,0,fJ);C.updateTotalMatched(fH,fI,fK);fL=function(fM){var fN,fO,fP,fQ;fN=fM[0];fO=fM[1];fP=fM[2];fM[3];fQ=function(fR){var fS,fT;fS=fR[0];fT=fR[1];return{selectionId:fT,runnerName:fS};};return{marketId:fN,marketName:fO,runners:d.map(fQ,fP)};};fU=d.map(fL,fz);fV=function(fW){return{$:1,$0:$.New(K,{gameId:fW.gameId,country:fW.country,markets:fU})};};fX=fs.gameId;C.eventsCatalogue().UpdateBy(fV,fX);fy=m.Return(null);}else{fy=m.Return(null);}return fy;});});});},renderGamesHeaderRow:$.Field(function(){var fY,fZ,f0,f1,f2,f3,f4;fY=d.ofArray([c.TextNode("\u2116")]);fZ=d.ofArray([c.TextNode("1")]);f0=$.New(h,{$:0});f1=d.ofArray([c.TextNode("2")]);f2=$.New(h,{$:0});f3=d.ofArray([c.TextNode("GPB")]);f4=$.New(h,{$:0});return d.ofArray([c.Element("th",[],fY),c.Element("th",[],fZ),c.Element("th",[],f0),c.Element("th",[],f1),c.Element("th",[],f2),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("1")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("×")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("2")])),c.Element("th",[],f3),c.Element("th",[],f4)]);}),renderMeetup:function(f5){var f6,gc,gd,ge,gf,gg,gk,gl,gm,gn,go,gp,gq,gF,gG,gH,gI,gO,gP;f6=function(f7){return function(f8){var f9,f_,ga,gb;f_=function(f$){return I.formatDecimalOption(f$);};ga=f8.get_View();gb=q.Map(f_,ga);f9=c.Element("td",d.ofArray([j.Create("class",f7?"kef kef-back":"kef kef-lay")]),d.ofArray([c.TextView(gb)]));return C.doc(f9);};};gc=f6(true);gd=f6(false);gg=function(gh){var gi,gj;gi=gh[0];gj=gh[1];return $$.String(gi)+"."+$$.String(gj);};gk=f5.order.get_View();gl=q.Map(gg,gk);gf=d.ofArray([c.TextView(gl)]);gm=c.Element("td",[],gf);gn=c.Element("td",d.ofArray([j.Create("class","home-team")]),d.ofArray([c.TextNode(f5.game.home)]));go=q.get_Do();gp=f5.playMinute.get_View();gq=L.Bind(function(gr){var gs;gs=f5.summary.get_View();return L.Bind(function(gt){var gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE;if(gr.$==1){if(gt!==""){gw=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(gt)]));gv=C.doc(gw);}else{if(gt!==""){gy=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(gt)]));gx=C.doc(gy);}else{gz=$.New(h,{$:0});gA=c.Element("td",[],gz);gx=C.doc(gA);}gv=gx;}gu=gv;}else{if(gt!==""){gC=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(gt)]));gB=C.doc(gC);}else{gD=$.New(h,{$:0});gE=c.Element("td",[],gD);gB=C.doc(gE);}gu=gB;}return L.Const(gu);},gs);},gp);gF=c.Element("td",d.ofArray([j.Create("class","away-team")]),d.ofArray([c.TextNode(f5.game.away)]));gG=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextView(f5.status.get_View())]));gH=f5.totalMatched.get_View();gI=function(gJ){var gK,gL,gM,gN;if(gJ.$==1){gL=gJ.$0;gM=$$.String(gL);gK=c.Element("td",d.ofArray([j.Create("class","game-gpb")]),d.ofArray([c.TextNode(gM)]));}else{gN=$.New(h,{$:0});gK=c.Element("td",[],gN);}return gK;};gO=q.Map(gI,gH);gP=c.Element("td",d.ofArray([j.Create("class","game-country")]),d.ofArray([c.TextView(f5.country.get_View())]));ge=d.ofArray([C.doc(gm),C.doc(gn),c.EmbedView(gq),C.doc(gF),C.doc(gG),gc(f5.winBack),gd(f5.winLay),gc(f5.drawBack),gd(f5.drawLay),gc(f5.loseBack),gd(f5.loseLay),c.EmbedView(gO),C.doc(gP)]);return c.Element("tr",[],ge);},renderPagination:$.Field(function(){var gQ,gR,gS;gQ=q.get_Do();gR=C.varPagesCount().get_View();gS=L.Bind(function(gT){var gU,gV;if(gT<2){gU=L.Const(c.get_Empty());}else{gV=C.varCurrentPageNumber().get_View();gU=L.Bind(function(gW){var gX;gX=p.toList(p.delay(function(){return p.map(function(gZ){var g0,g6,g7,g8,g9;g0=p.toList(p.delay(function(){return p.append([j.Create("href","#")],p.delay(function(){return p.append([i.Handler("click",function(){return function(){return n.Set(C.varCurrentPageNumber(),gZ);};})],p.delay(function(){return gZ===gW?[j.Create("class","w3-green")]:p.empty();}));}));}));g6="\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 "+$$.String(gZ+1);g7=c.TextNode(g6);g8=d.ofArray([c.Element("a",g0,d.ofArray([g7]))]);g9=c.Element("li",[],g8);return C.doc(g9);},M.range(0,gT));}));return L.Const(c.Concat(gX));},gV);}return gU;},gR);return c.EmbedView(gS);}),"render\u0421oupon":$.Field(function(){var g_,g$,ha,hc,hd,hg,hj,hk;g_=d.ofArray([j.Create("class","w3-container")]);ha=d.ofArray([c.Element("tr",d.ofArray([i.Class("coupon-header-row")]),p.map(function(hb){return C.doc(hb);},C.renderGamesHeaderRow()))]);hd=function(he){var hf;hf=C.renderMeetup(he);return C.doc(hf);};hg=function(hh){var hi;hi=p.map(hd,hh);return c.Concat(hi);};hj=C.meetups().get_View();hk=q.Map(hg,hj);hc=d.ofArray([c.EmbedView(hk)]);g$=d.ofArray([c.Element("thead",[],ha),c.Element("tbody",[],hc)]);return c.Element("div",g_,d.ofArray([c.Element("div",d.ofArray([j.Create("class","w3-center")]),d.ofArray([c.Element("ul",d.ofArray([j.Create("class","w3-pagination")]),d.ofArray([C.renderPagination()]))])),c.Element("table",[],g$)]));}),stvr:function(hl,hm){return!w.Equals(n.Get(hl),hm)?n.Set(hl,hm):null;},tryGetCountry:function(hn,ho){var hp,hq,hr,hs,ht,hu,hv;hp=[hn,ho];hq=hp[0];hr=hp[1];hs=C.tryGetEvent(hq,hr);if(hs.$==1){if(hs.$0.country.$==1){hv=hs.$0.country.$0;hu=hv;}else{hu="";}ht=hu;}else{ht="";}return ht;},tryGetEvent:function(hw,hx){var hy,hz,hC;hy=[hw,hx];hz=function(hA){var hB;hB=hA.gameId;return w.Equals(hy,hB);};hC=n.Get(C.eventsCatalogue().Var);return p.tryFind(hz,hC);},updateCoupon:function(hD,hE,hF){var hG,hH,hI,hL,hM,hN,hO,hQ,hT,hU;hG=hD.$==0;if(!hG){hI=function(hJ){var hK;hK="adding new games "+$$.String(hJ);return G?G.log(hK):undefined;};hL=hD.get_Length();hI(hL);hH=C.addNewGames(hD);}else{hH=null;}hM=p.isEmpty(hF);if(!hM){hO=function(hP){return C.meetups().RemoveByKey(hP);};p.iter(hO,hF);hQ=function(hR){var hS;hS="removing out games "+$$.String(hR);return G?G.log(hS):undefined;};hT=p.length(hF);hN=hQ(hT);}else{hN=null;}hU=function(hV){var hW,hX,hY,hZ,h0,h1,h2,h3;hW=hV[0];hX=hV[1];hY=hV[2];hZ=C.meetups().TryFindByKey(hW);if(hZ.$==1){h1=hZ.$0;if(h1.hash!==hY){h3=hZ.$0;h3.hash=hY;C.stvr(h3.playMinute,hX.playMinute);C.stvr(h3.status,hX.status);C.stvr(h3.summary,hX.summary);C.stvr(h3.order,hX.order);C.stvr(h3.winBack,hX.winBack);C.stvr(h3.winLay,hX.winLay);C.stvr(h3.drawBack,hX.drawBack);C.stvr(h3.drawLay,hX.drawLay);C.stvr(h3.loseBack,hX.loseBack);h2=C.stvr(h3.loseLay,hX.loseLay);}else{h2=null;}h0=h2;}else{h0=null;}return h0;};return p.iter(hU,hE);},updateTotalMatched:function(h4,h5,h6){var h7,h8,h9,h_;h7=[h4,h5];h8=C.meetups().TryFindByKey(h7);if(h8.$==1){h_=h8.$0;h9=n.Set(h_.totalMatched,{$:1,$0:h6});}else{h9=null;}return h9;},varCurrentPageNumber:$.Field(function(){return l.Create(0);}),varDataRecived:$.Field(function(){return l.Create(false);}),varPagesCount:$.Field(function(){return l.Create(1);})},Utils:{Left:function(h$){return{$:0,$0:h$};},LocalStorage:{checkTodayKey:function(ia,ib){var ic,id,ie,_if;ic=N.now();id=J.getWithDef(ia,ic);if(ic-id>1*86400000){J.clear(ib);J.set(ia,N.now());_if=function(ig){return function(ih){var ii;ii="local storage "+F.prettyPrint(ig)+" of "+F.prettyPrint(ih)+" is inspired";return G?G.log(ii):undefined;};};(_if(ib))(id);ie=ic;}else{ie=id;}return ie;},clear:function(ij){return J.strg().removeItem(ij);},get:function(ik){var il,im,_in,io,ip;try{im=J.strg().getItem(ik);_in=O.parse(im);il={$:1,$0:_in};}catch(io){ip=function(iq){return function(ir){var is;is="error getting from local storage, key "+F.prettyPrint(iq)+" : "+F.prettyPrint(ir);return G?G.log(is):undefined;};};(ip(ik))(io);il={$:0};}return il;},getWithDef:function(it,iu){var iv,iw,ix;iv=J.get(it);if(iv.$==1){ix=iv.$0;iw=ix;}else{iw=iu;}return iw;},set:function(iy,iz){var iA,iB,iC,iD;try{iB=O.stringify(iz);iA=J.strg().setItem(iy,iB);}catch(iC){iD=function(iE){return function(iF){return function(iG){return M.FailWith("error setting to local storage, key "+F.prettyPrint(iE)+", value "+F.prettyPrint(iF)+" : "+F.prettyPrint(iG));};};};iA=((iD(iy))(iz))(iC);}return iA;},strg:$.Field(function(){return P.localStorage;})},Right:function(iH){return{$:1,$0:iH};},dateTimeToString:function($s){var $0=this,$this=this;return $$.dateTimeToString($s);},formatDecimal:function(iI){return I.trimEnd(iI.toFixed(6),d.ofArray([48,46]));},formatDecimalOption:function(iJ){var iK,iL;if(iJ.$==1){iL=iJ.$0;iK=I.formatDecimal(iL);}else{iK="";}return iK;},getDatePart:function(iM){var iN;iN=new N(iM.getTime());iN.setHours(0,0,0,0);return iN;},mkids:function(iO,iP){var iQ,iS,iT,iU,iV;iQ=function(iR){return[iP(iR),iR];};iS=d.map(iQ,iO);iT=R.OfArray(p.toArray(iS));iU=d.map(iP,iO);iV=S.New1(T.OfSeq(iU));return[iV,iT];},trimEnd:function(iW,iX){var iY,iZ,i0,i1,i2,i3,i4,i5,i6,i7,i8,i9;iY=[iW,iX];if(iY[0]===""){iZ="";}else{if(iY[1].$==1){i1=iY[0];iY[1];i2=iY[1].$0;if(i1.charCodeAt(i1.length-1)===i2){iY[1].$0;i4=iY[1];i5=iY[0];i3=I.trimEnd(U.string(i5,{$:0},{$:1,$0:i5.length-2}),i4);}else{if(iY[1].$==1){i7=iY[0];i8=iY[1].$1;i6=I.trimEnd(i7,i8);}else{i6=M.Raise(V.New("E:\\User\\Docs\\Visual Studio 2015\\Projects\\Betfair\\CentBet\\WebFace\\ClientUtils.fs",8,18));}i3=i6;}i0=i3;}else{i9=iY[0];i0=i9;}iZ=i0;}return iZ;},"|Left|Right|":function(i_){var i$,ja,jb;if(i_.$==1){ja=i_.$0;i$={$:1,$0:ja};}else{jb=i_.$0;i$={$:0,$0:jb};}return i$;}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.UI);b=$.Safe(a.Next);c=$.Safe(b.Doc);d=$.Safe($$.WebSharper.List);e=$.Safe($$.CentBet);f=$.Safe(e.Client);g=$.Safe(f.Admin);h=$.Safe(d.T);i=$.Safe(b.AttrModule);j=$.Safe(b.AttrProxy);k=$.Safe(b.Key);l=$.Safe(b.Var);m=$.Safe($$.WebSharper.Concurrency);n=$.Safe(b.Var1);o=$.Safe($$.WebSharper.Option);p=$.Safe($$.WebSharper.Seq);q=$.Safe(b.View);r=$.Safe(g.RecordType);s=$.Safe($$.WebSharper.Strings);t=$.Safe($$.Seq);u=$.Safe($$.WebSharper.Remoting);v=$.Safe(u.AjaxRemotingProvider);w=$.Safe($$.WebSharper.Unchecked);x=$.Safe(b.Storage1);y=$.Safe($$.WebSharper.Json);z=$.Safe(y.Provider);A=$.Safe(z.Id);B=$.Safe(b.ListModel);C=$.Safe(f.Coupon);D=$.Safe(C.ServerBetfairsSession);E=$.Safe(C.Work);F=$.Safe($$.WebSharper.PrintfHelpers);G=$.Safe($$.console);H=$.Safe(C.Meetup);I=$.Safe(f.Utils);J=$.Safe(I.LocalStorage);K=$.Safe(C.EventCatalogue);L=$.Safe(b.View1);M=$.Safe($$.WebSharper.Operators);N=$.Safe($$.Date);O=$.Safe($$.JSON);P=$.Safe($$.window);Q=$.Safe($$.WebSharper.Collections);R=$.Safe(Q.MapModule);S=$.Safe(Q.FSharpSet);T=$.Safe(Q.BalancedTree);U=$.Safe($$.WebSharper.Slice);return V=$.Safe($$.WebSharper.MatchFailureException);});$.OnLoad(function(){J.strg();C.varPagesCount();C.varDataRecived();C.varCurrentPageNumber();C["render\u0421oupon"]();C.renderPagination();C.renderGamesHeaderRow();C.meetups();C.eventsCatalogue();D.hasServerBetfairsSession();g.varConsole();g.varCommandsHistory();g.varCmd();g.renderRecord();g.op_SpliceUntyped();g["cmd-input"]();return;});}());
