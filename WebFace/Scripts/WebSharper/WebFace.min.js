(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6;$.Define($$,{CentBet:{Client:{Admin:{RecordType:$.Class({},{get_color:function(){return function(_7){return _7.$==1?["lightgrey","red"]:_7.$==2?["lightgrey","green"]:["white","navy"];};}}),Render:function(){var _8;_8=$.New(h,{$:0});return c.Concat(d.ofArray([g.RenderCommandPrompt(),(g.op_SpliceUntyped())(c.Element("br",[],_8)),g.RenderRecords()]));},RenderCommandPrompt:function(){var _9;_9=d.ofArray([(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("margin-left","10px")]),$.New(h,{$:0}))),(g.op_SpliceUntyped())(c.Element("label",d.ofArray([j.Create("for",g["cmd-input"]())]),d.ofArray([c.TextNode("Input here:")]))),g.renderInput()]);return c.Concat(_9);},RenderRecords:function(){var _,bd;_=function(ba){var bb,bc;bc=$.New(h,{$:0});bb=d.ofArray([(g.renderRecord())(ba),(g.op_SpliceUntyped())(c.Element("br",[],bc))]);return c.Concat(bb);};bd=g.varConsole().get_View();return c.ConvertSeq(_,bd);},addRecord:function(bd,be){return g.varConsole().Add({Id:k.Fresh(),Text:be,RecordType:bd});},"cmd-input":$.Field(function(){return"cmd-input";}),cmdKey:function(bf){return bf.Id;},doc:function(bg){return bg;},op_SpliceUntyped:$.Field(function(){return function(bh){return g.doc(bh);};}),recordKey:function(bi){return bi.Id;},renderInput:function(){var bj,bk,bl,bm,bp,bs,bw,bx,bN;bj=l.Create("");bk=l.Create(null);bl=l.Create(false);bm=m.Delay(function(){n.Set(bl,true);return m.Bind(g.send(n.Get(bj)),function(){n.Set(bl,false);n.Set(bj,"");return m.Return(null);});});bp=function(bq){var br;br={$:1,$0:bq};g.varCmd=function(){return br;};return n.Set(bj,bq.Text);};bs=function(bt){var bu,bv;bu=g.tryGetCommandFromHistory(bt);bv=o.map(bp,bu);return;};bw=bl.get_View();bx=function(by){var bz;bz=d.ofArray([c.Input(p.toList(p.delay(function(){return p.append([j.Create("id",g["cmd-input"]())],p.delay(function(){return p.append(by?[j.Create("disabled","disabled")]:p.empty(),p.delay(function(){return p.append([i.Style("width","80%")],p.delay(function(){return p.append([i.CustomVar(bk,function(bE){return function(){return bE.focus();};},function(){return{$:0};})],p.delay(function(){return[i.Handler("keydown",function(){return function(bJ){var bK,bL,bM;bK=bJ.keyCode;if(bK===13){bM=n.Get(bj).toLowerCase();bL=bM==="-clear-output"?g.varConsole().Clear():bM==="-clear-hist"?g.varCommandsHistory().Clear():m.Start(bm,{$:0});}else{bL=bK===38?bs(true):bK===40?bs(false):null;}return bL;};})];}));}));}));}));})),bj)]);return c.Concat(bz);};bN=q.Map(bx,bw);return c.EmbedView(bN);},renderRecord:$.Field(function(){var bO;bO=function(bP){var bQ,bR,bS,bT,bU;try{bR=(r.get_color())(bP.RecordType);bS=bR[1];bT=bR[0];bQ=(g.op_SpliceUntyped())(c.Element("span",d.ofArray([i.Style("color",bS),i.Style("background",bT)]),d.ofArray([c.TextNode(bP.Text)])));}catch(bU){g.varCommandsHistory().Clear();g.varConsole().Clear();bQ=c.get_Empty();}return bQ;};return function(bV){var bW;bW=q.Map(bO,bV);return c.EmbedView(bW);};}),send:function(bX){return m.Delay(function(){var bZ,b0,b1,b2,b3,b4;bZ=s.Trim(bX);g.addRecord($.New(r,{$:2}),bZ);b1=n.Get(g.varCommandsHistory().Var);if(p.isEmpty(b1)){b2=true;}else{b3=t.last(b1);b2=b3.Text!==bZ;}if(b2){g.varCommandsHistory().Add({Id:k.Fresh(),Text:bZ});b4=m.Return(null);}else{b4=m.Return(null);}b0=b4;return m.Combine(b0,m.Delay(function(){return m.TryWith(m.Delay(function(){var b7;b7=v.Async("WebFace:2",[bZ]);return m.Bind(b7,function(b8){var b9,b_,b$;if(b8.$==1){b_=b8.$0;g.addRecord($.New(r,{$:1}),b_);b9=m.Return(null);}else{b$=b8.$0;g.addRecord($.New(r,{$:0}),b$);b9=m.Return(null);}return b9;});}),function(ca){g.addRecord($.New(r,{$:1}),ca.message);return m.Return(null);});}));});},tryGetCommandFromHistory:function(cb){var cc,cd,ce,cf,cg,ch,ci,cl,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN;cc=n.Get(g.varCommandsHistory().Var);cd=p.length(cc);if(cd===0){ce={$:0};}else{if(g.varCmd().$==1){ch=g.varCmd().$0.Id;ci=function(cj){return function(ck){return[ck,cj];};};cl=function(cm){var cn,co;cn=cm[0];cm[1];co=cn.Id;return w.Equals(co,ch);};cp=n.Get(g.varCommandsHistory().Var);cq=p.mapi(ci,cp);cr=p.tryFind(cl,cq);cs=[cr,cb];if(cs[0].$==1){if(cs[1]){cs[0].$0[0];cv=cs[0].$0[1];if(cd>0?cv<cd-1:false){cx=cs[0].$0[1];cs[0].$0[0];cw=cx+1;}else{if(cs[0].$==1){if(cs[1]){cz=cs[1]?cd-1:0;}else{cs[0].$0[0];cA=cs[0].$0[1];if(cd>0?cA>0:false){cC=cs[0].$0[1];cs[0].$0[0];cB=cC-1;}else{cB=cs[1]?cd-1:0;}cz=cB;}cy=cz;}else{cy=cs[1]?cd-1:0;}cw=cy;}cu=cw;}else{if(cs[0].$==1){if(cs[1]){cE=cs[1]?cd-1:0;}else{cs[0].$0[0];cF=cs[0].$0[1];if(cd>0?cF>0:false){cH=cs[0].$0[1];cs[0].$0[0];cG=cH-1;}else{cG=cs[1]?cd-1:0;}cE=cG;}cD=cE;}else{cD=cs[1]?cd-1:0;}cu=cD;}ct=cu;}else{if(cs[0].$==1){if(cs[1]){cJ=cs[1]?cd-1:0;}else{cs[0].$0[0];cK=cs[0].$0[1];if(cd>0?cK>0:false){cM=cs[0].$0[1];cs[0].$0[0];cL=cM-1;}else{cL=cs[1]?cd-1:0;}cJ=cL;}cI=cJ;}else{cI=cs[1]?cd-1:0;}ct=cI;}cg=ct;}else{cg=cd-1;}cf=cg;cN=p.nth(cf,cc);ce={$:1,$0:cN};}return ce;},varCmd:$.Field(function(){return{$:0};}),varCommandsHistory:$.Field(function(){var cO,cP,cQ,cT,cV,cW,cX,c1,c2,c6,c8;try{cQ=function(cR){var cS;cS="restoring list - "+x.prettyPrint(cR);return y?y.log(cS):undefined;};cQ("CentBetConsoleCommandsHistory");cT=function(cU){return g.cmdKey(cU);};cV=z.LocalStorage("CentBetConsoleCommandsHistory",{Encode:(B.get_Default().EncodeRecord(undefined,[["Id",B.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0]]))(),Decode:(B.get_Default().DecodeRecord(undefined,[["Id",B.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0]]))()});cW=D.CreateWithStorage(cT,cV);cX=function(cY){return function(cZ){var c0;c0=x.prettyPrint(cY)+" - "+$$.String(cZ);return y?y.log(c0):undefined;};};(cX("CentBetConsoleCommandsHistory"))(cW.get_Length());cP=cW;}catch(c1){c2=function(c3){return function(c4){var c5;c5="error when restoring "+x.prettyPrint(c3)+" - "+x.prettyPrint(c4);return y?y.log(c5):undefined;};};(c2("CentBetConsoleCommandsHistory"))(c1);c6=function(c7){return g.cmdKey(c7);};c8=$.New(h,{$:0});cP=D.Create(c6,c8);}cO=cP;return cO;}),varConsole:$.Field(function(){var c9,c_,c$,dc,de,df,dg,dk,dl,dp,dr;try{c$=function(da){var db;db="restoring list - "+x.prettyPrint(da);return y?y.log(db):undefined;};c$("CentBetConsole");dc=function(dd){return g.recordKey(dd);};de=z.LocalStorage("CentBetConsole",{Encode:(B.get_Default().EncodeRecord(undefined,[["Id",B.get_Default().EncodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0],["RecordType",B.get_Default().EncodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))(),Decode:(B.get_Default().DecodeRecord(undefined,[["Id",B.get_Default().DecodeUnion(k,"$",[[0,[["$0","Item",C,0]]]]),0],["Text",C,0],["RecordType",B.get_Default().DecodeUnion(r,"$",[[0,[]],[1,[]],[2,[]]]),0]]))()});df=D.CreateWithStorage(dc,de);dg=function(dh){return function(di){var dj;dj=x.prettyPrint(dh)+" - "+$$.String(di);return y?y.log(dj):undefined;};};(dg("CentBetConsole"))(df.get_Length());c_=df;}catch(dk){dl=function(dm){return function(dn){var _do;_do="error when restoring "+x.prettyPrint(dm)+" - "+x.prettyPrint(dn);return y?y.log(_do):undefined;};};(dl("CentBetConsole"))(dk);dp=function(dq){return g.recordKey(dq);};dr=$.New(h,{$:0});c_=D.Create(dp,dr);}c9=c_;return c9;})},Coupon:{Render:function(){var ds,dt,du,dv,dH;ds=l.Create(false);E.start(ds);du=F.varMode().get_View();dv=function(dw){var dx,dy,dz,dF,dG;if(dw.$==1){dy=dw.$0;dx=G.renderExploreMarkets(dy);}else{dz=function(dA){var dB,dC,dD,dE;if(dA){dC=H["render\u0421oupon"]();dB=H.doc(dC);}else{dD=d.ofArray([c.TextNode("\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435.")]);dE=c.Element("h1",[],dD);dB=H.doc(dE);}return dB;};dF=ds.get_View();dG=q.Map(dz,dF);dx=c.EmbedView(dG);}return dx;};dH=q.Map(dv,du);dt=d.ofArray([c.EmbedView(dH)]);return c.Concat(dt);},SettingsDialog:{Helpers:{buttonDoc:function(dI){var dJ,dK,dO;dJ=I.view();dK=function(dL){var dM,dN;if((dI?dL===40:false)?true:!dI?dL===10:false){dM=c.get_Empty();}else{dN=K.buttonElt(dI,dL);dM=H.doc(dN);}return dM;};dO=q.Map(dK,dJ);return c.EmbedView(dO);},buttonElt:function(dP,dQ){var dZ;dZ=dP?"+":"-";return c.Element("button",d.ofArray([K.op_SpliceUntyped("w3-btn w3-teal"),j.Create("style","margin: 10px; width: 50px; height: 50px;"),i.Handler("click",function(){return function(){var dT,dU,dV,dW,dX,dY;dT=[dP,dQ];if(dT[0]){if(dT[1]===40){dV=null;}else{dW=dQ+(dP?1:-1);dV=I.set(dW);}dU=dV;}else{if(dT[1]===10){dX=null;}else{dY=dQ+(dP?1:-1);dX=I.set(dY);}dU=dX;}return dU;};})]),d.ofArray([c.TextNode(dZ)]));},close:function(){return n.Set(K.varVisible(),false);},content:$.Field(function(){var d0,d2,d3,d5;d0=L.titleAndCloseButton("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0442\u0447\u0435\u0439 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435",function(){return K.close();});d3=function(d4){return $$.String(d4);};d5=I.view();d2=c.Element("div",d.ofArray([K.op_SpliceUntyped("w3-xxlarge"),j.Create("style","margin : 10px; float : left;")]),d.ofArray([c.TextView(q.Map(d3,d5))]));return d.ofArray([H.doc(d0),H.doc(d2),K.buttonDoc(true),K.buttonDoc(false)]);}),op_SpliceUntyped:function(d6){return j.Create("class",d6);},renderDialog:$.Field(function(){return L.createModal(K.varVisible().get_View(),function(){return K.close();});}),varVisible:$.Field(function(){return l.Create(false);})},elt:$.Field(function(){return((K.renderDialog())($.New(h,{$:0})))(K.content());}),show:function(){return n.Set(K.varVisible(),true);}},doc:function(d8){return d8;},renderMeetup:$.Field(function(){var d9,d_,d$;d9=[F.varColumnGpbVisible().get_View(),F.varColumnCountryVisible().get_View()];d_=d9[0];d$=d9[1];return function(ea){return M.renderMeetup(d_,d$,ea);};}),renderPagination:$.Field(function(){var eb,ec,ed;eb=q.get_Do();ec=F.varPagesCount().get_View();ed=N.Bind(function(ee){var ef;ef=F.varCurrentPageNumber().get_View();return N.Bind(function(eg){var eh,ek,ex;eh=i.Handler("click",function(){return function(){return J.show();};});ek=p.toList(p.delay(function(){return p.append(p.map(function(em){var en,et,eu;en=p.toList(p.delay(function(){return p.append([j.Create("href","#")],p.delay(function(){return p.append([i.Handler("click",function(){return function(){return n.Set(F.varTargetPageNumber(),em);};})],p.delay(function(){return em===eg?[j.Create("class","w3-teal")]:p.empty();}));}));}));eu=$$.String(em+1);et=d.ofArray([c.Element("a",en,d.ofArray([c.TextNode(eu)]))]);return c.Element("li",[],et);},O.range(0,ee-1)),p.delay(function(){var ew;ew=d.ofArray([c.Element("a",d.ofArray([j.Create("href","#"),eh]),d.ofArray([c.TextNode("...")]))]);return[c.Element("li",[],ew)];}));}));ex=d.map(function(ey){return H.doc(ey);},ek);return N.Const(c.Concat(ex));},ef);},ec);return c.EmbedView(ed);}),"render\u0421oupon":$.Field(function(){var ez,eA,eB,eC,eD,eE,eF,eG,eJ,eM,eN,eO,eP,eQ,eR;ez=d.ofArray([j.Create("class","w3-responsive")]);eB=d.ofArray([j.Create("class","w3-table w3-bordered w3-striped w3-hoverable")]);eC=d.ofArray([c.Element("tr",d.ofArray([i.Class("coupon-header-row w3-teal")]),M.renderGamesHeaderRow(F.varColumnGpbVisible().get_View()))]);eE=F.meetups().get_View();eF=H.renderMeetup();eG=function(eH){var eI;eI=eF(eH);return H.doc(eI);};eJ=function(eK){var eL;eL=p.map(eG,eK);return c.Concat(eL);};eM=q.Map(eJ,eE);eD=d.ofArray([c.EmbedView(eM)]);eA=d.ofArray([c.Element("table",eB,d.ofArray([c.Element("thead",[],eC),c.Element("tbody",[],eD)]))]);eN=c.Element("div",ez,eA);eO=d.ofArray([j.Create("class","w3-container")]);eP=q.get_Do();eQ=F.varCurrentPageNumber().get_View();eR=N.Bind(function(eS){return N.Bind(function(eT){var eU,eV,eW,eX;if(eS===eT){eV=eN;}else{eX="\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u2116 "+$$.String(eT+1)+"...";eW=d.ofArray([c.TextNode(eX)]);eV=c.Element("h1",[],eW);}eU=eV;return N.Const(H.doc(eU));},F.varTargetPageNumber().get_View());},eQ);return c.Element("div",eO,d.ofArray([c.Element("div",d.ofArray([j.Create("class","w3-center")]),d.ofArray([c.Element("ul",d.ofArray([j.Create("class","w3-pagination w3-border w3-round")]),d.ofArray([H.renderPagination()]))])),c.EmbedView(eR),J.elt()]));})},Football:{Event:$.Class({},{id:function(eY){return eY.gameId;}}),Market:$.Class({},{New:function(eZ,e0,e1){var e3;e3=function(e4){var e5,e6;e5=e4[0];e6=e4[1];return{selectionId:e6,runnerName:e5};};return $.New(Q,{marketId:eZ,marketName:e0,runners:d.map(e3,e1)});},id:function(e7){return e7.marketId;}}),MarketBook:$.Class({},{New:function(e8){var e9,e$;e9=function(e_){return S.New(e_);};e$=e8.runners;return $.New(R,{marketId:e8.marketId,marketName:e8.marketName,visible:l.Create(false),runners:d.map(e9,e$)});},id:function(fa){return fa.marketId;}}),Meetup:$.Class({},{id:function(fb){return fb.game.gameId;}}),RunnerBook:$.Class({},{New:function(fc){var fd;fd=function(){return l.Create({$:0});};return $.New(S,{selectionId:fc.selectionId,runnerName:fc.runnerName,backPrice:fd(null),backSize:fd(null),layPrice:fd(null),laySize:fd(null)});}})},GameDetail:{Helpers:{renderGameInfo:function(ff){var fg,fh,fk,fl,fm,fn,fr,fs,ft,fu,fD,fE;fg=d.ofArray([G.op_SpliceUntyped("w3-indigo")]);fh=d.ofArray([G.op_SpliceUntyped("w3-row")]);fk=d.ofArray([G.op_SpliceUntyped("w3-col s4"),j.Create("style","text-align: right; margin : 10px;")]);fl=ff.country.get_View();fm=c.get_Empty();fn=function(fo){var fp;fp=o.map(function(fq){return c.TextNode(fq);},fo);return T.getWith(fm,fp);};fr=q.Map(fn,fl);fs=d.ofArray([G.op_SpliceUntyped("w3-col s2"),j.Create("style","color : #b4e500; margin : 0 10px;")]);ft=ff.totalMatched.get_View();fu=function(fv){var fw,fy,fB,fC;fw=function(fx){return fx[1];};fy=function(fz){return function(fA){return fz+fA;};};fB=d.map(fw,fv);fC=p.fold(fy,0,fB);return fC===0?c.get_Empty():c.TextNode($$.String(fC)+" GPB");};fD=q.Map(fu,ft);fE=d.ofArray([G.op_SpliceUntyped("w3-row")]);return c.Element("div",fg,d.ofArray([c.Element("div",fh,d.ofArray([c.Element("a",d.ofArray([j.Create("style","text-align: left; margin-left : 5px;"),G.op_SpliceUntyped("w3-col s6"),j.Create("href","#"),i.Handler("click",function(){return function(){return n.Set(F.varMode(),{$:0});};})]),d.ofArray([c.TextNode("\u041d\u0430\u0437\u0430\u0434 \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u043c\u0430\u0442\u0447\u0435\u0439")])),c.Element("div",fk,d.ofArray([c.EmbedView(fr)])),c.Element("div",fs,d.ofArray([c.EmbedView(fD)]))])),c.Element("div",fE,d.ofArray([c.Element("h1",d.ofArray([G.op_SpliceUntyped("w3-col s5"),j.Create("style","text-align: right;")]),d.ofArray([c.TextNode(ff.game.home)])),c.Element("h1",d.ofArray([G.op_SpliceUntyped("w3-col s2"),j.Create("style","text-align: center; color : #b4e500;")]),d.ofArray([c.TextView(ff.summary.get_View())])),c.Element("h1",d.ofArray([G.op_SpliceUntyped("w3-col s5"),j.Create("style","text-align: left;")]),d.ofArray([c.TextNode(ff.game.away)]))])),c.Element("div",d.ofArray([j.Create("style","width : 100%;")]),d.ofArray([c.Element("h2",d.ofArray([j.Create("style","text-align: center;")]),d.ofArray([c.TextView(ff.status.get_View())]))]))]));},renderMarket:function(fF){var fG,fH,fI,fK,fL;fI=function(fJ){return U.renderMarketTable(fF,fJ);};fK=fF.visible.get_View();fL=q.Map(fI,fK);fH=d.ofArray([c.EmbedView(fL)]);fG=d.ofArray([c.Element("table",[],fH)]);return c.Element("li",[],fG);},renderMarketTable:function(fM,fN){var fO;fO=p.toList(p.delay(function(){var fQ;fQ=U.renderRunnersLinkRow(fM,fN);return p.append([G.doc(fQ)],p.delay(function(){var fS,fT,fW;if(fN){fT=function(fU){var fV;fV=U.renderRunner(fU);return G.doc(fV);};fW=fM.runners;fS=d.map(fT,fW);}else{fS=p.empty();}return fS;}));}));return c.Concat(fO);},renderMarkets:function(fX){var fY,fZ,f2,f4,f5,f6,f7,f8,f9,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh;fY=j.Create("style","border-right : 1px solid #ddd;");fZ=function(f0){var f1;f1=U.renderMarket(f0);return G.doc(f1);};f2=function(f3){return d.map(fZ,f3);};f4=fX.marketsBook;f5=(U.window(3))(f4);if(f5.$==1){if(f5.$1.$==1){if(f5.$1.$1.$==1){if(f5.$1.$1.$1.$==0){f_=f5.$0;f$=f5.$1.$0;ga=f5.$1.$1.$0;gb=d.ofArray([G.op_SpliceUntyped("w3-row")]);gc=c.Element("div",gb,d.ofArray([c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),f2(f_)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),f2(f$)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s4")]),f2(ga))]));f9=G.doc(gc);}else{f9=c.get_Empty();}f8=f9;}else{gd=f5.$0;ge=f5.$1.$0;gf=c.Element("div",d.ofArray([G.op_SpliceUntyped("w3-row")]),d.ofArray([c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s6")]),f2(gd)),c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul w3-col s6")]),f2(ge))]));f8=G.doc(gf);}f7=f8;}else{gg=f5.$0;gh=c.Element("ul",d.ofArray([G.op_SpliceUntyped("w3-ul")]),f2(gg));f7=G.doc(gh);}f6=f7;}else{f6=c.get_Empty();}return f6;},renderPrice:function(gi,gj,gk){var gl,gm,gn,gr,gs,gv;gl=d.ofArray([G.op_SpliceUntyped("price "+x.toSafe(gi?"back":"lay"))]);gm=gk.get_View();gn=function(go){var gp,gq;gp=L.formatDecimal(go);gq=x.toSafe(gp)+x.toSafe(gj);return c.TextNode(gq);};gr=c.get_Empty();gs=function(gt){var gu;gu=o.map(gn,gt);return T.getWith(gr,gu);};gv=q.Map(gs,gm);return c.Element("td",gl,d.ofArray([c.EmbedView(gv)]));},renderRunner:function(gw){var gx,gy;gy=d.ofArray([c.TextNode(gw.runnerName)]);gx=d.ofArray([c.Element("td",[],gy),U.renderPrice(true,"",gw.backPrice),U.renderPrice(true,"$",gw.backSize),U.renderPrice(false,"",gw.layPrice),U.renderPrice(false,"$",gw.laySize)]);return c.Element("tr",[],gx);},renderRunnersLink:function(gz,gA){return c.Element("a",d.ofArray([j.Create("href","#"),i.Handler("click",function(){return function(){return n.Set(gz.visible,!n.Get(gz.visible));};}),G.op_SpliceUntyped(gA?"w3-teal":"w3-dark-grey"),j.Create("style","padding-left : 5px; padding-bottom : 5px; padding-top : 5px;")]),d.ofArray([c.TextNode(gz.marketName)]));},renderRunnersLinkRow:function(gD,gE){var gF,gG,gH,gI,gJ;gF=U.renderRunnersLink(gD,gE);if(gE){gH=c.Element("td",d.ofArray([j.Create("colspan","5")]),d.ofArray([gF]));}else{gI=d.ofArray([gF]);gH=c.Element("td",[],gI);}gG=gH;gJ=d.ofArray([gG]);return c.Element("tr",[],gJ);},window:function(gK){var gL,gO,gQ;gL=function(gM){return function(gN){return[gM%gK,gN];};};gO=function(gP){return gP[0];};gQ=function(gR){var gS,gT;gR[0];gS=gR[1];gT=p.map(function(gU){return gU[1];},gS);return p.toList(gT);};return function(gV){var gW,gX,gY;gW=p.mapi(gL,gV);gX=t.groupBy(gO,gW);gY=p.map(gQ,gX);return p.toList(gY);};}},doc:function(gZ){return gZ;},op_SpliceUntyped:function(g0){return j.Create("class",g0);},renderExploreMarkets:function(g1){var g2,g3;g3=U.renderGameInfo(g1);g2=d.ofArray([G.doc(g3),U.renderMarkets(g1)]);return c.Concat(g2);},varError:$.Field(function(){return l.Create(false);})},Meetup:{doc:function(g4){return g4;},renderCountry:function(g5,g6){var g7,g8;g7=q.get_Do();g8=N.Bind(function(g9){return!g9?N.Const(c.get_Empty()):N.Bind(function(g_){var g$,ha,hb,hc;if(g_.$==1){hb=g_.$0;ha=c.Element("td",d.ofArray([j.Create("class","game-country")]),d.ofArray([c.TextNode(hb)]));}else{hc=$.New(h,{$:0});ha=c.Element("td",[],hc);}g$=ha;return N.Const(M.doc(g$));},g6);},g5);return c.EmbedView(g8);},renderGameStat:function(hd){var he,hf,hg;he=q.get_Do();hf=hd.playMinute.get_View();hg=N.Bind(function(hh){var hi;hi=hd.summary.get_View();return N.Bind(function(hj){var hk,hl,hm,hn,ho,hp,hq,hr,hs,ht,hu;if(hh.$==1){if(hj!==""){hm=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(hj)]));hl=M.doc(hm);}else{if(hj!==""){ho=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(hj)]));hn=M.doc(ho);}else{hp=$.New(h,{$:0});hq=c.Element("td",[],hp);hn=M.doc(hq);}hl=hn;}hk=hl;}else{if(hj!==""){hs=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextNode(hj)]));hr=M.doc(hs);}else{ht=$.New(h,{$:0});hu=c.Element("td",[],ht);hr=M.doc(hu);}hk=hr;}return N.Const(hk);},hi);},hf);return c.EmbedView(hg);},renderGamesHeaderRow:function(hv){return p.toList(p.delay(function(){var hx,hy,hz,hA,hB,hC;hy=d.ofArray([c.TextNode("\u2116")]);hz=d.ofArray([c.TextNode("\u0414\u043e\u043c\u0430")]);hA=$.New(h,{$:0});hB=d.ofArray([c.TextNode("\u0412 \u0433\u043e\u0441\u0442\u044f\u0445")]);hC=$.New(h,{$:0});hx=d.ofArray([c.Element("th",[],hy),c.Element("th",[],hz),c.Element("th",[],hA),c.Element("th",[],hB),c.Element("th",[],hC),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041f\u043e\u0431\u0435\u0434\u0430")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041d\u0438\u0447\u044c\u044f")])),c.Element("th",d.ofArray([j.Create("colspan","2")]),d.ofArray([c.TextNode("\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u0435")]))]);return p.append(d.map(function(hD){return M.doc(hD);},hx),p.delay(function(){var hF,hK;hF=function(hG){var hH,hI,hJ;if(hG){hI=d.ofArray([c.TextNode("GPB")]);hJ=c.Element("th",[],hI);hH=M.doc(hJ);}else{hH=c.get_Empty();}return hH;};hK=q.Map(hF,hv);return p.append([c.EmbedView(hK)],p.delay(function(){var hM,hN;hM=$.New(h,{$:0});hN=c.Element("th",[],hM);return[M.doc(hN)];}));}));}));},renderKef:function(hO,hP,hQ){var hR,hS,hT,hV,hW;hR=hO?"back":"lay";hS="kef "+x.toSafe(hP)+" "+x.toSafe(hR);hT=function(hU){return L.formatDecimalOption(hU);};hV=hQ.get_View();hW=q.Map(hT,hV);return c.Element("td",d.ofArray([j.Create("class",hS)]),d.ofArray([c.TextView(hW)]));},renderMeetup:function(hX,hY,hZ){var h0,h3,h6,h9,ia,ib,ic,ig,ih,ii,ij,ik,il,im,_in,io,ip,iq,ir;h0=function(h1){return function(h2){return M.renderKef(true,h1,h2);};};h3=function(h4){return function(h5){return M.renderKef(false,h4,h5);};};h6=i.Handler("click",function(){return function(){return n.Set(F.varMode(),{$:1,$0:hZ});};});h9=function(h_){var h$;h$=c.Element("a",d.ofArray([j.Create("href","#"),h6]),d.ofArray([c.TextNode(h_)]));return M.doc(h$);};ic=function(id){var ie,_if;ie=id[0];_if=id[1];return $$.String(ie)+"."+$$.String(_if);};ig=hZ.order.get_View();ih=q.Map(ic,ig);ib=d.ofArray([c.TextView(ih)]);ii=c.Element("td",[],ib);ij=c.Element("td",d.ofArray([j.Create("class","home-team")]),d.ofArray([h9(hZ.game.home)]));ik=c.Element("td",d.ofArray([j.Create("class","away-team")]),d.ofArray([h9(hZ.game.away)]));il=c.Element("td",d.ofArray([j.Create("class","game-status")]),d.ofArray([c.TextView(hZ.status.get_View())]));im=(h0("win"))(hZ.winBack);_in=(h3("win"))(hZ.winLay);io=(h0("draw"))(hZ.drawBack);ip=(h3("draw"))(hZ.drawLay);iq=(h0("lose"))(hZ.loseBack);ir=(h3("lose"))(hZ.loseLay);ia=d.ofArray([M.doc(ii),M.doc(ij),M.renderGameStat(hZ),M.doc(ik),M.doc(il),M.doc(im),M.doc(_in),M.doc(io),M.doc(ip),M.doc(iq),M.doc(ir),M.renderTotalMatched(hX,hZ),M.renderCountry(hY,hZ.country.get_View())]);return c.Element("tr",[],ia);},renderTotalMatched:function(is,it){var iu,iv;iu=q.get_Do();iv=N.Bind(function(iw){var ix,iy;if(!iw){ix=N.Const(c.get_Empty());}else{iy=it.totalMatched.get_View();ix=N.Bind(function(iz){var iA,iC,iF,iG,iH,iI,iJ,iK;iA=function(iB){return iB[1];};iC=function(iD){return function(iE){return iD+iE;};};iF=d.map(iA,iz);iG=p.fold(iC,0,iF);if(iG===0){iJ=$.New(h,{$:0});iI=c.Element("td",[],iJ);}else{iK=$$.String(iG);iI=c.Element("td",d.ofArray([j.Create("class","game-gpb")]),d.ofArray([c.TextNode(iK)]));}iH=iI;return N.Const(M.doc(iH));},iy);}return ix;},is);return c.EmbedView(iv);}},State:{PageLen:{get:function(){return I.validateValue(n.Get(I["var"]()));},localStorageKey:$.Field(function(){return"pageLen";}),set:function(iL){var iM,iN;iM=I.validateValue(iL);if(iM!==n.Get(I["var"]())){n.Set(I["var"](),iM);iN=V.set(I.localStorageKey(),iM);}else{iN=null;}return iN;},validateValue:function(iO){return iO<10?30:iO>40?40:iO;},"var":$.Field(function(){var iP,iQ;iP=V.getWithDef(I.localStorageKey(),30);iQ=I.validateValue(iP);return l.Create(iQ);}),view:$.Field(function(){return I["var"]().get_View();})},ServerBetfairsSession:{check:$.Field(function(){return m.Delay(function(){return m.Bind(v.Async("WebFace:3",[]),function(iS){W.hasServerBetfairsSession=function(){return iS;};return m.Return(null);});});}),has:function(){return W.hasServerBetfairsSession();},hasNot:function(){return!W.hasServerBetfairsSession();},hasServerBetfairsSession:$.Field(function(){return true;})},events:$.Field(function(){var iT,iU,iV,iW,iY,iZ,i0,i1,i5,i7,i8;iT=V.checkTodayKey("CentBetEventsCatalogueCreated","CentBetEventsCatalogue");try{iW=function(iX){return X.id(iX);};iZ=(B.get_Default().EncodeRecord(X,[["gameId",B.get_Default().EncodeTuple([C,C]),0],["country",C,1],["markets",B.get_Default().EncodeList(B.get_Default().EncodeRecord(Q,[["marketId",C,0],["marketName",C,0],["runners",B.get_Default().EncodeList(B.get_Default().EncodeRecord(undefined,[["selectionId",C,0],["runnerName",C,0]])),0]])),0]]))();iY=z.LocalStorage("CentBetEventsCatalogue",{Encode:iZ,Decode:(B.get_Default().DecodeRecord(X,[["gameId",B.get_Default().DecodeTuple([C,C]),0],["country",C,1],["markets",B.get_Default().DecodeList(B.get_Default().DecodeRecord(Q,[["marketId",C,0],["marketName",C,0],["runners",B.get_Default().DecodeList(B.get_Default().DecodeRecord(undefined,[["selectionId",C,0],["runnerName",C,0]])),0]])),0]]))()});iV=D.CreateWithStorage(iW,iY);}catch(i0){i1=function(i2){return function(i3){var i4;i4="error when restoring "+x.prettyPrint(i2)+" - "+x.prettyPrint(i3);return y?y.log(i4):undefined;};};(i1("CentBetEventsCatalogue"))(i0);i5=function(i6){return X.id(i6);};i7=$.New(h,{$:0});iV=D.Create(i5,i7);}iU=iV;i8=function(i9){return function(i_){return function(i$){var ja;ja=x.prettyPrint(i9)+" - "+$$.String(i_)+", "+x.prettyPrint(i$);return y?y.log(ja):undefined;};};};((i8("CentBetEventsCatalogue"))(iU.get_Length()))(iT);return iU;}),isCouponMode:function(){return w.Equals(n.Get(F.varMode()),{$:0});},meetups:$.Field(function(){var jb,jd;jb=function(jc){return Y.id(jc);};jd=$.New(h,{$:0});return D.Create(jb,jd);}),mtpevt:$.Field(function(){return function(je){var jf,jg,jh;jf=Y.id(je);jg=jf[0];jh=jf[1];return F.tryGetEventById(jg,jh);};}),notCouponMode:function(){var ji;ji=F.isCouponMode();return!ji;},tryGetCountry:$.Field(function(){var jj;jj=function(jk){return jk.country;};return function(jl){var jm,jn,jo;jm=jl[0];jn=jl[1];jo=F.tryGetEventById(jm,jn);return o.bind(jj,jo);};}),tryGetEventById:function(jp,jq){var jr,js,jv;jr=[jp,jq];js=function(jt){var ju;ju=jt.gameId;return w.Equals(jr,ju);};jv=n.Get(F.events().Var);return p.tryFind(js,jv);},tryGetMarkets:$.Field(function(){var jw;jw=function(jx){return jx.markets;};return function(jy){var jz,jA,jB;jz=jy[0];jA=jy[1];jB=F.tryGetEventById(jz,jA);return o.map(jw,jB);};}),varColumnCountryVisible:$.Field(function(){return l.Create(false);}),varColumnGpbVisible:$.Field(function(){return l.Create(false);}),varCurrentPageNumber:$.Field(function(){return l.Create(0);}),varGameDetailError:$.Field(function(){return l.Create(false);}),varMode:$.Field(function(){return l.Create({$:0});}),varPagesCount:$.Field(function(){return l.Create(1);}),varTargetPageNumber:$.Field(function(){return l.Create(0);})},Utils:{Err:function(jC){return{$:0,$0:jC};},LocalStorage:{checkTodayKey:function(jD,jE){var jF,jG,jH,jI;jF=Z.now();jG=V.getWithDef(jD,jF);if(jF-jG>1*86400000){V.clear(jE);V.set(jD,Z.now());jI=function(jJ){return function(jK){var jL;jL="local storage "+x.prettyPrint(jJ)+" of "+x.prettyPrint(jK)+" is inspired";return y?y.log(jL):undefined;};};(jI(jE))(jG);jH=jF;}else{jH=jG;}return jH;},clear:function(jM){return V.strg().removeItem(jM);},get:function(jN){var jO,jP,jQ,jR,jS;try{jP=V.strg().getItem(jN);jQ=_0.parse(jP);jO={$:1,$0:jQ};}catch(jR){jS=function(jT){return function(jU){var jV;jV="error getting from local storage, key "+x.prettyPrint(jT)+" : "+x.prettyPrint(jU);return y?y.log(jV):undefined;};};(jS(jN))(jR);jO={$:0};}return jO;},getWithDef:function(jW,jX){var jY,jZ,j0;jY=V.get(jW);if(jY.$==1){j0=jY.$0;jZ=j0;}else{jZ=jX;}return jZ;},set:function(j1,j2){var j3,j4,j5,j6;try{j4=_0.stringify(j2);j3=V.strg().setItem(j1,j4);}catch(j5){j6=function(j7){return function(j8){return function(j9){return O.FailWith("error setting to local storage, key "+x.prettyPrint(j7)+", value "+x.prettyPrint(j8)+" : "+x.prettyPrint(j9));};};};j3=((j6(j1))(j2))(j5);}return j3;},strg:$.Field(function(){return _1.localStorage;})},Ok:function(j_){return{$:1,$0:j_};},Option:{getWith:function(j$,ka){var kb,kc;if(ka.$==0){kb=j$;}else{kc=ka.$0;kb=kc;}return kb;}},createModal:function(kd,ke){var kf,kh,kj;kf=function(kg){return kg;};kh=function(ki){return j.Create("class",ki);};(L.initializeModalVar())(ke);kj=function(kk){return function(kl){var km,kq;km=function(kn){return kn?kf(c.Element("div",d.ofArray([kh("w3-modal"),j.Create("style","display : block;")]),d.ofArray([c.Element("div",p.toList(p.delay(function(){return p.append(kk,p.delay(function(){return[kh("w3-modal-content w3-animate-zoom w3-card-8")];}));})),kl)]))):c.get_Empty();};kq=q.Map(km,kd);return c.EmbedView(kq);};};return kj;},dateTimeToString:function($s){var $0=this,$this=this;return $$.dateTimeToString($s);},formatDecimal:function(kr){return L.trimEnd(kr.toFixed(6),d.ofArray([48,46]));},formatDecimalOption:function(ks){var kt,ku;if(ks.$==1){ku=ks.$0;kt=L.formatDecimal(ku);}else{kt="";}return kt;},getDatePart:function(kv){var kw;kw=new Z(kv.getTime());kw.setHours(0,0,0,0);return kw;},initializeModalVar:$.Field(function(){var kx,ky;kx=[$.New(h,{$:0})];ky=function(kz){var kA,kB,kD;if(kz.target.className==="w3-modal"){kB=function(kC){return kC(null);};kD=kx[0];kA=p.iter(kB,kD);}else{kA=null;}return kA;};_1.addEventListener("click",ky,false);return function(kE){kx[0]=$.New(h,{$:1,$0:kE,$1:kx[0]});};}),titleAndCloseButton:function(kF,kG){var kH,kJ;kH=function(kI){return j.Create("class",kI);};kJ=d.ofArray([kH("w3-row w3-teal")]);return c.Element("header",kJ,d.ofArray([c.Element("h4",d.ofArray([kH("w3-col s11 w3-center"),j.Create("style","padding-left : 10px;")]),d.ofArray([c.TextNode(kF)])),c.Element("div",d.ofArray([kH("w3-col s1 w3-center")]),d.ofArray([c.Element("span",d.ofArray([kH("w3-closebtn"),j.Create("style","padding-right : 5px;"),i.Handler("click",function(){return function(){return kG(null);};})]),d.ofArray([c.TextNode("×")]))]))]));},trimEnd:function(kM,kN){var kO,kP,kQ,kR,kS,kT,kU,kV,kW,kX,kY,kZ;kO=[kM,kN];if(kO[0]===""){kP="";}else{if(kO[1].$==1){kR=kO[0];kO[1];kS=kO[1].$0;if(kR.charCodeAt(kR.length-1)===kS){kO[1].$0;kU=kO[1];kV=kO[0];kT=L.trimEnd(_2.string(kV,{$:0},{$:1,$0:kV.length-2}),kU);}else{if(kO[1].$==1){kX=kO[0];kY=kO[1].$1;kW=L.trimEnd(kX,kY);}else{kW=O.Raise(_3.New("C:\\Users\\fpawel\\Documents\\Visual Studio 2015\\Projects\\Betfair\\CentBet\\WebFace\\ClientUtils.fs",8,18));}kT=kW;}kQ=kT;}else{kZ=kO[0];kQ=kZ;}kP=kQ;}return kP;},updateVarValue:function(k0,k1){return!w.Equals(n.Get(k0),k1)?n.Set(k0,k1):null;},"|Err|Ok|":function(k2){var k3,k4,k5;if(k2.$==1){k4=k2.$0;k3={$:1,$0:k4};}else{k5=k2.$0;k3={$:0,$0:k5};}return k3;}},Work:{Work:$.Class({},{loop:function(k6){return m.Delay(function(){var k8;k8=m.Delay(function(){return m.Bind(k6.work,function(){return m.Bind(m.Sleep(k6.sleepInterval),function(){return m.Return(null);});});});return m.Combine(m.TryWith(k8,function(la){var lb,lf;lb=function(lc){return function(ld){var le;le="task error "+x.prettyPrint(lc)+" : "+x.prettyPrint(ld);return y?y.log(le):undefined;};};lf=k6.what;(lb(lf))(la);return m.Bind(m.Sleep(k6.sleepErrorInterval),function(){return m.Return(null);});}),m.Delay(function(){return _4.loop(k6);}));});},"new":function(li,lj,lk,ll){var lm;lm=$.New(_4,{what:li,sleepInterval:lj,sleepErrorInterval:lk,work:ll});return _4.run(lm);},run:function(ln){var lo;lo=m.Delay(function(){var lq,lt;lq=function(lr){var ls;ls="task "+x.prettyPrint(lr)+" : started";return y?y.log(ls):undefined;};lt=ln.what;lq(lt);return m.Bind(_4.loop(ln),function(){var lv,ly;lv=function(lw){var lx;lx="task "+x.prettyPrint(lw)+" : terminated";return y?y.log(lx):undefined;};ly=ln.what;lv(ly);return m.Return(null);});});return m.Start(lo,{$:0});}}),addNewGames:function(lz){var lA,lB,lC,lR,lT,lV,lW,lX;lA=n.Get(F.meetups().Var);lB=p.toList(lA);F.meetups().Clear();lC=function(lD){var lE,lF,lG,lH,lI,lJ,lK,lN,lO,lP,lQ;lE=lD[0];lF=lD[1];lG=lD[2];lH=lE.gameId;lI=lH[0];lJ=lH[1];lK=function(lL){return d.map(function(lM){return R.New(lM);},lL.markets);};lN=F.tryGetEventById(lI,lJ);lO=o.map(lK,lN);lP=$.New(h,{$:0});lQ=T.getWith(lP,lO);return $.New(Y,{game:lE,playMinute:l.Create(lF.playMinute),status:l.Create(lF.status),summary:l.Create(lF.summary),order:l.Create(lF.order),winBack:l.Create(lF.winBack),winLay:l.Create(lF.winLay),drawBack:l.Create(lF.drawBack),drawLay:l.Create(lF.drawLay),loseBack:l.Create(lF.loseBack),loseLay:l.Create(lF.loseLay),marketsBook:lQ,totalMatched:l.Create($.New(h,{$:0})),country:l.Create((F.tryGetCountry())(lE.gameId)),hash:lG});};lR=function(lS){return n.Get(lS.order);};lT=function(lU){return F.meetups().Add(lU);};lV=d.map(lC,lz);lW=p.append(lB,lV);lX=p.sortBy(lR,lW);return p.iter(lT,lX);},processCoupon:function(lY){return m.Delay(function(){var l0,l1,l3,l4,l5,l6,l7;if(F.notCouponMode()){l0=m.Return(null);}else{l1=function(l2){return[l2.game.gameId,l2.hash];};l3=n.Get(F.meetups().Var);l4=p.map(l1,l3);l5=p.toList(l4);l6=I.get();l7=v.Async("WebFace:0",[l5,n.Get(F.varTargetPageNumber()),l6]);l0=m.Bind(l7,function(l8){var l9,l_,l$,ma,mb,mc,md;l9=l8[1];l_=l8[2];l$=l8[0];ma=l8[3];mb=(ma/l6>>0)+(ma%l6===0?0:1);L.updateVarValue(F.varPagesCount(),mb);if(n.Get(F.varTargetPageNumber())>mb){n.Set(F.varTargetPageNumber(),0);md=m.Return(null);}else{md=m.Return(null);}mc=md;return m.Combine(mc,m.Delay(function(){var mf,mg,mh;mg=l$.$==0;if(!mg){E.addNewGames(l$);mh=m.Return(null);}else{mh=m.Return(null);}mf=mh;return m.Combine(mf,m.Delay(function(){var mj;mj=function(mk){return F.meetups().RemoveByKey(mk);};p.iter(mj,l_);(E.updateCurentCoupon())(l9);E.updateColumnCountryVisible();E.updateColumnGpbVisible();L.updateVarValue(lY,true);L.updateVarValue(F.varCurrentPageNumber(),n.Get(F.varTargetPageNumber()));return m.Return(null);}));}));});}return l0;});},processEvents:$.Field(function(){return m.Delay(function(){var mm,mn,mo,mp,ms,mt,mu,mw,mx,my;if(F.notCouponMode()){mm=m.Return(null);}else{mn=n.Get(F.meetups().Var);mo=F.mtpevt();mp=function(mq){var mr;mr=mo(mq);return mr.$==0;};ms=p.filter(mp,mn);if(p.isEmpty(ms)?true:W.hasNot()){mt=m.Return(null);}else{mu=function(mv){return mv.game.gameId;};mw=p.map(mu,ms);mx=p.toList(mw);my=v.Async("WebFace:4",[mx]);mt=m.Bind(my,function(mz){return m.Combine(m.For(mz,function(mA){var mB,mC,mD,mE,mF,mH;mB=mA[1];mC=mA[0];mD=mA[2];mE=$.New(X,{gameId:mC,country:mD,markets:$.New(h,{$:0})});F.events().Add(mE);mF=function(mG){return n.Set(mG.country,mE.country);};mH=F.meetups().TryFindByKey(mC);o.iter(mF,mH);return m.Return(null);}),m.Delay(function(){E.updateColumnCountryVisible();E.updateColumnGpbVisible();return m.Return(null);}));});}mm=mt;}return mm;});}),processGameDetail:$.Field(function(){return m.Delay(function(){var mK,mL,mM,mN,mO,mP,mQ;mK=n.Get(F.varMode());if(mK.$==1){mM=mK.$0;mN=mM.game.gameId;mO=mN[0];mP=mN[1];mQ=v.Async("WebFace:1",[mO,mP]);mL=m.Bind(mQ,function(mR){var mS,mT,mU,mV,mW,mX;mS=F.varGameDetailError();mT=mR.$==0;n.Set(mS,mT);if(mR.$==1){mW=mR.$0[0];mX=mR.$0[1];E.updateGameInfo(mM,mW,mX);mV=m.Return(null);}else{mV=m.Return(null);}mU=mV;return m.Combine(mU,m.Delay(function(){var mZ,m0,m2,m3,m4;mZ=mM.marketsBook;m0=function(m1){return R.id(m1);};m2=p.map(m0,mZ);m3=p.toList(m2);m4=v.Async("WebFace:7",[m3]);return m.Bind(m4,function(m5){var m6;m6=function(m7){var m8,m9;m8=m7.runners;m9=function(m_){var m$,nc,nd,ne;m$=function(na,nb){return L.updateVarValue(na,_6.TryFind(m_.selectionId,nb));};nc=m7.marketId;nd=_6.TryFind(nc,m5);ne=function(nf){var ng,nh,ni,nj;ng=nf[0];nh=nf[1];ni=nf[2];nj=nf[3];m$(m_.backPrice,ng);m$(m_.backSize,nh);m$(m_.layPrice,ni);return m$(m_.laySize,nj);};return o.iter(ne,nd);};return p.iter(m9,m8);};p.iter(m6,mZ);return m.Return(null);});}));});}else{mL=m.Return(null);}return mL;});}),processMarkets:$.Field(function(){return m.Delay(function(){var nl,nm,nn,ns,nt,nu,nv,nw,nx;if(F.notCouponMode()){nl=m.Return(null);}else{nm=n.Get(F.meetups().Var);nn=function(no){var np,nr;np=function(nq){return nq.markets.$==0?{$:1,$0:no.game.gameId}:{$:0};};nr=(F.mtpevt())(no);return o.bind(np,nr);};ns=p.choose(nn,nm);if(p.isEmpty(ns)?true:W.hasNot()){nt=m.Return(null);}else{nu=p.head(ns);nv=nu[0];nw=nu[1];nx=v.Async("WebFace:5",[nv,nw]);nt=m.Bind(nx,function(ny){var nz;nz=function(nA){var nB,nJ;nB=function(nC){var nD;nD=d.map(function(nE){var nF,nG,nH,nI;nF=nE[0];nG=nE[1];nH=nE[2];nI=nE[3];return Q.New(nF,nG,nH,nI);},nA);return{$:1,$0:$.New(X,{gameId:nC.gameId,country:nC.country,markets:nD})};};F.events().UpdateBy(nB,nu);nJ=function(nK){var nL;nL=d.map(function(nM){var nN,nO,nP,nQ,nR;nN=nM[0];nO=nM[1];nP=nM[2];nQ=nM[3];nR=Q.New(nN,nO,nP,nQ);return R.New(nR);},nA);return{$:1,$0:$.New(Y,{game:nK.game,playMinute:nK.playMinute,status:nK.status,summary:nK.summary,order:nK.order,winBack:nK.winBack,winLay:nK.winLay,drawBack:nK.drawBack,drawLay:nK.drawLay,loseBack:nK.loseBack,loseLay:nK.loseLay,marketsBook:nL,totalMatched:nK.totalMatched,country:nK.country,hash:nK.hash})};};return F.meetups().UpdateBy(nJ,nu);};o.iter(nz,ny);return m.Return(null);});}nl=nt;}return nl;});}),processTotalMatched:$.Field(function(){return m.Delay(function(){var nT,nU,nV,n3;if(F.notCouponMode()){nT=m.Return(null);}else{nU=n.Get(F.meetups().Var);nV=function(nW){var nX,nZ,n1,n2;nX=function(nY){return nY.markets;};nZ=function(n0){return n0.$==0?{$:0}:{$:1,$0:nW.game.gameId};};n1=(F.mtpevt())(nW);n2=o.map(nX,n1);return o.bind(nZ,n2);};n3=p.choose(nV,nU);nT=(p.isEmpty(n3)?true:W.hasNot())?m.Return(null):m.Combine(m.For(n3,function(n4){var n5,n6,n7;if(F.notCouponMode()){n5=m.Return(null);}else{n6=n4[0];n7=n4[1];n5=m.Bind(v.Async("WebFace:6",[n6,n7]),function(n8){var n9,n_,n$;if(n8.$==0){n9=m.Return(null);}else{n_=n4[0];n$=n4[1];E.updateTotalMatched(n_,n$,n8);n9=m.Return(null);}return n9;});}return n5;}),m.Delay(function(){E.updateColumnGpbVisible();return m.Return(null);}));}return nT;});}),start:function(ob){var oc;oc=function(od,oe){var of,og,oh;of=od[0];og=od[1];oh=od[2];return _4["new"](of,og,oh,oe);};oc(["COUPON",0,0],E.processCoupon(ob));oc(["CHECK-SERVER-BETFAIRS-SESSION",0,0],W.check());oc(["EVENTS-CATALOGUE",0,0],E.processEvents());oc(["MARKETS-CATALOGUE",0,0],E.processMarkets());oc(["TOTAL-MATCHED",0,0],E.processTotalMatched());return oc(["GAME-DETAIL",0,0],E.processGameDetail());},updateColumnCountryVisible:function(){var oi,oj,os;oi=n.Get(F.meetups().Var);oj=function(ok){var ol,on,oo,op,oq,or;ol=function(om){return om.country;};on=(F.mtpevt())(ok);oo=o.bind(ol,on);if(oo.$==1){oq=oo.$0;if(oq!==""){oo.$0;or=true;}else{or=false;}op=or;}else{op=false;}return op;};os=p.exists(oj,oi);return L.updateVarValue(F.varColumnCountryVisible(),os);},updateColumnGpbVisible:function(){var ot,ou,oC;ot=n.Get(F.meetups().Var);ou=function(ov){var ow,oy,oA,oB;ow=function(ox){return ox[1];};oy=function(oz){return 0<oz;};oA=n.Get(ov.totalMatched);oB=p.map(ow,oA);return p.exists(oy,oB);};oC=p.exists(ou,ot);return L.updateVarValue(F.varColumnGpbVisible(),oC);},updateCurentCoupon:$.Field(function(){var oD;oD=function(oE){var oF,oG,oH,oI,oK;oF=oE[0];oG=oE[1];oH=oE[2];oI=function(oJ){return[oJ,oG,oH];};oK=F.meetups().TryFindByKey(oF);return o.map(oI,oK);};return function(oL){var oM;oM=d.choose(oD,oL);return p.iter(function(oN){var oO,oP,oQ;oO=oN[0];oP=oN[1];oQ=oN[2];return E.updateGameInfo(oO,oP,oQ);},oM);};}),updateGameInfo:function(oR,oS,oT){oR.hash=oT;L.updateVarValue(oR.playMinute,oS.playMinute);L.updateVarValue(oR.status,oS.status);L.updateVarValue(oR.summary,oS.summary);L.updateVarValue(oR.order,oS.order);L.updateVarValue(oR.winBack,oS.winBack);L.updateVarValue(oR.winLay,oS.winLay);L.updateVarValue(oR.drawBack,oS.drawBack);L.updateVarValue(oR.drawLay,oS.drawLay);L.updateVarValue(oR.loseBack,oS.loseBack);return L.updateVarValue(oR.loseLay,oS.loseLay);},updateTotalMatched:function(oU,oV,oW){var oX,oY,o0;oX=[oU,oV];oY=function(oZ){return L.updateVarValue(oZ.totalMatched,oW);};o0=F.meetups().TryFindByKey(oX);return o.iter(oY,o0);}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.UI);b=$.Safe(a.Next);c=$.Safe(b.Doc);d=$.Safe($$.WebSharper.List);e=$.Safe($$.CentBet);f=$.Safe(e.Client);g=$.Safe(f.Admin);h=$.Safe(d.T);i=$.Safe(b.AttrModule);j=$.Safe(b.AttrProxy);k=$.Safe(b.Key);l=$.Safe(b.Var);m=$.Safe($$.WebSharper.Concurrency);n=$.Safe(b.Var1);o=$.Safe($$.WebSharper.Option);p=$.Safe($$.WebSharper.Seq);q=$.Safe(b.View);r=$.Safe(g.RecordType);s=$.Safe($$.WebSharper.Strings);t=$.Safe($$.Seq);u=$.Safe($$.WebSharper.Remoting);v=$.Safe(u.AjaxRemotingProvider);w=$.Safe($$.WebSharper.Unchecked);x=$.Safe($$.WebSharper.PrintfHelpers);y=$.Safe($$.console);z=$.Safe(b.Storage1);A=$.Safe($$.WebSharper.Json);B=$.Safe(A.Provider);C=$.Safe(B.Id);D=$.Safe(b.ListModel);E=$.Safe(f.Work);F=$.Safe(f.State);G=$.Safe(f.GameDetail);H=$.Safe(f.Coupon);I=$.Safe(F.PageLen);J=$.Safe(H.SettingsDialog);K=$.Safe(J.Helpers);L=$.Safe(f.Utils);M=$.Safe(f.Meetup);N=$.Safe(b.View1);O=$.Safe($$.WebSharper.Operators);P=$.Safe(f.Football);Q=$.Safe(P.Market);R=$.Safe(P.MarketBook);S=$.Safe(P.RunnerBook);T=$.Safe(L.Option);U=$.Safe(G.Helpers);V=$.Safe(L.LocalStorage);W=$.Safe(F.ServerBetfairsSession);X=$.Safe(P.Event);Y=$.Safe(P.Meetup);Z=$.Safe($$.Date);_0=$.Safe($$.JSON);_1=$.Safe($$.window);_2=$.Safe($$.WebSharper.Slice);_3=$.Safe($$.WebSharper.MatchFailureException);_4=$.Safe(E.Work);_5=$.Safe($$.WebSharper.Collections);return _6=$.Safe(_5.MapModule);});$.OnLoad(function(){E.updateCurentCoupon();E.processTotalMatched();E.processMarkets();E.processGameDetail();E.processEvents();L.initializeModalVar();V.strg();F.varTargetPageNumber();F.varPagesCount();F.varMode();F.varGameDetailError();F.varCurrentPageNumber();F.varColumnGpbVisible();F.varColumnCountryVisible();F.tryGetMarkets();F.tryGetCountry();F.mtpevt();F.meetups();F.events();W.hasServerBetfairsSession();W.check();I.view();I["var"]();I.localStorageKey();G.varError();H["render\u0421oupon"]();H.renderPagination();H.renderMeetup();J.elt();K.varVisible();K.renderDialog();K.content();g.varConsole();g.varCommandsHistory();g.varCmd();g.renderRecord();g.op_SpliceUntyped();g["cmd-input"]();return;});}());
